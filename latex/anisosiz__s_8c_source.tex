\hypertarget{anisosiz__s_8c_source}{}\doxysection{anisosiz\+\_\+s.\+c}
\label{anisosiz__s_8c_source}\index{src/mmgs/anisosiz\_s.c@{src/mmgs/anisosiz\_s.c}}
\mbox{\hyperlink{anisosiz__s_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmgs__private_8h}{libmmgs\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmgs_8h}{libmmgs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{inlined__functions__private_8h}{inlined\_functions\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00039}00039 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgsexterns__private_8h}{mmgsexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00040}00040 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgexterns__private_8h}{mmgexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00054}\mbox{\hyperlink{anisosiz__s_8c_ad6689b29eb3edfd617cb4a865193d00b}{00054}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_ad6689b29eb3edfd617cb4a865193d00b}{MMG5\_defmetsin}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int it,\textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00055}00055   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}         pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00056}00056   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}        p0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00057}00057   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}          par;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00058}00058   \textcolor{keywordtype}{double}             *m,n[3],isqhmin,isqhmax,b0[3],b1[3],ps1,tau[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00059}00059   \textcolor{keywordtype}{double}             ntau2,gammasec[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00060}00060   \textcolor{keywordtype}{double}             c[3],kappa,maxkappa,alpha,hausd,hausd\_v;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00061}00061   MMG5\_int           list[\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+2],k,iel,idp,init\_s;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00062}00062   \textcolor{keywordtype}{int}                ilist,i;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00063}00063   uint8\_t            i0,i1,i2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00065}00065   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00066}00066   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00067}00067   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00069}00069   \textcolor{comment}{/* local parameters at vertex: useless for now because new points are created}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00070}00070 \textcolor{comment}{   * without reference (inside the domain) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00071}00071   hausd\_v = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00072}00072   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00073}00073   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00075}00075   int8\_t dummy;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00076}00076   ilist = \mbox{\hyperlink{boulep_8c_a71f8e5d4eb5962634fdd646773a14e09}{MMG5\_boulet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},it,ip,list,1,\&dummy);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00077}00077   \textcolor{keywordflow}{if} ( ilist < 1 )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00079}00079   maxkappa = 0.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00080}00080   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00081}00081     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00082}00082     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00083}00083     i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00084}00084     i2  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00085}00085     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00087}00087     \textcolor{comment}{/* Computation of the two control points associated to edge p0p1 with}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00088}00088 \textcolor{comment}{     * p1=mesh-\/>point[pt-\/>v[i1]]: p0 is singular */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00089}00089     \mbox{\hyperlink{mmgcommon__private_8h_abb8ea4584fddf99cd69c9dcf99553c29}{MMG5\_nortri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,n);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00090}00090     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i2]) )}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00091}00091       \mbox{\hyperlink{bezier_8c_ae7313f7f1deac3748f85d89d52fa5e1f}{MMG5\_bezierEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},idp,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],b0,b1,1,n);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00092}00092     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00093}00093       \mbox{\hyperlink{bezier_8c_ae7313f7f1deac3748f85d89d52fa5e1f}{MMG5\_bezierEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},idp,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],b0,b1,0,n);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00095}00095     \textcolor{comment}{/* tangent vector */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00096}00096     tau[0] = 3.0*(b0[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00097}00097     tau[1] = 3.0*(b0[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00098}00098     tau[2] = 3.0*(b0[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00099}00099     ntau2  = tau[0]*tau[0] + tau[1]*tau[1] + tau[2]*tau[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00101}00101     \textcolor{comment}{/* 2nd order derivative */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00102}00102     gammasec[0] = 6.0*p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ 12.0*b0[0] + 6.0*b1[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00103}00103     gammasec[1] = 6.0*p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ 12.0*b0[1] + 6.0*b1[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00104}00104     gammasec[2] = 6.0*p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ 12.0*b0[2] + 6.0*b1[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00105}00105     \textcolor{keywordflow}{if} ( ntau2 < \mbox{\hyperlink{eigenv__private_8h_a6cb898fb52de6878afc45c81fb376e62}{MMG5\_EPSD}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00106}00106     ntau2 = 1.0 / ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00108}00108     \textcolor{comment}{/* derivative via the normal parametrization */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00109}00109     ps1  = gammasec[0]*tau[0] + gammasec[1]*tau[1] + gammasec[2]*tau[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00110}00110     c[0] = gammasec[0] -\/ ps1*tau[0]*ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00111}00111     c[1] = gammasec[1] -\/ ps1*tau[1]*ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00112}00112     c[2] = gammasec[2] -\/ ps1*tau[2]*ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00114}00114     kappa = ntau2 * sqrt(c[0]*c[0] + c[1]*c[1] + c[2]*c[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00116}00116     \textcolor{comment}{/* local parameters for triangle */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00117}00117     hausd   = hausd\_v;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00118}00118     init\_s  = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00119}00119     \textcolor{keywordflow}{for} (i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00120}00120       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00121}00121       \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} == \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} == par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00122}00122         hausd   = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00123}00123         \textcolor{keywordflow}{if} ( !init\_s ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00124}00124           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00125}00125           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00126}00126           init\_s  = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00127}00127         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00128}00128         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00129}00129           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}},isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00130}00130           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}},isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00131}00131         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00132}00132       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00133}00133     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00134}00134     maxkappa = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(kappa/hausd,maxkappa);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00135}00135   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00137}00137   isqhmin  = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00138}00138   isqhmax  = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00140}00140   alpha = 1.0 / 8.0 * maxkappa;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00141}00141   alpha = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(alpha,isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00142}00142   alpha = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(alpha,isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00144}00144   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00145}00145   memset(m,0,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00146}00146   m[0] = m[3] = m[5] = alpha;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00148}00148   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00149}00149 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00173}\mbox{\hyperlink{anisosiz__s_8c_a9502107eead2377badc73ea2c5f4db81}{00173}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_a9502107eead2377badc73ea2c5f4db81}{MMG5\_defmetrid}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int it,\textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00174}00174   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}     pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00175}00175   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p0,p1,p2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00176}00176   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}    b;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00177}00177   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}      par;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00178}00178   MMG5\_int       k,iel,idp,*list,list1[\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00179}00179   \textcolor{keywordtype}{int}            ilist1,ilist2,ilist;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00180}00180   MMG5\_int       list2[\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+2],iprid[2],isloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00181}00181   \textcolor{keywordtype}{int}            \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00182}00182   \textcolor{keywordtype}{double}         *m,isqhmin,isqhmax,*n1,*n2,*n,*t,trot[2],u[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00183}00183   \textcolor{keywordtype}{double}         r[3][3],lispoi[3*\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+1],ux,uy,uz,det,bcu[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00184}00184   \textcolor{keywordtype}{double}         detg,detd;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00185}00185   uint8\_t        i,i0,i1,i2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00186}00186   \textcolor{keyword}{static} int8\_t  mmgWarn0=0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00188}00188   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00189}00189   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00190}00190   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00191}00191 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00192}00192   \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00193}00193   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00194}00194   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00195}00195   isloc   = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00196}00196   \textcolor{keywordflow}{for} (k=0; k<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00197}00197     par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00198}00198     \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} == \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} == par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00199}00199       \textcolor{keywordflow}{if} ( !isloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00200}00200         isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00201}00201         isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00202}00202         isloc = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00203}00203       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00204}00204       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00205}00205         isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00206}00206         isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00207}00207       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00208}00208     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00209}00209   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00210}00210 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00211}00211   isqhmin = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00212}00212   isqhmax = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00213}00213 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00214}00214   n1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00215}00215   n2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00216}00216   t  = p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00217}00217 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00218}00218   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00219}00219   memset(m,0,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00220}00220   m[0] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00221}00221   m[1] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00222}00222   m[2] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00223}00223   m[3] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00224}00224   m[4] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00226}00226   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{boulep__s_8c_aecbb431a8fa5660917b19cf324d70654}{bouletrid}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},it,ip,\&ilist1,list1,\&ilist2,list2,\&iprid[0],\&iprid[1]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00227}00227   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00228}00228     \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00229}00229       mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00230}00230       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to compute the two balls at at"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00231}00231               \textcolor{stringliteral}{"{} least 1 ridge point.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00232}00232     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00233}00233     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00234}00234   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00235}00235 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00236}00236   \textcolor{comment}{/* Specific size in direction of t */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00237}00237   m[0] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[0],\mbox{\hyperlink{anisosiz_8c_af0b1ee93ffcbf66e79752170f332260c}{MMG5\_ridSizeInTangentDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,idp,iprid,isqhmin,isqhmax));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00238}00238 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00239}00239   \textcolor{comment}{/* Characteristic sizes in directions u1 and u2 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00240}00240   \textcolor{keywordflow}{for} (i=0; i<2; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00241}00241     \textcolor{keywordflow}{if} ( i==0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00242}00242       n = n1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00243}00243       ilist = ilist1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00244}00244       list  = \&list1[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00245}00245     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00246}00246     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00247}00247       n = n2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00248}00248       ilist = ilist2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00249}00249       list  = \&(list2[0]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00250}00250     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00251}00251     \mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00253}00253     \textcolor{comment}{/* Apply rotation to the half-\/ball under consideration */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00254}00254     i1 = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00255}00255     \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00256}00256       iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00257}00257       i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00258}00258       i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00259}00259       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00260}00260       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00262}00262       ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00263}00263       uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00264}00264       uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00265}00265 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00266}00266       lispoi[3*k+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00267}00267       lispoi[3*k+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00268}00268       lispoi[3*k+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00269}00269     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00271}00271     \textcolor{comment}{/* last point : the half-\/ball is open : ilist tria, and ilist +1 points ;}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00272}00272 \textcolor{comment}{       lists are enumerated in direct order */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00273}00273     i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00274}00274     p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00276}00276     ux = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00277}00277     uy = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00278}00278     uz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00280}00280     lispoi[3*ilist+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00281}00281     lispoi[3*ilist+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00282}00282     lispoi[3*ilist+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00283}00283 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00284}00284     \textcolor{comment}{/* At this point, lispoi contains all the points of the half-\/ball of p0, rotated}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00285}00285 \textcolor{comment}{       so that t\_\{p\_0\}S = [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00287}00287     \textcolor{comment}{/* Rotated tangent vector (trot[2] = 0), and third direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00288}00288     trot[0] = r[0][0]*t[0] + r[0][1]*t[1] + r[0][2]*t[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00289}00289     trot[1] = r[1][0]*t[0] + r[1][1]*t[1] + r[1][2]*t[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00291}00291     u[0] = -\/trot[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00292}00292     u[1] =  trot[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00294}00294     \textcolor{comment}{/* Travel half-\/ball at p0 and stop at first triangle containing u */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00295}00295     \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00296}00296       detg = lispoi[3*k+1]*u[1] -\/ lispoi[3*k+2]*u[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00297}00297       detd = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00298}00298       \textcolor{keywordflow}{if} ( detg > 0.0 \&\& detd > 0.0 )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00299}00299     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00300}00300 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00301}00301     \textcolor{comment}{/* If triangle not found, try with -\/u */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00302}00302     \textcolor{keywordflow}{if} ( k == ilist ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00303}00303       u[0] *= -\/1.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00304}00304       u[1] *= -\/1.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00305}00305 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00306}00306       \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00307}00307         detg = lispoi[3*k+1]*u[1] -\/ lispoi[3*k+2]*u[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00308}00308         detd = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00309}00309         \textcolor{keywordflow}{if} ( detg > 0.0 \&\& detd > 0.0 )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00310}00310       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00311}00311     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00312}00312     \textcolor{keywordflow}{if} ( k == ilist )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00314}00314     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00315}00315     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00316}00316     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00317}00317     \textcolor{keywordflow}{if} ( !MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&b,1) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00318}00318 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00319}00319     \textcolor{comment}{/* Barycentric coordinates of vector u in tria iel */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00320}00320     detg = lispoi[3*k+1]*u[1] -\/ lispoi[3*k+2]*u[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00321}00321     detd = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00322}00322     det = detg + detd;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00323}00323     \textcolor{keywordflow}{if} ( det < \mbox{\hyperlink{eigenv__private_8h_a6cb898fb52de6878afc45c81fb376e62}{MMG5\_EPSD}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00324}00324 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00325}00325     det = 1.0 / det;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00326}00326     bcu[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00327}00327     bcu[1] = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00328}00328     bcu[1] *= det;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00329}00329     assert(bcu[1] <= 1.0);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00330}00330     bcu[2] = 1.0 -\/ bcu[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00331}00331 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00332}00332     \textcolor{comment}{/* Computation of tangent vector and second derivative of curve t \(\backslash\)mapsto}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00333}00333 \textcolor{comment}{       b(tbcu) (not in rotated frame) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00334}00334     m[i+1] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[i+1],}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00335}00335                     \mbox{\hyperlink{anisosiz_8c_aaa4f68689c18c8010dc68875921911f0}{MMG5\_ridSizeInNormalDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},i0,bcu,\&b,isqhmin,isqhmax));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00336}00336   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00338}00338   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00339}00339 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00352}\mbox{\hyperlink{anisosiz__s_8c_ae9d768e402d6cde198d7a60f4363ddb3}{00352}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_ae9d768e402d6cde198d7a60f4363ddb3}{MMG5\_defmetref}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int it,\textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00353}00353   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}         pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00354}00354   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}        p0,p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00355}00355   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}        b;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00356}00356   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}          par;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00357}00357   MMG5\_int           list[\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+2],k,iel,ipref[2],idp,isloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00358}00358   \textcolor{keywordtype}{int}                i,ilist;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00359}00359   \textcolor{keywordtype}{double}             *m,isqhmin,isqhmax,*n,r[3][3],lispoi[3*\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00360}00360   \textcolor{keywordtype}{double}             ux,uy,uz,det2d,intm[3],c[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00361}00361   \textcolor{keywordtype}{double}             tAA[6],tAb[3],hausd;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00362}00362   uint8\_t            i0,i1,i2;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00363}00363   \textcolor{keyword}{static} int8\_t      mmgWarn0=0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00364}00364 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00365}00365   ipref[0] = ipref[1] = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00366}00366   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00367}00367   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00368}00368   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00369}00369 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00370}00370   int8\_t dummy;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00371}00371   ilist = \mbox{\hyperlink{boulep_8c_a71f8e5d4eb5962634fdd646773a14e09}{MMG5\_boulet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},it,ip,list,1,\&dummy);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00372}00372   \textcolor{keywordflow}{if} ( ilist < 1 )}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00373}00373     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00375}00375   \textcolor{comment}{/* Computation of the rotation matrix T\_p0 S -\/> [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00376}00376   n  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00377}00377   assert ( n[0]*n[0] + n[1]*n[1] + n[2]*n[2] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00378}00378 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00379}00379   \mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00380}00380   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00381}00381 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00382}00382   \textcolor{comment}{/* Apply rotation \(\backslash\)circ translation to the whole ball */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00383}00383   assert ( ilist );}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00384}00384   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00385}00385     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00386}00386     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00387}00387     i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00388}00388     i2  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00389}00389     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00390}00390     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00392}00392     \textcolor{comment}{/* Store the two ending points of ref curves */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00393}00393     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} \& pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i1] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00394}00394       \textcolor{keywordflow}{if} ( !ipref[0] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00395}00395         ipref[0] = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00396}00396       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00397}00397       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !ipref[1] \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2] != ipref[0]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00398}00398         ipref[1] = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00399}00399       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00400}00400       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2] != ipref[0]) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2] != ipref[1]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00401}00401         \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00402}00402           mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00403}00403           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00404}00404                   \textcolor{stringliteral}{"{} non singular point at intersection of 3 ref edges.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00405}00405                   \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00406}00406         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00407}00407         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00408}00408       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00409}00409     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00411}00411     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} \& pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i2] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00412}00412       \textcolor{keywordflow}{if} ( !ipref[0] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00413}00413         ipref[0] = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00414}00414       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00415}00415       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !ipref[1] \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1] != ipref[0]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00416}00416         ipref[1] = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00417}00417       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00418}00418       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1] != ipref[0]) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1] != ipref[1]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00419}00419         \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00420}00420           mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00421}00421           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00422}00422                   \textcolor{stringliteral}{"{} non singular point at intersection of 3 ref edges.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00423}00423                   \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00424}00424         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00425}00425         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00426}00426       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00427}00427     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00428}00428 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00429}00429     ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00430}00430     uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00431}00431     uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00432}00432 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00433}00433     lispoi[3*k+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00434}00434     lispoi[3*k+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00435}00435     lispoi[3*k+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00436}00436   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00437}00437 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00438}00438   \textcolor{comment}{/* list goes modulo ilist */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00439}00439   lispoi[3*ilist+1] =  lispoi[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00440}00440   lispoi[3*ilist+2] =  lispoi[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00441}00441   lispoi[3*ilist+3] =  lispoi[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00442}00442 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00443}00443   \textcolor{comment}{/* Check all projections over tangent plane. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00444}00444   \textcolor{keywordflow}{for} (k=0; k<ilist-\/1; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00445}00445     det2d = lispoi[3*k+1]*lispoi[3*(k+1)+2] -\/ lispoi[3*k+2]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00446}00446     \textcolor{keywordflow}{if} ( det2d < 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00447}00447       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00448}00448     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00449}00449   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00450}00450   det2d = lispoi[3*(ilist-\/1)+1]*lispoi[3*0+2] -\/ lispoi[3*(ilist-\/1)+2]*lispoi[3*0+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00451}00451   \textcolor{keywordflow}{if} ( det2d < 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00452}00452     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00453}00453   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00454}00454   assert(ipref[0] \&\& ipref[1]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00455}00455 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00456}00456   \textcolor{comment}{/* At this point, lispoi contains all the points of the ball of p0, rotated}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00457}00457 \textcolor{comment}{     so that t\_\{p\_0\}S = [z = 0], ipref1 and ipref2 are the indices of other ref points. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00458}00458 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00459}00459   \textcolor{comment}{/* Second step : reconstitution of the curvature tensor at p0 in the tangent plane,}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00460}00460 \textcolor{comment}{     with a quadric fitting approach */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00461}00461   memset(intm,0x00,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00462}00462   memset(tAA,0x00,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00463}00463   memset(tAb,0x00,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00464}00464 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00465}00465   hausd   = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00466}00466   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00467}00467   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00468}00468   isloc = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00469}00469   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00470}00470     \textcolor{comment}{/* Approximation of the curvature in the normal section associated to tau : by assumption,}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00471}00471 \textcolor{comment}{       p1 is either regular, either on a ridge (or a singularity), but p0p1 is not ridge*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00472}00472     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00473}00473     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00474}00474     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00475}00475     MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&b,1);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00477}00477 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00478}00478     \textcolor{comment}{/* 1. Fill matrice tAA and second member tAb with A=(\(\backslash\)sum X\_\{P\_i\}\string^2 \(\backslash\)sum}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00479}00479 \textcolor{comment}{     * Y\_\{P\_i\}\string^2 \(\backslash\)sum X\_\{P\_i\}Y\_\{P\_i\}) and b=\(\backslash\)sum Z\_\{P\_i\} with P\_i the physical}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00480}00480 \textcolor{comment}{     * points at edge [i0;i1] extremities and middle.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00481}00481 \textcolor{comment}{     * 2. Compute the physical coor \(\backslash\)a c of the curve edge's}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00482}00482 \textcolor{comment}{     * mid-\/point.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00483}00483 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00484}00484     \mbox{\hyperlink{anisosiz_8c_a358ab88c88f12024f1d2cf0d468b8efc}{MMG5\_fillDefmetregSys}}(k,p0,i0,b,r,c,lispoi,tAA,tAb);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00485}00485 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00486}00486     \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00487}00487     \textcolor{keywordflow}{for} (i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00488}00488       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00489}00489       \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} == \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} == par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00490}00490         \textcolor{keywordflow}{if} ( !isloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00491}00491           hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00492}00492           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00493}00493           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00494}00494           isloc = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00495}00495         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00496}00496         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00497}00497           \textcolor{comment}{// take the wanted value between the two local parameters asked}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00498}00498           \textcolor{comment}{// by the user.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00499}00499           hausd = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00500}00500           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00501}00501           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00502}00502         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00503}00503       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00504}00504     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00505}00505   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00506}00506 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00507}00507   isqhmin = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00508}00508   isqhmax = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00509}00509 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00510}00510   \textcolor{keywordflow}{return} \mbox{\hyperlink{anisosiz_8c_ad2b102344602e5af03a746c227bc2e9c}{MMG5\_solveDefmetrefSys}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,ipref,r,c,tAA,tAb,m,}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00511}00511                                  isqhmin,isqhmax,hausd);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00512}00512 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00529}\mbox{\hyperlink{anisosiz__s_8c_ab2d8e4e151cfbd92fb6696fa067e5cae}{00529}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_ab2d8e4e151cfbd92fb6696fa067e5cae}{MMGS\_surfballRotation}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} p0,MMG5\_int *list,\textcolor{keywordtype}{int} ilist,}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00530}00530                           \textcolor{keywordtype}{double} r[3][3],\textcolor{keywordtype}{double} *lispoi,\textcolor{keywordtype}{double} n[3]) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00531}00531   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}  pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00532}00532   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00533}00533   \textcolor{keywordtype}{double}      ux,uy,uz,area;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00534}00534   MMG5\_int    iel;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00535}00535   \textcolor{keywordtype}{int}         i0,i1,k;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00537}00537   \textcolor{comment}{/* Computation of the rotation matrix T\_p0 S -\/> [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00538}00538   assert ( n[0]*n[0] + n[1]*n[1] + n[2]*n[2] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00539}00539 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00540}00540   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00541}00541     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00542}00542   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00543}00543 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00544}00544   \textcolor{comment}{/* Apply rotation \(\backslash\)circ translation to the whole ball */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00545}00545   assert ( ilist );}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00546}00546   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00547}00547     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00548}00548     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00549}00549     i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00550}00550     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00551}00551     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00552}00552 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00553}00553     ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00554}00554     uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00555}00555     uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00556}00556 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00557}00557     lispoi[3*k+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00558}00558     lispoi[3*k+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00559}00559     lispoi[3*k+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00560}00560   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00561}00561 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00562}00562   \textcolor{comment}{/* list goes modulo ilist */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00563}00563   lispoi[3*ilist+1] =  lispoi[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00564}00564   lispoi[3*ilist+2] =  lispoi[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00565}00565   lispoi[3*ilist+3] =  lispoi[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00566}00566 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00567}00567   \textcolor{comment}{/* Check all projections over tangent plane. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00568}00568   \textcolor{keywordflow}{for} (k=0; k<ilist-\/1; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00569}00569     area = lispoi[3*k+1]*lispoi[3*(k+1)+2] -\/ lispoi[3*k+2]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00570}00570     \textcolor{keywordflow}{if} ( area <= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00571}00571       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00572}00572     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00573}00573   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00574}00574   area = lispoi[3*(ilist-\/1)+1]*lispoi[3*0+2] -\/ lispoi[3*(ilist-\/1)+2]*lispoi[3*0+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00575}00575   \textcolor{keywordflow}{if} ( area <= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00576}00576     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00577}00577   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00578}00578 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00579}00579   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00580}00580 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00581}00581 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00593}\mbox{\hyperlink{anisosiz__s_8c_a0e16aa1fb6b1d9ce7a19e05654eddc58}{00593}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_a0e16aa1fb6b1d9ce7a19e05654eddc58}{MMG5\_defmetreg}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int it,\textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00594}00594   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}          pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00595}00595   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}         p0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00596}00596   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}         b;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00597}00597   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}           par;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00598}00598   MMG5\_int            list[\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+2],iel,idp,isloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00599}00599   \textcolor{keywordtype}{int}                 ilist,k,i;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00600}00600   \textcolor{keywordtype}{double}              *m,r[3][3],lispoi[3*\mbox{\hyperlink{libmmgs_8h_acdcd2d0f0f5d4b4a75b16c88cfffef00}{MMGS\_LMAX}}+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00601}00601   \textcolor{keywordtype}{double}              c[3],isqhmin,isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00602}00602   \textcolor{keywordtype}{double}              tAA[6],tAb[3],hausd;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00603}00603   uint8\_t             i0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00604}00604 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00605}00605   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00606}00606   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00607}00607   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00608}00608   m   = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00609}00609 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00610}00610   int8\_t dummy;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00611}00611   ilist = \mbox{\hyperlink{boulep_8c_a71f8e5d4eb5962634fdd646773a14e09}{MMG5\_boulet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},it,ip,list,1,\&dummy);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00612}00612   \textcolor{keywordflow}{if} ( ilist < 1 )}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00613}00613     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00614}00614 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00615}00615   \textcolor{comment}{/* Rotation of the ball of p0 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00616}00616   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_ab2d8e4e151cfbd92fb6696fa067e5cae}{MMGS\_surfballRotation}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,list,ilist,r,lispoi,p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}})  ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00617}00617     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00618}00618   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00619}00619 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00620}00620   \textcolor{comment}{/* At this point, lispoi contains all the points of the ball of p0, rotated}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00621}00621 \textcolor{comment}{     so that t\_\{p\_0\}S = [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00622}00622 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00623}00623   \textcolor{comment}{/* Second step : reconstitution of the curvature tensor at p0 in the tangent}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00624}00624 \textcolor{comment}{     plane, with a quadric fitting approach */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00625}00625   memset(tAA,0x00,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00626}00626   memset(tAb,0x00,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00627}00627 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00628}00628   hausd   = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00629}00629   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00630}00630   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00631}00631   isloc = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00632}00632   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00633}00633     \textcolor{comment}{/* Approximation of the curvature in the normal section associated to tau :}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00634}00634 \textcolor{comment}{       by assumption, p1 is either regular, either on a ridge (or a}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00635}00635 \textcolor{comment}{       singularity), but p0p1 is not ridge*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00636}00636     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00637}00637     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00638}00638     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00639}00639     MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&b,1);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00640}00640 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00641}00641     \textcolor{comment}{/* 1. Fill matrice tAA and second member tAb with A=(\(\backslash\)sum X\_\{P\_i\}\string^2 \(\backslash\)sum}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00642}00642 \textcolor{comment}{     * Y\_\{P\_i\}\string^2 \(\backslash\)sum X\_\{P\_i\}Y\_\{P\_i\}) and b=\(\backslash\)sum Z\_\{P\_i\} with P\_i the physical}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00643}00643 \textcolor{comment}{     * points at edge [i0;i1] extremities and middle.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00644}00644 \textcolor{comment}{     * 2. Compute the physical coor \(\backslash\)a c of the curve edge's}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00645}00645 \textcolor{comment}{     * mid-\/point.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00646}00646 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00647}00647     \mbox{\hyperlink{anisosiz_8c_a358ab88c88f12024f1d2cf0d468b8efc}{MMG5\_fillDefmetregSys}}(k,p0,i0,b,r,c,lispoi,tAA,tAb);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00648}00648 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00649}00649     \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00650}00650     \textcolor{keywordflow}{for} (i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00651}00651       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00652}00652       \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} == \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} == par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00653}00653         \textcolor{keywordflow}{if} ( !isloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00654}00654           hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00655}00655           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00656}00656           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00657}00657           isloc = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00658}00658         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00659}00659         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00660}00660           \textcolor{comment}{// take the minimum value between the two local parameters asked by}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00661}00661           \textcolor{comment}{// the user.}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00662}00662           hausd = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00663}00663           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00664}00664           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00665}00665         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00666}00666       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00667}00667     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00668}00668   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00669}00669 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00670}00670   isqhmin = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00671}00671   isqhmax = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00672}00672 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00673}00673   \textcolor{comment}{/* 2. Solve tAA * tmp\_m = tAb and fill m with tmp\_m (after rotation) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00674}00674   \textcolor{keywordflow}{return}(\mbox{\hyperlink{anisosiz_8c_a640fc325aa0613ceed42a7b3cfc5ca10}{MMG5\_solveDefmetregSys}}( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},r, c, tAA, tAb, m, isqhmin, isqhmax,}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00675}00675                                  hausd));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00676}00676 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00677}00677 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00691}00691 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00692}\mbox{\hyperlink{anisosiz__s_8c_a77463152139f9e2f5e2623fa70bef498}{00692}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_a77463152139f9e2f5e2623fa70bef498}{MMGS\_intextmet}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int np,\textcolor{keywordtype}{double} me[6]) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00693}00693   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}         p0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00694}00694   \textcolor{keywordtype}{double}              *n;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00695}00695   \textcolor{keywordtype}{double}              dummy\_n[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00696}00696 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00697}00697    p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00698}00698 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00699}00699    dummy\_n[0] = dummy\_n[1] = dummy\_n[2] = 0.;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00700}00700 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00701}00701    \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a7d17f22a784b2da53dad4d1fa7785ce0}{MG\_SIN}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) || (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00702}00702      n = \&dummy\_n[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00703}00703    \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00704}00704    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00705}00705      n = \&p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00706}00706    \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00708}00708   \textcolor{keywordflow}{return} \mbox{\hyperlink{mettools_8c_af1fd6bc7220f4272d9b7ddc986ddecae}{MMG5\_mmgIntextmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np,me,n);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00709}00709 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00710}00710 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00711}00711 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00735}\mbox{\hyperlink{anisosiz__s_8c_a850c489fc4fe47416e128ae08824fdcd}{00735}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_a850c489fc4fe47416e128ae08824fdcd}{MMGS\_defsiz\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00736}00736   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00737}00737   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00738}00738   \textcolor{keywordtype}{double}        mm[6];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00739}00739   MMG5\_int      k;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00740}00740   int8\_t        ismet;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00741}00741   int8\_t        i;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00742}00742   \textcolor{keyword}{static} int8\_t mmgErr=0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00744}00744   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{isosiz_8c_ad25b7ab5d3a3918c7682ae506c608a9d}{MMG5\_defsiz\_startingMessage}} (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\_\_func\_\_) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00745}00745     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00746}00746   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00747}00747 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00748}00748   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00749}00749     ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00750}00750     ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00751}00751     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}}    = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00752}00752   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00753}00753 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00754}00754   \textcolor{keywordflow}{if} ( met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00755}00755     assert ( met-\/>\mbox{\hyperlink{structMMG5__Sol_aec9805cc13914dc2b870c07753adb31d}{np}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00756}00756     ismet = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00757}00757   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00758}00758   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00759}00759     ismet = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00760}00760 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00761}00761     MMG5\_calelt     = \mbox{\hyperlink{mmgcommon__private_8h_a257694db1d155b5804f67269f3c3b720}{MMG5\_caltri\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00762}00762     MMG5\_lenSurfEdg = \mbox{\hyperlink{inlined__functions__private_8h_ae37ac28bb21ba156ef9d26e102646992}{MMG5\_lenSurfEdg\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00763}00763 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00764}00764     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functions__s_8c_aa82c85c9bad897122c7ae0cee01815b5}{MMGS\_Set\_solSize}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a3e0b7e1298beaabada671bf465c477c2}{MMG5\_Vertex}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}},3) )}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00765}00765       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00766}00766   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00771}00771   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acebd56495a75526756faed8644f42c49}{nosizreq}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00772}00772     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{isosiz__s_8c_a29794a35e3056a4ea8105bf0ce7a4d01}{MMGS\_set\_metricAtPointsOnReqEdges}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ismet ) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00773}00773       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00774}00774     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00775}00775   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00776}00776 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00778}00778   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00779}00779     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00780}00780     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00781}00781 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00782}00782     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00783}00783       ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00784}00784       \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} || !\mbox{\hyperlink{mmgcommon__private_8h_aacf41a0e0a3fdf65d77fa5a97fa83bce}{MG\_VOK}}(ppt) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00785}00785       \textcolor{keywordflow}{if} ( ismet )  memcpy(mm,\&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*(pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i])],6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00786}00786 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00787}00787       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00788}00788         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_ad6689b29eb3edfd617cb4a865193d00b}{MMG5\_defmetsin}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00789}00789       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00790}00790       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00791}00791         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_a9502107eead2377badc73ea2c5f4db81}{MMG5\_defmetrid}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i))  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00792}00792       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00793}00793       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00794}00794         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_ae9d768e402d6cde198d7a60f4363ddb3}{MMG5\_defmetref}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00795}00795       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00796}00796       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00797}00797       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00798}00798         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_a0e16aa1fb6b1d9ce7a19e05654eddc58}{MMG5\_defmetreg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00799}00799       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00800}00800       \textcolor{keywordflow}{if} ( ismet ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00801}00801         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_a77463152139f9e2f5e2623fa70bef498}{MMGS\_intextmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i],mm) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00802}00802           \textcolor{keywordflow}{if} ( !mmgErr ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00803}00803             fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to intersect metrics"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00804}00804                     \textcolor{stringliteral}{"{} at point \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{}.\(\backslash\)n"{}},\_\_func\_\_,}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00805}00805                     \mbox{\hyperlink{gentools__s_8c_a4913c15d69c6ffc6af29d6b2eed26200}{MMGS\_indPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i]));}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00806}00806             mmgErr = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00807}00807           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00808}00808           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00809}00809         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00810}00810       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00811}00811       ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00812}00812     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00813}00813   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00814}00814   \textcolor{comment}{/* Now the metric storage at ridges is the "{}mmg"{} one. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00815}00815   \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a83364b3f6629f77eeb3761c0bd508edc}{metRidTyp}} = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00816}00816 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00821}00821   \mbox{\hyperlink{anisosiz_8c_a8cbf7130be23d609bcc515b0c4c5351a}{MMG5\_defUninitSize}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ismet );}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00822}00822 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00823}00823   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00824}00824 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00825}00825 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00835}\mbox{\hyperlink{anisosiz__s_8c_a350157db1b3ffe44dd54a4d7d19ff6b4}{00835}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__s_8c_a350157db1b3ffe44dd54a4d7d19ff6b4}{MMGS\_gradsiz\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00836}00836   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}  p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00837}00837   \textcolor{keywordtype}{double}       *m,mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00838}00838   MMG5\_int     k;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00839}00839   \textcolor{keywordtype}{int}          it;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00840}00840 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00841}00841   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} )}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00842}00842     fprintf(stdout,\textcolor{stringliteral}{"{}  ** Anisotropic mesh gradation\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00843}00843 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00844}00844   \textcolor{comment}{/* First step : make ridges iso in each apairing direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00845}00845   \textcolor{comment}{// remark ALGIANE: a mettre  plat : on veut vraiment faire a ? Pour une demi}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00846}00846   \textcolor{comment}{// sphre, on n'a pas envie de garder une mtrique "{}infinie du cot du plan et}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00847}00847   \textcolor{comment}{// petite dans la direction de la sphre?? "{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00848}00848   \textcolor{keywordflow}{for} (k=1; k<= \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00849}00849     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00850}00850     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_aacf41a0e0a3fdf65d77fa5a97fa83bce}{MG\_VOK}}(p1) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00851}00851     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00852}00852     \textcolor{keywordflow}{if} ( !(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00853}00853 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00854}00854     m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*k];}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00855}00855     mv = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[1],m[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00856}00856     m[1] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00857}00857     m[2] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00858}00858     mv = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[3],m[4]);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00859}00859     m[3] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00860}00860     m[4] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00861}00861   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00862}00862 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00863}00863   \textcolor{comment}{/* Second step : standard gradation procedure */}}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00864}00864   \mbox{\hyperlink{anisosiz_8c_ae07f4770282348afda5a5d51edf3c4ed}{MMG5\_gradsiz\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\&it);}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00865}00865 }
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00866}00866   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__s_8c_source_l00867}00867 \}}

\end{DoxyCode}
