\hypertarget{movpt__3d_8c_source}{}\doxysection{movpt\+\_\+3d.\+c}
\label{movpt__3d_8c_source}\index{src/mmg3d/movpt\_3d.c@{src/mmg3d/movpt\_3d.c}}
\mbox{\hyperlink{movpt__3d_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmg3d_8h}{libmmg3d.h}}"{}}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{inlined__functions__3d__private_8h}{inlined\_functions\_3d\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmg3dexterns__private_8h}{mmg3dexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00039}00039 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgexterns__private_8h}{mmgexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00058}\mbox{\hyperlink{libmmg3d__private_8h_aca7c7d879ba7a849ecb903c1d57cefd9}{00058}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a82f505eaeb8d82ec2cadc0e371d41708}{MMG5\_movintpt\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00059}00059                        int64\_t *list,\textcolor{keywordtype}{int} ilist,\textcolor{keywordtype}{int} improve) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00060}00060   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}          pt,pt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00061}00061   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}          p0,p1,p2,p3,ppt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00062}00062   \textcolor{keywordtype}{double}               vol,totvol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00063}00063   \textcolor{keywordtype}{double}               calold,calnew,callist[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00064}00064   \textcolor{keywordtype}{double}               len1,len2;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00065}00065   \textcolor{keywordtype}{int}                  iloc;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00066}00066   \textcolor{keywordtype}{int}                  k,i0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00067}00067   MMG5\_int             iel;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00069}00069   pt0    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00070}00070   ppt0   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00071}00071   memset(ppt0,0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Point}{MMG5\_Point}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00073}00073   \textcolor{comment}{/* Coordinates of optimal point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00074}00074   calold = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00075}00075   totvol = 0.0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00076}00076   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00077}00077     iel = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00078}00078     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00079}00079     p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00080}00080     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00081}00081     p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[2]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00082}00082     p3 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[3]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00083}00083     vol= \mbox{\hyperlink{mmgcommon__private_8h_a6b73b9ea92946221271273a053e0d83e}{MMG5\_det4pt}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00084}00084     totvol += vol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00085}00085     \textcolor{comment}{/* barycenter */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00086}00086     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] += 0.25 * vol*(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00087}00087     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] += 0.25 * vol*(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00088}00088     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] += 0.25 * vol*(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00089}00089     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00090}00090   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00091}00091   \textcolor{keywordflow}{if} (totvol < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00092}00092     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00093}00093   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00095}00095   totvol = 1.0 / totvol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00096}00096   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] *= totvol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00097}00097   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] *= totvol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00098}00098   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] *= totvol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00100}00100   \textcolor{comment}{/* Check new position validity */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00101}00101   calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00102}00102   i0 = -\/1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00103}00103   assert ( ilist>0 );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00104}00104   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00105}00105     iel = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00106}00106     i0  = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00107}00107     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00108}00108     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00109}00109     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0] = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00110}00110     callist[k] = \mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00111}00111     \textcolor{keywordflow}{if} (callist[k] < \mbox{\hyperlink{mmgcommon__private_8h_a80cb4724e6dc20a024e2b27dd47508da}{MMG5\_NULKAL}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00112}00112       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00113}00113     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00114}00114     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,callist[k]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00116}00116     \textcolor{keywordflow}{if} ( improve==2 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00117}00117       \textcolor{keywordflow}{for} ( iloc = 0; iloc < 3; ++iloc ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00118}00118         len1 =  \mbox{\hyperlink{inlined__functions__3d__private_8h_a49ca80501295f9432b76815b00b45ee3}{MMG5\_lenedg\_iso}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{libmmg3d__private_8h_a7ddbab47251941c87d000fa497856107}{MMG5\_arpt}}[i0][iloc],pt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00119}00119         len2 =  \mbox{\hyperlink{inlined__functions__3d__private_8h_a49ca80501295f9432b76815b00b45ee3}{MMG5\_lenedg\_iso}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{libmmg3d__private_8h_a7ddbab47251941c87d000fa497856107}{MMG5\_arpt}}[i0][iloc],pt0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00120}00120         \textcolor{keywordflow}{if} ( (len1 < MMG3D\_LOPTL \&\& len2 >= \mbox{\hyperlink{libmmg3d__private_8h_ad32eabcdb0d97053bd7ee95dbd2e0f58}{MMG3D\_LOPTL}}) ||}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00121}00121              (len1 > \mbox{\hyperlink{libmmg3d__private_8h_ad32eabcdb0d97053bd7ee95dbd2e0f58}{MMG3D\_LOPTL}} \&\& len2 >len1 ) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00122}00122           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00123}00123         \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00125}00125         \textcolor{keywordflow}{if} ( (len1 > \mbox{\hyperlink{libmmg3d__private_8h_a3b1b52e10f1e07ba7f9d6c139c9b6067}{MMG3D\_LOPTS}} \&\& len2 <= \mbox{\hyperlink{libmmg3d__private_8h_a3b1b52e10f1e07ba7f9d6c139c9b6067}{MMG3D\_LOPTS}}) ||}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00126}00126              (len1 < \mbox{\hyperlink{libmmg3d__private_8h_a3b1b52e10f1e07ba7f9d6c139c9b6067}{MMG3D\_LOPTS}} \&\& len2 <len1 ) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00127}00127           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00128}00128         \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00129}00129       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00130}00130     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00132}00132   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00133}00133   \textcolor{keywordflow}{if} (calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00134}00134     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00135}00135   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00136}00136   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00137}00137     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00138}00138   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00139}00139   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( improve \&\& calnew < 1.02 * calold ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00140}00140     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00141}00141   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00142}00142   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < 0.3 * calold ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00143}00143     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00144}00144   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00146}00146   \textcolor{comment}{/* update position */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00147}00147   assert ( i0 >=0 );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00148}00148   \textcolor{keywordflow}{if} ( PROctree )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00149}00149     \mbox{\hyperlink{PRoctree__3d_8c_a1d27caf707f3cd24b7f9f6dc01587713}{MMG3D\_movePROctree}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, PROctree, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0], ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}, p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00151}00151   p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00152}00152   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00153}00153   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00154}00154   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00155}00155   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00156}00156     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[k]/4])-\/>qual=callist[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00157}00157     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[k]/4])-\/>mark=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00158}00158   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00160}00160   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00161}00161 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00185}\mbox{\hyperlink{libmmg3d__private_8h_afc43d532a5c311a2ee9a6ce932300926}{00185}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_acd69bd2b0e9b12450bf7fdebf3c72740}{MMG5\_movintptLES\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00186}00186                           MMG5\_int *list,\textcolor{keywordtype}{int} ilist,\textcolor{keywordtype}{int} improve) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00187}00187   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}          pt,pt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00188}00188   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}          p0,p1,p2,p3,ppt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00189}00189   \textcolor{keywordtype}{double}               vol,totvol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00190}00190   \textcolor{keywordtype}{double}               calold,calnew,callist[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00191}00191   \textcolor{keywordtype}{double}               x21,y21,z21,x31,y31,z31,nx,ny,nz,bary[3],dd,len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00192}00192   \textcolor{keywordtype}{double}               u10[3],u20[3],u30[3],oldc[3],coe;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00193}00193   \textcolor{keywordtype}{int}                  k,ifac,iter,maxtou;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00194}00194   MMG5\_int             iel;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00196}00196   pt0    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00197}00197   ppt0   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00198}00198   memset(ppt0,0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Point}{MMG5\_Point}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00200}00200   \textcolor{comment}{/* Coordinates of optimal point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00201}00201   calold = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00202}00202   totvol = 0.0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00203}00203   assert ( ilist );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00204}00204   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00205}00205     iel  = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00206}00206     ifac = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00207}00207     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00208}00208     assert ( \mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00210}00210     p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ifac]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00211}00211     memcpy(oldc,p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00213}00213     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][0]]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00214}00214     p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][1]]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00215}00215     p3 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][2]]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00217}00217     vol= \mbox{\hyperlink{mmgcommon__private_8h_a6b73b9ea92946221271273a053e0d83e}{MMG5\_det4pt}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00218}00218     totvol += vol;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00219}00219 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00220}00220     \textcolor{comment}{/* local optimal point : length 1 over the normal of the face */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00221}00221     x21 = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]-\/p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00222}00222     y21 = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]-\/p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00223}00223     z21 = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]-\/p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00225}00225     x31 = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]-\/p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00226}00226     y31 = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]-\/p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00227}00227     z31 = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]-\/p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00229}00229     nx = (y31*z21 -\/ z31*y21);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00230}00230     ny = (z31*x21 -\/ x31*z21);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00231}00231     nz = (x31*y21 -\/ y31*x21);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00233}00233     dd = sqrt(nx*nx+ny*ny+nz*nz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00234}00234     assert ( dd > 0. \&\& \textcolor{stringliteral}{"{}degenerated element"{}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00235}00235     dd = 1./dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00236}00236     nx *= dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00237}00237     ny *= dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00238}00238     nz *= dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00240}00240     u10[0] = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00241}00241     u10[1] = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00242}00242     u10[2] = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00243}00243 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00244}00244     u20[0] = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00245}00245     u20[1] = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00246}00246     u20[2] = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00248}00248     u30[0] = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00249}00249     u30[1] = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00250}00250     u30[2] = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]-\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00251}00251 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00252}00252     assert ( met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][0]]] > 0. \&\& \textcolor{stringliteral}{"{}null metric at vertex 0"{}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00253}00253     assert ( met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][1]]] > 0. \&\& \textcolor{stringliteral}{"{}null metric at vertex 1"{}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00254}00254     assert ( met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][2]]] > 0. \&\& \textcolor{stringliteral}{"{}null metric at vertex 2"{}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00256}00256     len =  sqrt(u10[0]*u10[0]+u10[1]*u10[1]+u10[2]*u10[2])/met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][0]]]}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00257}00257       + sqrt(u20[0]*u20[0]+u20[1]*u20[1]+u20[2]*u20[2])/met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][1]]]}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00258}00258       + sqrt(u30[0]*u30[0]+u30[1]*u30[1]+u30[2]*u30[2])/met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][2]]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00259}00259 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00260}00260     len /= 3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00262}00262     assert ( len>0. \&\& \textcolor{stringliteral}{"{}degenerated element"{}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00264}00264     len = 1./len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00265}00265 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00266}00266     \textcolor{comment}{/* face barycenter */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00267}00267     bary[0] = (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]+p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]+p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0])/3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00268}00268     bary[1] = (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]+p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]+p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])/3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00269}00269     bary[2] = (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]+p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]+p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2])/3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00271}00271     \textcolor{comment}{/* Optimal point: barycenter of local optimal points */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00272}00272     vol = 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00273}00273     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] += vol* ( bary[0] + nx * len );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00274}00274     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] += vol* ( bary[1] + ny * len );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00275}00275     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] += vol* ( bary[2] + nz * len );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00276}00276     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00277}00277   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00278}00278   \textcolor{keywordflow}{if} (totvol < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00279}00279     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00280}00280   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00282}00282   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] *= 1./(double) ilist;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00283}00283   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] *= 1./(double) ilist;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00284}00284   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] *= 1./(double) ilist;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00286}00286   coe = 0.9;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00287}00287   maxtou = 10;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00288}00288   iter = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00289}00289   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00290}00290     p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = (1. -\/ coe) *oldc[0] + coe * ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00291}00291     p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = (1. -\/ coe) *oldc[1] + coe * ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00292}00292     p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = (1. -\/ coe) *oldc[2] + coe * ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00294}00294     \textcolor{comment}{/* Check new position validity */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00295}00295     calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00296}00296     for (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00297}00297       iel = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00298}00298       pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00299}00299       memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00300}00300       callist[k] = MMG5\_caltet(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt0); \textcolor{comment}{// MMG5\_orcal(mesh,met,0)}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00301}00301       \textcolor{keywordflow}{if} (calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& callist[k] <= calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00302}00302         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00303}00303       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((callist[k] < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}})) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00304}00304         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00305}00305       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( callist[k] < 0.1) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00306}00306         \textcolor{keywordflow}{if} (callist[k] < 1.01*calold) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00307}00307       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00308}00308         \textcolor{keywordflow}{if} (callist[k] < 1.02*calold) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00309}00309       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00310}00310       calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,callist[k]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00311}00311     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00312}00312     \textcolor{keywordflow}{if}(k<ilist) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00313}00313       coe *= 0.5;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00314}00314       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00315}00315     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00316}00316     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00317}00317   \} \textcolor{keywordflow}{while}(++iter <= maxtou );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00318}00318 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00319}00319   \textcolor{keywordflow}{if} ( iter > maxtou ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00320}00320     memcpy(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},oldc,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00321}00321     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00322}00322   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00324}00324    \textcolor{comment}{/* update position */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00325}00325   \textcolor{keywordflow}{if} ( PROctree )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00326}00326     \mbox{\hyperlink{PRoctree__3d_8c_a1d27caf707f3cd24b7f9f6dc01587713}{MMG3D\_movePROctree}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, PROctree, \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[0]/4].\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[list[0]\%4], ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}, p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00328}00328    \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00329}00329      (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[k]/4])-\/>qual=callist[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00330}00330      (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[k]/4])-\/>mark=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00331}00331    \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00333}00333    \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00334}00334 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00350}\mbox{\hyperlink{libmmg3d__private_8h_a4cb2f26898d4477cffafbcc97ab57ab5}{00350}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a47a6b8cc18ea13e97b3488dae4d6a6b5}{MMG3D\_rotate\_surfacicBall}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int *lists,\textcolor{keywordtype}{int} ilists,MMG5\_int ip0,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00351}00351                               \textcolor{keywordtype}{double} r[3][3],\textcolor{keywordtype}{double} *lispoi) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00352}00352   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}       pt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00353}00353   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}       p0,p1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00354}00354   \textcolor{keywordtype}{double}            ux,uy,uz,det2d;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00355}00355   MMG5\_int          k,na,nb,ntempa,ntempb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00356}00356   \textcolor{keywordtype}{int}               l;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00357}00357   uint8\_t           iface,i;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00359}00359   k     = lists[0] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00360}00360   iface = lists[0] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00361}00361   pt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00362}00362   p0    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00364}00364   na = nb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00365}00365   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00366}00366     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]] != ip0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00367}00367       \textcolor{keywordflow}{if} ( !na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00368}00368         na = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00369}00369       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00370}00370         nb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00371}00371     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00372}00372   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00374}00374   \textcolor{keywordflow}{for} (l=1; l<ilists; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00375}00375     k     = lists[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00376}00376     iface = lists[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00377}00377     pt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00378}00378     ntempa = ntempb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00379}00379     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00380}00380       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]] != ip0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00381}00381         \textcolor{keywordflow}{if} ( !ntempa )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00382}00382           ntempa = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00383}00383         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00384}00384           ntempb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00385}00385       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00386}00386     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00387}00387     \textcolor{keywordflow}{if} ( ntempa == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00388}00388       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[na];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00389}00389     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ntempa == nb )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00390}00390       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00391}00391     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ntempb == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00392}00392       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[na];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00393}00393     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00394}00394       assert(ntempb == nb);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00395}00395       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00396}00396     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00397}00397     ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00398}00398     uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00399}00399     uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00400}00400 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00401}00401     lispoi[3*l+1] =      r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00402}00402     lispoi[3*l+2] =      r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00403}00403     lispoi[3*l+3] =      r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00405}00405     na = ntempa;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00406}00406     nb = ntempb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00407}00407   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00408}00408 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00409}00409   \textcolor{comment}{/* Finish with point 0 */};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00410}00410   k      = lists[0] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00411}00411   iface  = lists[0] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00412}00412   pt     = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00413}00413   ntempa = ntempb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00414}00414   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00415}00415     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]] != ip0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00416}00416       \textcolor{keywordflow}{if} ( !ntempa )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00417}00417         ntempa = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00418}00418       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00419}00419         ntempb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00420}00420     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00421}00421   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00422}00422   \textcolor{keywordflow}{if} ( ntempa == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00423}00423     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[na];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00424}00424   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ntempa == nb )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00425}00425     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00426}00426   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ntempb == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00427}00427     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[na];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00428}00428   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00429}00429     assert(ntempb == nb);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00430}00430     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00431}00431   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00432}00432 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00433}00433   ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00434}00434   uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00435}00435   uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00437}00437   lispoi[1] =    r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00438}00438   lispoi[2] =    r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00439}00439   lispoi[3] =    r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00440}00440 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00441}00441   \textcolor{comment}{/* list goes modulo ilist */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00442}00442   lispoi[3*ilists+1] = lispoi[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00443}00443   lispoi[3*ilists+2] = lispoi[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00444}00444   lispoi[3*ilists+3] = lispoi[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00449}00449   \textcolor{comment}{/* Check all projections over tangent plane. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00450}00450   \textcolor{keywordflow}{for} (k=0; k<ilists-\/1; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00451}00451     det2d = lispoi[3*k+1]*lispoi[3*(k+1)+2] -\/ lispoi[3*k+2]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00452}00452     \textcolor{keywordflow}{if} ( det2d < 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00453}00453       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00454}00454     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00455}00455   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00456}00456   det2d = lispoi[3*(ilists-\/1)+1]*lispoi[3*0+2] -\/ lispoi[3*(ilists-\/1)+2]*lispoi[3*0+1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00457}00457   \textcolor{keywordflow}{if} ( det2d < 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00458}00458     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00459}00459   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00460}00460 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00461}00461   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00462}00462 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00464}00464 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00482}\mbox{\hyperlink{libmmg3d__private_8h_adc23dd08adca835eb2bb69e1acb6a5b2}{00482}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_ad37612e25f5c0549e0addbf6f5e2344c}{MMG3D\_movbdyregpt\_geom}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int *lists,\textcolor{keyword}{const} MMG5\_int kel,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00483}00483                            \textcolor{keyword}{const} MMG5\_int ip0,\textcolor{keywordtype}{double} n[3],\textcolor{keywordtype}{double} lambda[3],\textcolor{keywordtype}{double} o[3],}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00484}00484                            \textcolor{keywordtype}{double} no[3]) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00485}00485   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}       pt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00486}00486   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}      pxt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00487}00487   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}       p1,p2,ppt0,p0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00488}00488   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}         tt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00489}00489   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}      pxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00490}00490   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}       b;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00491}00491   \textcolor{keywordtype}{double}            uv[2],to[3],detloc;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00492}00492   \textcolor{keywordtype}{int}               iel,na,nb,ntempb,ntempc,nxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00493}00493   uint8\_t           iface,i;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00494}00494   \textcolor{keyword}{static} int8\_t     mmgErr0=0,mmgErr1=0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00495}00495 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00496}00496   iel    = lists[kel] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00497}00497   iface  = lists[kel] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00498}00498   pt     = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00499}00499   pxt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00500}00500   p0     = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00501}00501 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00502}00502   assert( 0<=iface \&\& iface<4 \&\& \textcolor{stringliteral}{"{}unexpected local face idx"{}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00503}00503   \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iface,\&tt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00505}00505   \textcolor{keywordflow}{if}(!MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&tt,\&b,\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},iface)))\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00506}00506     \textcolor{keywordflow}{if}( !mmgErr0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00507}00507       mmgErr0 = 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00508}00508       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: function MMG5\_bezierCP return 0.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00509}00509               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00510}00510     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00511}00511     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00512}00512   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00514}00514   \textcolor{comment}{/* Now, for Bezier interpolation, one should identify which of i,i1,i2 is}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00515}00515 \textcolor{comment}{     0,1,2 recall uv[0] = barycentric coord associated to pt-\/>v[1], uv[1]}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00516}00516 \textcolor{comment}{     associated to pt-\/>v[2] and 1-\/uv[0]-\/uv[1] is associated to pt-\/>v[0]. For}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00517}00517 \textcolor{comment}{     this, use the fact that kel, kel + 1 is positively oriented with respect to}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00518}00518 \textcolor{comment}{     n */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00519}00519   na = nb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00520}00520   \textcolor{keywordflow}{for}( i=0 ; i<4 ; i++ )\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00521}00521     \textcolor{keywordflow}{if} ( (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != ip0) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iface]) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00522}00522       \textcolor{keywordflow}{if} ( !na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00523}00523         na = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00524}00524       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00525}00525         nb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00526}00526     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00527}00527   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00528}00528   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[na];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00529}00529   p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00530}00530   detloc = \mbox{\hyperlink{mmgcommon__private_8h_a67b2561d3ae544e7aa9a7d9bee2b72ec}{MMG5\_det3pt1vec}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},n);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00531}00531 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00532}00532   \textcolor{comment}{/* ntempa=point to which is associated 1-\/uv[0]-\/uv[1], ntempb=uv[0], ntempc=uv[1] */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00533}00533   ntempb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00534}00534   ntempc = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][2]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00535}00535 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00536}00536   \textcolor{comment}{/* na = lispoi[kel] -\/> lambda[1], nb = lispoi[kel+1] -\/> lambda[2] */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00537}00537   \textcolor{keywordflow}{if} ( detloc > 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00538}00538     \textcolor{keywordflow}{if} ( ntempb == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00539}00539       uv[0] = lambda[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00540}00540     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ntempb == nb )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00541}00541       uv[0] = lambda[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00542}00542     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00543}00543       assert(ntempb == ip0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00544}00544       uv[0] = lambda[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00545}00545     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00546}00546     \textcolor{keywordflow}{if} ( ntempc == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00547}00547       uv[1] = lambda[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00548}00548     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ntempc == nb )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00549}00549       uv[1] = lambda[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00550}00550     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00551}00551       assert(ntempc == ip0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00552}00552       uv[1] = lambda[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00553}00553     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00554}00554   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00555}00555   \textcolor{comment}{/* nb = lispoi[kel] -\/> lambda[1], na = lispoi[kel+1] -\/> lambda[2] */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00556}00556   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00557}00557     \textcolor{keywordflow}{if} ( ntempb == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00558}00558       uv[0] = lambda[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00559}00559     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ntempb == nb )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00560}00560       uv[0] = lambda[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00561}00561     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00562}00562       assert(ntempb == ip0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00563}00563       uv[0] = lambda[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00564}00564     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00565}00565     \textcolor{keywordflow}{if} ( ntempc == na )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00566}00566       uv[1] = lambda[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00567}00567     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ntempc == nb )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00568}00568       uv[1] = lambda[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00569}00569     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00570}00570       assert(ntempc == ip0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00571}00571       uv[1] = lambda[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00572}00572     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00573}00573   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00574}00574   \textcolor{keywordflow}{if}(!\mbox{\hyperlink{bezier__3d_8c_a0c564e9854cf8e694775fc8510ddee2b}{MMG3D\_bezierInt}}(\&b,uv,o,no,to))\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00575}00575    \textcolor{keywordflow}{if}( !mmgErr1 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00576}00576       mmgErr1 = 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00577}00577       fprintf(stderr,\textcolor{stringliteral}{"{}  \#\# Error: \%s: function MMG3D\_bezierInt return 0.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00578}00578               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00579}00579    \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00580}00580    \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00581}00581   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00582}00582 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00583}00583   \textcolor{comment}{/* Test : make sure that geometric approximation has not been degraded too much */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00584}00584   ppt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00585}00585   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00586}00586   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00587}00587   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00588}00588 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00589}00589   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}      = p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00590}00590   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}}      = p0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00591}00591 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00592}00592 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00593}00593   nxp = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}} + 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00594}00594   \textcolor{keywordflow}{if} ( nxp > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00595}00595     \mbox{\hyperlink{mmgcommon__private_8h_a7c5021138095892cf2699f36a7c526ae}{MMG5\_TAB\_RECALLOC}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}},\mbox{\hyperlink{mmgcommon__private_8h_a50b381cd31a4a90064ce1d936a7c037d}{MMG5\_GAP}},\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}},}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00596}00596                        \textcolor{stringliteral}{"{}larger xpoint table"{}},}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00597}00597                        \textcolor{keywordflow}{return} 0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00598}00598   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00599}00599   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} = nxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00600}00600   pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[nxp];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00601}00601   memcpy(pxp,\&(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}]),\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00602}00602   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0] = no[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00603}00603   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1] = no[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00604}00604   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2] = no[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00606}00606   \textcolor{keywordflow}{return} nxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00607}00607 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00608}00608 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00625}\mbox{\hyperlink{libmmg3d__private_8h_a40ff8eac06fcaa74733a3de4ccdfd3a5}{00625}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a7459e48577bc41c3e8615865853ae09e}{MMG5\_movbdyregpt\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00626}00626                           \textcolor{keywordtype}{int} ilistv,MMG5\_int *lists,\textcolor{keywordtype}{int} ilists,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00627}00627                           \textcolor{keywordtype}{int} improveSurf,\textcolor{keywordtype}{int} improveVol) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00628}00628   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}       pt,pt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00629}00629   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}       p0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00630}00630   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}         tt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00631}00631   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}      pxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00632}00632   \textcolor{keywordtype}{double}            *n,r[3][3],lispoi[3*\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+1],ux,uy,det2d;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00633}00633   \textcolor{keywordtype}{double}            detloc,oppt[2],step,lambda[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00634}00634   \textcolor{keywordtype}{double}            ll,m[2],o[3],no[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00635}00635   \textcolor{keywordtype}{double}            calold,calnew,caltmp,callist[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00636}00636   \textcolor{keywordtype}{int}               l,nut,nxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00637}00637   MMG5\_int          kel,k,ip0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00638}00638   uint8\_t           i0,iface,i;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00639}00639 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00640}00640   step = 0.1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00641}00641   nut    = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00642}00642   oppt[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00643}00643   oppt[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00644}00644   \textcolor{keywordflow}{if} ( ilists < 2 )      \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00645}00645 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00646}00646   k      = listv[0] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00647}00647   i0 = listv[0] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00648}00648   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00649}00649   ip0 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00650}00650   p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00651}00651   assert( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} \&\& !\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00652}00652 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00653}00653   n = \&(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00654}00654 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00656}00656   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r) ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00657}00657 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00660}00660   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{movpt__3d_8c_a47a6b8cc18ea13e97b3488dae4d6a6b5}{MMG3D\_rotate\_surfacicBall}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},lists,ilists,ip0,r,lispoi) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00661}00661     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00662}00662   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00666}00666   \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00667}00667     m[0] = 0.5*(lispoi[3*(k+1)+1] + lispoi[3*k+1]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00668}00668     m[1] = 0.5*(lispoi[3*(k+1)+2] + lispoi[3*k+2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00669}00669     ux = lispoi[3*(k+1)+1] -\/ lispoi[3*k+1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00670}00670     uy = lispoi[3*(k+1)+2] -\/ lispoi[3*k+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00671}00671     ll = ux*ux + uy*uy;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00672}00672     \textcolor{keywordflow}{if} ( ll < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} )    \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00673}00673     nut++;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00674}00674     oppt[0] += (m[0]-\/\mbox{\hyperlink{mmgcommon__private_8h_a1ef62ac9293c5c02e83a189de5e7c8c1}{MMG5\_SQR32}}*uy);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00675}00675     oppt[1] += (m[1]+\mbox{\hyperlink{mmgcommon__private_8h_a1ef62ac9293c5c02e83a189de5e7c8c1}{MMG5\_SQR32}}*ux);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00676}00676   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00677}00677   oppt[0] *= (1.0 / nut);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00678}00678   oppt[1] *= (1.0 / nut);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00679}00679 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00681}00681   det2d = lispoi[1]*oppt[1] -\/ lispoi[2]*oppt[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00682}00682   kel = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00683}00683   \textcolor{keywordflow}{if} ( det2d >= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00684}00684     \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00685}00685       detloc = oppt[0]*lispoi[3*(k+1)+2] -\/ oppt[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00686}00686       \textcolor{keywordflow}{if} ( detloc >= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00687}00687         kel = k;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00688}00688         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00689}00689       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00690}00690     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00691}00691     \textcolor{keywordflow}{if} ( k == ilists ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00692}00692   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00693}00693   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00694}00694     \textcolor{keywordflow}{for} (k=ilists-\/1; k>=0; k-\/-\/) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00695}00695       detloc = lispoi[3*k+1]*oppt[1] -\/ lispoi[3*k+2]*oppt[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00696}00696       \textcolor{keywordflow}{if} ( detloc >= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00697}00697         kel = k;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00698}00698         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00699}00699       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00700}00700     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00701}00701     \textcolor{keywordflow}{if} ( k == -\/1 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00702}00702   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00703}00703 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00704}00704   \textcolor{comment}{/* Sizing of time step : make sure point does not go out corresponding triangle. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00705}00705   det2d = -\/oppt[1]*(lispoi[3*(kel+1)+1] -\/ lispoi[3*(kel)+1]) + \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00706}00706     oppt[0]*(lispoi[3*(kel+1)+2] -\/ lispoi[3*(kel)+2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00707}00707   \textcolor{keywordflow}{if} ( fabs(det2d) < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00708}00708 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00709}00709   det2d = 1.0 / det2d;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00710}00710   step *= det2d;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00711}00711 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00712}00712   det2d = lispoi[3*(kel)+1]*(lispoi[3*(kel+1)+2] -\/ lispoi[3*(kel)+2]) -\/ \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00713}00713     lispoi[3*(kel)+2 ]*(lispoi[3*(kel+1)+1] -\/ lispoi[3*(kel)+1]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00714}00714   step *= det2d;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00715}00715   step  = fabs(step);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00716}00716   oppt[0] *= step;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00717}00717   oppt[1] *= step;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00718}00718 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00719}00719   \textcolor{comment}{/* Computation of the barycentric coordinates of the new point in the corresponding triangle. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00720}00720   det2d = lispoi[3*kel+1]*lispoi[3*(kel+1)+2] -\/ lispoi[3*kel+2]*lispoi[3*(kel+1)+1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00721}00721   \textcolor{keywordflow}{if} ( det2d < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} )    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00722}00722   det2d = 1.0 / det2d;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00723}00723   lambda[1] = lispoi[3*(kel+1)+2]*oppt[0] -\/ lispoi[3*(kel+1)+1]*oppt[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00724}00724   lambda[2] = -\/lispoi[3*(kel)+2]*oppt[0] + lispoi[3*(kel)+1]*oppt[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00725}00725   lambda[1]*= (det2d);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00726}00726   lambda[2]*= (det2d);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00727}00727   lambda[0] = 1.0 -\/ lambda[1] -\/ lambda[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00728}00728 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00730}00730   nxp = \mbox{\hyperlink{movpt__3d_8c_ad37612e25f5c0549e0addbf6f5e2344c}{MMG3D\_movbdyregpt\_geom}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},lists,kel,ip0,n,lambda,o,no);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00731}00731   \textcolor{keywordflow}{if} ( nxp < 0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00732}00732     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00733}00733   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00734}00734   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !nxp ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00735}00735     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00736}00736   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00737}00737   pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[nxp];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00738}00738 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00739}00739   \textcolor{comment}{/* For each surfacic triangle, build a virtual displaced triangle for check purposes */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00740}00740   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00741}00741   \textcolor{keywordflow}{for} (l=0; l<ilists; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00742}00742     k           = lists[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00743}00743     iface       = lists[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00744}00744 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00745}00745     assert( 0<=iface \&\& iface<4 \&\& \textcolor{stringliteral}{"{}unexpected local face idx"{}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00746}00746     \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,iface,\&tt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00747}00747     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold,MMG5\_caltri(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\&tt));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00748}00748 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00749}00749     \textcolor{keywordflow}{for}( i=0 ; i<3 ; i++ )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00750}00750       \textcolor{keywordflow}{if} ( tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] == ip0 )      \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00751}00751     assert(i<3);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00752}00752     \textcolor{keywordflow}{if} ( i==3 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00753}00753 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00754}00754     tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00755}00755 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00756}00756     caltmp = MMG5\_caltri(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\&tt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00757}00757     \textcolor{keywordflow}{if} ( caltmp < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00758}00758       \textcolor{comment}{/* We don't check the input triangle qualities, thus we may have a very}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00759}00759 \textcolor{comment}{       * bad triangle in our mesh */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00760}00760       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00761}00761     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00762}00762     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,caltmp);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00763}00763   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00764}00764   \textcolor{keywordflow}{if} ( calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold )    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00765}00765   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}}) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00766}00766   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (improveSurf \&\& calnew < 1.02*calold) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00767}00767   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < 0.3*calold )        \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00768}00768   memset(pxp,0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00769}00769 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00770}00770   \textcolor{comment}{/* Test : check whether all volumes remain positive with new position of the point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00771}00771   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00772}00772 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00773}00773   \textcolor{keywordflow}{for} (l=0; l<ilistv; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00774}00774     k    = listv[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00775}00775     i0 = listv[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00776}00776     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00777}00777     pt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00778}00778     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00779}00779     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0] = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00780}00780     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00781}00781     callist[l]=\mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00783}00783     \textcolor{keywordflow}{if} (callist[l] < \mbox{\hyperlink{mmgcommon__private_8h_a80cb4724e6dc20a024e2b27dd47508da}{MMG5\_NULKAL}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00784}00784       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00785}00785     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00786}00786     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,callist[l]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00787}00787 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00788}00788   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00789}00789 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00790}00790 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00791}00791   \textcolor{keywordflow}{if} (calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00792}00792     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00793}00793   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00794}00794   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00795}00795     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00796}00796   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00797}00797   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (improveVol \&\& calnew < calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00798}00798     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00799}00799   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00800}00800   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (calnew < 0.3*calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00801}00801     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00802}00802   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00803}00803 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00804}00804   \textcolor{comment}{/* When all tests have been carried out, update coordinates and normals */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00805}00805   \textcolor{keywordflow}{if} ( PROctree )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00806}00806     \mbox{\hyperlink{PRoctree__3d_8c_a1d27caf707f3cd24b7f9f6dc01587713}{MMG3D\_movePROctree}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, PROctree, ip0, o, p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00807}00807 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00808}00808   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00809}00809   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00810}00810   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00811}00811 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00812}00812   n[0] = no[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00813}00813   n[1] = no[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00814}00814   n[2] = no[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00815}00815 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00816}00816   \textcolor{keywordflow}{for}(l=0; l<ilistv; l++)\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00817}00817     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[l]/4])-\/>qual= callist[l];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00818}00818     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[l]/4])-\/>mark=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00819}00819   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00820}00820   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00821}00821 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00822}00822 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00844}00844 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00845}\mbox{\hyperlink{movpt__3d_8c_a6249fc38f68fb66fbdc60de9aa382971}{00845}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a6249fc38f68fb66fbdc60de9aa382971}{MMG3D\_curveEndingPts\_chkEdg}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int *lists,\textcolor{keywordtype}{int} l,MMG5\_int ip0,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00846}00846                                 MMG5\_int *ipa,MMG5\_int *ipb,\textcolor{keyword}{const} int16\_t edgTag,MMG5\_int *ip) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00847}00847 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00848}00848   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}           pt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00849}00849   MMG5\_int              iel,iptmpa,iptmpb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00850}00850   int16\_t               tag;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00851}00851   uint8\_t               i,ie,iface,iea,ieb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00852}00852 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00853}00853   iel   = lists[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00854}00854   iface = lists[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00855}00855   pt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00856}00856   iea = ieb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00857}00857 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00858}00858   assert ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& \textcolor{stringliteral}{"{}tetra with boundary face has a xtetra"{}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00859}00859 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00860}00860   \textcolor{comment}{/* For each bdy face that contains ip0, store the index of the 2 edges}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00861}00861 \textcolor{comment}{   * passing through \(\backslash\)a ip0 in \(\backslash\)a iea and \(\backslash\)a ieb. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00862}00862   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00863}00863     ie = \mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iface][i]; \textcolor{comment}{//index in tet of edge i on face iface}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00864}00864     \textcolor{keywordflow}{if} ( (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ie][0]] == ip0) || (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ie][1]] == ip0) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00865}00865       \textcolor{keywordflow}{if} ( !iea )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00866}00866         iea = ie;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00867}00867       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00868}00868         ieb = ie;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00869}00869     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00870}00870   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00871}00871   \textcolor{comment}{/* In current face (\(\backslash\)a iface), store in \(\backslash\)a iptmpa the global index of the}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00872}00872 \textcolor{comment}{   * second vertex of edge \(\backslash\)a iea (first vertex being \(\backslash\)a ip0). */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00873}00873   \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iea][0]] != ip0 )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00874}00874     iptmpa = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iea][0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00875}00875   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00876}00876     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iea][1]] != ip0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00877}00877     iptmpa = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iea][1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00878}00878   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00879}00879   \textcolor{comment}{/* In current face (\(\backslash\)a iface), store in \(\backslash\)a iptmpb the global index of the}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00880}00880 \textcolor{comment}{   * second vertex of edge \(\backslash\)a ieb (first vertex being \(\backslash\)a ip0). */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00881}00881   \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ieb][0]] != ip0 )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00882}00882     iptmpb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ieb][0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00883}00883   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00884}00884     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ieb][1]] != ip0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00885}00885     iptmpb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ieb][1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00886}00886   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00887}00887 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00888}00888   \textcolor{comment}{/* Search if the edge ip0-\/iptmpa is the edge at the interface with previous}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00889}00889 \textcolor{comment}{   * triangle. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00890}00890   \textcolor{keywordflow}{if} ( (iptmpa == *ipa) || (iptmpa == *ipb) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00891}00891     tag = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iea];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00892}00892     \textcolor{keywordflow}{if} ( edgTag \& tag ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00893}00893       \textcolor{comment}{/* The featured edge has been found. End of ball processing. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00894}00894       *ip = iptmpa;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00895}00895       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00896}00896     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00897}00897   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00898}00898 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00899}00899   \textcolor{comment}{/* Search if the edge ip0-\/iptmpb is the edge at the interface with previous}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00900}00900 \textcolor{comment}{   * triangle. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00901}00901   \textcolor{keywordflow}{if} ( (iptmpb == *ipa) || (iptmpb == *ipb) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00902}00902     tag = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ieb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00903}00903     \textcolor{keywordflow}{if} ( edgTag \& tag ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00904}00904       \textcolor{comment}{/* The featured edge has been found. End of ball processing. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00905}00905       *ip = iptmpb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00906}00906       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00907}00907     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00908}00908   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00909}00909 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00910}00910   \textcolor{comment}{/* Update face vertices for next item processing */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00911}00911   *ipa = iptmpa;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00912}00912   *ipb = iptmpb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00913}00913 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00914}00914   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00915}00915 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00916}00916 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00936}\mbox{\hyperlink{libmmg3d__private_8h_a05e4b8155234163d18c7060554147c9f}{00936}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a8b37ca79da8a3ff7493f6e5cf5134720}{MMG3D\_curveEndingPts}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int *lists,\textcolor{keywordtype}{int} ilists,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00937}00937                          \textcolor{keyword}{const} int16\_t edgTag, MMG5\_int ip0,MMG5\_int *ip1,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00938}00938                          MMG5\_int *ip2) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00939}00939   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}           pt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00940}00940   MMG5\_int              iel,ipa,ipb;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00941}00941   \textcolor{keywordtype}{int}                   l;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00942}00942   uint8\_t               i,iface;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00943}00943 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00949}00949   \textcolor{comment}{/* Get first edge to initialize the loop: \(\backslash\)a ip0 is the global idx of the}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00950}00950 \textcolor{comment}{   * point we want to move, store in \(\backslash\)a ipa and \(\backslash\)a ipb the global indices of the}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00951}00951 \textcolor{comment}{   * 2 other vertices of the boundary face from which we start. When processing}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00952}00952 \textcolor{comment}{   * next triangle we will find either the edge ip0-\/ipa, or ip0-\/ipb, this will}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00953}00953 \textcolor{comment}{   * be the first edge that we will check. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00954}00954   iel = lists[0]/4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00955}00955   iface = lists[0]\%4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00956}00956   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00957}00957   ipa = ipb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00958}00958   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00959}00959     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]] != ip0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00960}00960       \textcolor{keywordflow}{if} ( !ipa )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00961}00961         ipa = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00962}00962       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00963}00963         ipb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00964}00964     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00965}00965   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00966}00966   assert(ipa \&\& ipb);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00967}00967 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00968}00968   \textcolor{comment}{/* Travel surfacic list of \(\backslash\)a ip0 and search if the edge at interface of}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00969}00969 \textcolor{comment}{   * boundary triangles stored in lists[l] and lists[l-\/1] belongs to our curve}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00970}00970 \textcolor{comment}{   * (\(\backslash\)a edgTag edge). */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00971}00971   \textcolor{keywordflow}{for} (l=1; l<ilists; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00972}00972     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{movpt__3d_8c_a6249fc38f68fb66fbdc60de9aa382971}{MMG3D\_curveEndingPts\_chkEdg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},lists,l,ip0,\&ipa,\&ipb,edgTag,ip1) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00973}00973       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00974}00974     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00975}00975   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00976}00976 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00983}00983   \textcolor{comment}{/* Get first edge to initialize the loop: \(\backslash\)a ip0 is the global idx of the}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00984}00984 \textcolor{comment}{   * point we want to move, store in \(\backslash\)a ipa and \(\backslash\)a ipb the global indices of the}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00985}00985 \textcolor{comment}{   * 2 other vertices of the boundary face from which we start. When processing}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00986}00986 \textcolor{comment}{   * next triangle we will find either the edge ip0-\/ipa, or ip0-\/ipb, this will}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00987}00987 \textcolor{comment}{   * be the first edge that we will check. */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00988}00988   iel = lists[0]/4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00989}00989   iface = lists[0]\%4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00990}00990   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00991}00991   ipa = ipb = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00992}00992   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00993}00993     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]] != ip0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00994}00994       \textcolor{keywordflow}{if} ( !ipa )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00995}00995         ipa = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00996}00996       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00997}00997         ipb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][i]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00998}00998     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l00999}00999   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01000}01000   assert(ipa \&\& ipb);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01001}01001 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01002}01002   \textcolor{comment}{/* Travel surfacic list of \(\backslash\)a ip0 and search if the edge at interface of}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01003}01003 \textcolor{comment}{   * boundary triangles stored in lists[l] and lists[l+1] belongs to our curve}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01004}01004 \textcolor{comment}{   * (\(\backslash\)a edgTag edge). */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01005}01005   \textcolor{keywordflow}{for} (l=ilists-\/1; l>0; l-\/-\/) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01006}01006     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{movpt__3d_8c_a6249fc38f68fb66fbdc60de9aa382971}{MMG3D\_curveEndingPts\_chkEdg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},lists,l,ip0,\&ipa,\&ipb,edgTag,ip2) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01007}01007       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01008}01008     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01009}01009   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01010}01010 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01011}01011   \textcolor{comment}{/* Check that we have found two distinct ending points */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01012}01012   \textcolor{keywordflow}{if} ( !(*ip1) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01013}01013     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01014}01014   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01015}01015   \textcolor{keywordflow}{if} ( !(*ip2) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01016}01016     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01017}01017   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01018}01018   \textcolor{keywordflow}{if} ( (*ip1) == (*ip2) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01019}01019     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01020}01020   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01021}01021 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01022}01022   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01023}01023 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01024}01024 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01048}\mbox{\hyperlink{libmmg3d__private_8h_a26154d621ea7edccaa0ced7dd56458fc}{01048}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a26154d621ea7edccaa0ced7dd56458fc}{MMG3D\_movbdycurvept\_chckAndUpdate}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01049}01049                                       \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01050}01050                                       \textcolor{keywordtype}{int} ilistv,\textcolor{keywordtype}{int} improve,\mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} p0,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01051}01051                                       MMG5\_int ip0,uint8\_t isrid,\textcolor{keywordtype}{double} o[3],}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01052}01052                                       \textcolor{keywordtype}{double} no[3],\textcolor{keywordtype}{double} no2[3],\textcolor{keywordtype}{double} to[3]) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01053}01053 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01054}01054   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}           pt,pt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01055}01055   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}          pxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01056}01056   \textcolor{keywordtype}{double}                calold,calnew,callist[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01057}01057   MMG5\_int              iel;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01058}01058   \textcolor{keywordtype}{int}                   l;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01059}01059   int8\_t                i0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01060}01060 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01062}01062   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01063}01063 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01064}01064   \textcolor{keywordflow}{for}( l=0 ; l<ilistv ; l++ )\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01065}01065     iel = listv[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01066}01066     i0  = listv[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01067}01067     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01068}01068     pt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01069}01069     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01070}01070     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0] = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01071}01071     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01072}01072     callist[l] = \mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01073}01073     \textcolor{keywordflow}{if} (callist[l] < \mbox{\hyperlink{mmgcommon__private_8h_a80cb4724e6dc20a024e2b27dd47508da}{MMG5\_NULKAL}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01074}01074       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01075}01075     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01076}01076     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,callist[l]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01077}01077   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01078}01078   \textcolor{keywordflow}{if} ((calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold) ||}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01079}01079       (calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}}) || (calnew <= 0.3*calold)) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01080}01080     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01081}01081   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (improve \&\& calnew < calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01082}01082     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01083}01083   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01084}01084 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01086}01086   \textcolor{keywordflow}{if} ( PROctree ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01087}01087     \mbox{\hyperlink{PRoctree__3d_8c_a1d27caf707f3cd24b7f9f6dc01587713}{MMG3D\_movePROctree}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, PROctree, ip0, o, p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01088}01088   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01089}01089 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01090}01090   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01091}01091   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01092}01092   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01093}01093 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01094}01094   pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01095}01095   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0] = no[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01096}01096   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1] = no[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01097}01097   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2] = no[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01098}01098 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01099}01099   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = to[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01100}01100   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = to[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01101}01101   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = to[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01102}01102 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01103}01103   \textcolor{keywordflow}{if} ( isrid ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01104}01104     \textcolor{comment}{/* Copy the second normal for ridge point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01105}01105     pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0] = no2[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01106}01106     pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1] = no2[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01107}01107     pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2] = no2[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01108}01108   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01109}01109 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01110}01110   \textcolor{keywordflow}{for}( l=0 ; l<ilistv ; l++ )\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01111}01111     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[l]/4])-\/>qual = callist[l];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01112}01112     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[l]/4])-\/>mark = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01113}01113   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01114}01114   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01115}01115 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01116}01116 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01142}\mbox{\hyperlink{libmmg3d__private_8h_a3e53957a49af58138779bd221c69d8cc}{01142}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_aa1c6d834438176619968d03e58587fc1}{MMG3D\_movbdycurvept\_newPosForSimu}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} p0,MMG5\_int ip0,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01143}01143                                       MMG5\_int ip1,MMG5\_int ip2,\textcolor{keywordtype}{double} ll1old,\textcolor{keywordtype}{double} ll2old,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01144}01144                                       uint8\_t isrid,\textcolor{keyword}{const} \textcolor{keywordtype}{double} step,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01145}01145                                       \textcolor{keywordtype}{double} o[3],\textcolor{keywordtype}{double} no[3],}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01146}01146                                       \textcolor{keywordtype}{double} no2[3],\textcolor{keywordtype}{double} to[3],}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01147}01147                                       \textcolor{keyword}{const} int16\_t edgTag) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01148}01148 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01149}01149   MMG5\_int ip;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01150}01150 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01152}01152   \textcolor{keywordflow}{if} ( ll1old < ll2old ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01153}01153     \textcolor{comment}{/* move towards p2 */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01154}01154     ip = ip2;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01155}01155   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01156}01156   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ll1old > ll2old ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01157}01157     \textcolor{comment}{/* move towards p1 */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01158}01158     ip = ip1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01159}01159   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01160}01160   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01161}01161     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01162}01162   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01163}01163 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01165}01165   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} \& edgTag ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01166}01166     \textcolor{keywordflow}{if} ( !(\mbox{\hyperlink{libmmg3d__private_8h_aebd31d9b892621d3bb99ec1985ab9587}{MMG5\_BezierNom}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip0,ip,step,o,no,to)) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01167}01167       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01168}01168     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01169}01169   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01170}01170   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} \& edgTag ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01171}01171     \textcolor{comment}{// Remark: Singular points are required so following assertion should be}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01172}01172     \textcolor{comment}{// verified in the entire function. Keep the test here to make easier}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01173}01173     \textcolor{comment}{// debugging/understanding when passing here.}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01174}01174     assert ( (!\mbox{\hyperlink{mmgcommon__private_8h_a7d17f22a784b2da53dad4d1fa7785ce0}{MG\_SIN}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0].\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}})) \&\&}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01175}01175              \textcolor{stringliteral}{"{}BezierRidge don't work if both ip0 and ip are singular"{}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01176}01176     \textcolor{keywordflow}{if} ( !(\mbox{\hyperlink{libmmg3d__private_8h_a8fe9d2dcc977a80f7c388ac41be42143}{MMG5\_BezierRidge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip0,ip,step,o,no,no2,to)) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01177}01177       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01178}01178     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01179}01179   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01180}01180   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} \& edgTag ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01181}01181     \textcolor{keywordflow}{if} ( !(\mbox{\hyperlink{libmmg3d__private_8h_abd3a46376841955c1f72a5d19de63f75}{MMG5\_BezierRef}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip0,ip,step,o,no,to)) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01182}01182       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01183}01183     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01184}01184   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01185}01185   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01186}01186     assert ( 0 \&\& \textcolor{stringliteral}{"{}Unexpected edge tag in this function"{}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01187}01187     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01188}01188   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01189}01189 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01191}01191   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} ppt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01192}01192   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01193}01193   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01194}01194   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01195}01195   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}  = p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01196}01196   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}}  = p0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01197}01197 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01198}01198 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01199}01199   MMG5\_int nxp = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}} + 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01200}01200   \textcolor{keywordflow}{if} ( nxp > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01201}01201     \mbox{\hyperlink{mmgcommon__private_8h_a7c5021138095892cf2699f36a7c526ae}{MMG5\_TAB\_RECALLOC}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}},\mbox{\hyperlink{mmgcommon__private_8h_a50b381cd31a4a90064ce1d936a7c037d}{MMG5\_GAP}},\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}},}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01202}01202                        \textcolor{stringliteral}{"{}larger xpoint table"{}},}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01203}01203                        \textcolor{keywordflow}{return} 0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01204}01204   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01205}01205   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} = nxp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01206}01206   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}} pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[nxp];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01207}01207   memcpy(pxp,\&(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}]),\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01208}01208 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01209}01209   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = to[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01210}01210   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = to[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01211}01211   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = to[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01212}01212 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01213}01213   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0] = no[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01214}01214   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1] = no[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01215}01215   pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2] = no[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01216}01216 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01217}01217   \textcolor{keywordflow}{if} ( isrid ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01218}01218     \textcolor{comment}{/* Copy the second normal for ridge point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01219}01219     pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0] = no2[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01220}01220     pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1] = no2[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01221}01221     pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2] = no2[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01222}01222   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01223}01223 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01224}01224   \textcolor{keywordflow}{return} ip;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01225}01225 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01226}01226 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01227}01227 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01254}01254 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01255}\mbox{\hyperlink{movpt__3d_8c_a8bd9de0189d8e0652c3c7e47daa8d50c}{01255}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a8bd9de0189d8e0652c3c7e47daa8d50c}{MMG3D\_movbdycurvept\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01256}01256                            \textcolor{keywordtype}{int} ilistv, MMG5\_int *lists, \textcolor{keywordtype}{int} ilists,\textcolor{keywordtype}{int} improve,\textcolor{keyword}{const} int16\_t edgTag)\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01257}01257   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}           pt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01258}01258   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}          pxt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01259}01259   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}           p0,p1,p2;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01260}01260   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}             tt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01261}01261   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}             par;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01262}01262   \textcolor{keywordtype}{double}                ll1old,ll2old,o[3],no[3],no2[3],to[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01263}01263   \textcolor{keywordtype}{double}                calold,calnew,caltmp,hmax,hausd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01264}01264   MMG5\_int              iel,ip0,ip1,ip2,ip;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01265}01265   \textcolor{keywordtype}{int}                   l;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01266}01266   \textcolor{keywordtype}{int}                   isloc,j;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01267}01267   uint8\_t               i,iface,isrid;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01268}01268 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01269}01269   ip1 = ip2 = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01270}01270   pt        = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[0]/4];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01271}01271   ip0       = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[listv[0]\%4];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01272}01272   p0        = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01273}01273 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01276}01276   isrid     = ((\mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} \& edgTag) \&\& !(\mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} \& edgTag));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01277}01277 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01278}01278   assert ( edgTag \& p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01279}01279 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01282}01282   \textcolor{keywordtype}{int} \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{movpt__3d_8c_a8b37ca79da8a3ff7493f6e5cf5134720}{MMG3D\_curveEndingPts}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},lists,ilists,edgTag,ip0,\&ip1,\&ip2);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01283}01283   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01284}01284     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01285}01285   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01286}01286 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01293}01293   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01294}01294   p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01295}01295 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01296}01296   ll1old = (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0])* (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]) \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01297}01297     + (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])* (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])      \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01298}01298     + (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2])* (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01299}01299   ll2old = (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0])* (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]) \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01300}01300     + (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])* (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])      \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01301}01301     + (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2])* (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01302}01302 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01305}01305   ip = \mbox{\hyperlink{movpt__3d_8c_aa1c6d834438176619968d03e58587fc1}{MMG3D\_movbdycurvept\_newPosForSimu}}( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,ip0,ip1,ip2,ll1old,ll2old,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01306}01306                                           isrid,\mbox{\hyperlink{libmmg3d__private_8h_a34c9fadc9754f30489350efebbd1ef6f}{MMG3D\_MOVSTEP}},o,no,no2,to,edgTag );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01307}01307   \textcolor{keywordflow}{if} ( !ip ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01308}01308     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01309}01309   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01310}01310 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01320}01320   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01321}01321   \textcolor{keywordflow}{for}( l=0 ; l<ilists ; l++ )\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01322}01322     iel         = lists[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01323}01323     iface       = lists[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01324}01324 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01325}01325     assert( 0<=iface \&\& iface<4 \&\& \textcolor{stringliteral}{"{}unexpected local face idx"{}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01326}01326     \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iface,\&tt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01327}01327     caltmp = MMG5\_caltri(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\&tt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01328}01328     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold,caltmp);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01329}01329 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01330}01330     \textcolor{keywordflow}{for}( i=0 ; i<3 ; i++ ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01331}01331       \textcolor{keywordflow}{if} ( tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] == ip0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01332}01332         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01333}01333       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01334}01334     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01335}01335     assert(i<3);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01336}01336     \textcolor{keywordflow}{if} ( i==3 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01337}01337       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01338}01338     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01339}01339 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01340}01340     tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01341}01341 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01342}01342     caltmp = MMG5\_caltri(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\&tt);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01343}01343     \textcolor{keywordflow}{if} ( caltmp < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01344}01344       \textcolor{comment}{/* We don't check the input triangle qualities, thus we may have a very}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01345}01345 \textcolor{comment}{       * bad triangle in our mesh */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01346}01346       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01347}01347     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01348}01348     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,caltmp);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01349}01349 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01350}01350     \textcolor{comment}{/* Local parameters for tt and iel */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01351}01351     pt          = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01352}01352     pxt         = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01353}01353 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01354}01354     hmax  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01355}01355     hausd = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01356}01356 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01357}01357     isloc = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01358}01358     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01359}01359       \textcolor{keywordflow}{for} ( j=0; j<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++j ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01360}01360         par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[j];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01361}01361 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01362}01362         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01363}01363         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} != pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01364}01364 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01365}01365         hmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01366}01366         hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01367}01367         isloc = 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01368}01368         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01369}01369       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01370}01370     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01371}01371     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a04ba7031a8b9120d7be9df517c9fd509}{MG\_Tria}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01372}01372       \textcolor{keywordflow}{if} ( isloc ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01373}01373         \textcolor{keywordflow}{for} ( j=0; j<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++j ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01374}01374           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[j];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01375}01375 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01376}01376           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01377}01377           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} != tt.\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01378}01378 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01379}01379           hmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01380}01380           hausd = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01381}01381           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01382}01382         \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01383}01383       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01384}01384       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01385}01385         \textcolor{keywordflow}{for} ( j=0; j<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++j ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01386}01386           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[j];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01387}01387 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01388}01388           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01389}01389           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} != tt.\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01390}01390 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01391}01391           hmax  = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01392}01392           hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01393}01393           isloc = 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01394}01394           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01395}01395         \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01396}01396       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01397}01397     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01398}01398 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01399}01399     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmg3d__private_8h_a9c5aca6efdc9aa85e8022f9cd7c02f8f}{MMG5\_chkedg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&tt,\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},iface),hmax,hausd,isloc) > 0 ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01400}01400       memset(\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0].\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}],0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01401}01401       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01402}01402     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01403}01403   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01404}01404   \textcolor{keywordflow}{if} ( calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01405}01405     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01406}01406   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01407}01407   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < calold ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01408}01408     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01409}01409   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01410}01410   memset(\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0].\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}],0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01411}01411 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01415}01415   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} =  \mbox{\hyperlink{movpt__3d_8c_a26154d621ea7edccaa0ced7dd56458fc}{MMG3D\_movbdycurvept\_chckAndUpdate}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,PROctree,listv,ilistv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01416}01416                                            improve,p0,ip0,isrid,o,no,no2,to);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01417}01417 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01418}01418   \textcolor{keywordflow}{return} \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01419}01419 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01420}01420 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01438}\mbox{\hyperlink{libmmg3d__private_8h_a9faf16e36f71bf594c51a2cd43a1e60f}{01438}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_af446301fbb0d95325edd7fdcba94d039}{MMG5\_movbdyrefpt\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01439}01439                          \textcolor{keywordtype}{int} ilistv, MMG5\_int *lists, \textcolor{keywordtype}{int} ilists,\textcolor{keywordtype}{int} improve)\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01440}01440 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01441}01441   \textcolor{keywordflow}{return} \mbox{\hyperlink{movpt__3d_8c_a8bd9de0189d8e0652c3c7e47daa8d50c}{MMG3D\_movbdycurvept\_iso}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,PROctree,listv,ilistv,lists,ilists,improve,\mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01442}01442 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01443}01443 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01462}\mbox{\hyperlink{libmmg3d__private_8h_af3f274e7b9d9d425a2dbcab07122fa04}{01462}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_afc2937fa7e15baadda4b6dba7b5ef489}{MMG5\_movbdynompt\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01463}01463                          \textcolor{keywordtype}{int} ilistv, MMG5\_int *lists, \textcolor{keywordtype}{int} ilists,\textcolor{keywordtype}{int} improve)\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01464}01464 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01465}01465   \textcolor{keywordflow}{return} \mbox{\hyperlink{movpt__3d_8c_a8bd9de0189d8e0652c3c7e47daa8d50c}{MMG3D\_movbdycurvept\_iso}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,PROctree,listv,ilistv,lists,ilists,improve,\mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01466}01466 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01467}01467 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01482}\mbox{\hyperlink{libmmg3d__private_8h_acff97c04f27bef556e32feff2bc0d259}{01482}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a091c0243a5bb58aba32355cfe1cf63ce}{MMG5\_movbdynomintpt\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01483}01483                          \textcolor{keywordtype}{int} ilistv, \textcolor{keywordtype}{int} improve)\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01484}01484   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}       pt,pt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01485}01485   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}      pxt;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01486}01486   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}       p0,p1,p2,ppt0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01487}01487   \textcolor{keywordtype}{double}            step,ll1old,ll2old,calold,calnew,callist[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01488}01488   \textcolor{keywordtype}{double}            o[3],no[3],to[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01489}01489   \textcolor{keywordtype}{int}               l;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01490}01490   MMG5\_int          ip0,ip1,ip2,ip,iel,ipa;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01491}01491   int8\_t            i,i0,ie;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01492}01492 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01493}01493   step = 0.1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01494}01494   ip1 = ip2 = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01495}01495   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[0]/4];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01496}01496   ip0 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[listv[0]\%4];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01497}01497   p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01498}01498 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01499}01499   assert ( (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}) \&\& p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} \&\& \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4ad0f4483e925517c599f01fc70b98d3}{nnor}} );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01500}01500 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01501}01501   \textcolor{comment}{/* Recover the two ending points of the underlying non manifold curve */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01502}01502   \textcolor{keywordflow}{for} (l=0; l<ilistv; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01503}01503     iel = listv[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01504}01504     i0 = listv[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01505}01505     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01506}01506     \textcolor{keywordflow}{if} ( !pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01507}01507     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01508}01508 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01509}01509     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01510}01510       ie = \mbox{\hyperlink{libmmg3d__private_8h_a7ddbab47251941c87d000fa497856107}{MMG5\_arpt}}[i0][i];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01511}01511       \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ie] \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01512}01512         ipa = ( ip0 == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ie][0]] ) ? pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ie][1]] : pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ie][0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01513}01513         \mbox{\hyperlink{API__functionsf__2d_8c_a8fa1e72d65c006f7a41f14c6fd681a9d}{if}} ( !ip1 ) ip1 = ipa;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01514}01514         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !ip2 \&\& ipa != ip1 ) ip2 = ipa;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01515}01515       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01516}01516     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01517}01517   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01518}01518   \textcolor{keywordflow}{if} ( !(ip1 \&\& ip2 \&\& (ip1 != ip2)) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01519}01519 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01520}01520   \textcolor{comment}{/* At this point, we get the point extremities ip1, ip2 of the non manifold curve passing through ip0 */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01521}01521   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01522}01522   p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01523}01523 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01524}01524   ll1old = (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0])* (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]) \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01525}01525   + (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])* (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])      \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01526}01526   + (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2])* (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01527}01527   ll2old = (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0])* (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]) \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01528}01528   + (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])* (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1])      \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01529}01529   + (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2])* (p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01530}01530 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01531}01531   \textcolor{keywordflow}{if} ( ll1old < ll2old ) \{ \textcolor{comment}{//move towards p2}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01532}01532     ip = ip2;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01533}01533   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01534}01534   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01535}01535     ip = ip1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01536}01536   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01537}01537 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01538}01538   \textcolor{comment}{/* Compute support of the associated edge, and features of the new position */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01539}01539   \textcolor{keywordflow}{if} ( !(\mbox{\hyperlink{libmmg3d__private_8h_aebd31d9b892621d3bb99ec1985ab9587}{MMG5\_BezierNom}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip0,ip,step,o,no,to)) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01540}01540 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01541}01541   \textcolor{comment}{/* Test : check whether all volumes remain positive with new position of the point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01542}01542   ppt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01543}01543   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01544}01544   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01545}01545   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01546}01546   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}  = p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01547}01547   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}}  = p0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01548}01548 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01549}01549   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01550}01550   \textcolor{keywordflow}{for}( l=0 ; l<ilistv ; l++ )\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01551}01551     iel = listv[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01552}01552     i0  = listv[l] \% 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01553}01553     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01554}01554     pt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01555}01555     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01556}01556     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0] = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01557}01557     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01558}01558     callist[l]= \mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01559}01559     \textcolor{keywordflow}{if} (callist[l] < \mbox{\hyperlink{mmgcommon__private_8h_a80cb4724e6dc20a024e2b27dd47508da}{MMG5\_NULKAL}}) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01560}01560       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01561}01561     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01562}01562     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,callist[l]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01563}01563   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01564}01564   \textcolor{keywordflow}{if} ((calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold) ||}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01565}01565       (calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}}) || (calnew <= 0.3*calold)) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01566}01566     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01567}01567   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (improve \&\& calnew < calold) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01568}01568     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01569}01569   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01570}01570 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01571}01571   \textcolor{comment}{/* Update coordinates and tangent for new point */}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01572}01572   \textcolor{keywordflow}{if} ( PROctree )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01573}01573     \mbox{\hyperlink{PRoctree__3d_8c_a1d27caf707f3cd24b7f9f6dc01587713}{MMG3D\_movePROctree}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, PROctree, ip0, o, p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01574}01574 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01575}01575   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01576}01576   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01577}01577   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01578}01578 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01579}01579   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = to[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01580}01580   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = to[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01581}01581   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = to[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01582}01582 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01583}01583   \textcolor{keywordflow}{for}(l=0; l<ilistv; l++)\{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01584}01584     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[l]/4])-\/>qual = callist[l];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01585}01585     (\&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[l]/4])-\/>mark = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01586}01586   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01587}01587 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01588}01588   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01589}01589 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01590}01590 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01606}\mbox{\hyperlink{libmmg3d__private_8h_ad916e93a2ac9e96f2fd33217b2648f49}{01606}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a1832a4fd5c47c28c8e61b31b2dfbc536}{MMG5\_movbdyridpt\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, \mbox{\hyperlink{structMMG3D__PROctree}{MMG3D\_pPROctree}} PROctree, int64\_t *listv,}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01607}01607                           \textcolor{keywordtype}{int} ilistv,MMG5\_int *lists,\textcolor{keywordtype}{int} ilists,\textcolor{keywordtype}{int} improve) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01608}01608 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01609}01609   \textcolor{keywordflow}{return} \mbox{\hyperlink{movpt__3d_8c_a8bd9de0189d8e0652c3c7e47daa8d50c}{MMG3D\_movbdycurvept\_iso}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,PROctree,listv,ilistv,lists,ilists,improve,\mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01610}01610 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01611}01611 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01626}\mbox{\hyperlink{libmmg3d__private_8h_a1492f278094aa9d76bb9745b23f5b190}{01626}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a4e5c7a512f8556dab505f4e5d299f06e}{MMG3D\_movv\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}},MMG5\_int k,\textcolor{keywordtype}{int} ib) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01627}01627   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt,pt1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01628}01628   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppa,ppb,p1,p2,p3;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01629}01629   \textcolor{keywordtype}{int}           j,iter,maxiter,l,lon;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01630}01630   int64\_t       list[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01631}01631   MMG5\_int      ipb,iadr,i1,i2,i3,iel;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01632}01632   \textcolor{keywordtype}{double}        *mp,coe,qualtet[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01633}01633   \textcolor{keywordtype}{double}        ax,ay,az,bx,by,bz,nx,ny,nz,dd,len,qual,oldc[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01634}01634 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01635}01635   assert(k);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01636}01636   assert(ib<4);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01637}01637   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01638}01638   ppa  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ib]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01639}01639 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01640}01640   \textcolor{keywordflow}{if} ( (ppa-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) || (ppa-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01641}01641     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01642}01642   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01643}01643 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01644}01644   iadr = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ib]*\mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}}-\/>size + 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01645}01645   mp   = \&\mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}}-\/>m[iadr];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01646}01646 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01647}01647   \textcolor{comment}{/*compute normal*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01648}01648   i1 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01649}01649   i2 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01650}01650   i3 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][2]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01651}01651   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01652}01652   p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01653}01653   p3 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01654}01654 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01655}01655   ax = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01656}01656   ay = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01657}01657   az = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01658}01658 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01659}01659   bx = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01660}01660   by = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01661}01661   bz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01662}01662 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01663}01663   nx = (ay*bz -\/ az*by);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01664}01664   ny = (az*bx -\/ ax*bz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01665}01665   nz = (ax*by -\/ ay*bx);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01666}01666 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01667}01667   dd = sqrt(nx*nx+ny*ny+nz*nz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01668}01668   dd = 1./dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01669}01669   nx *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01670}01670   ny *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01671}01671   nz *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01672}01672   len = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01673}01673   \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01674}01674     ipb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][j] ];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01675}01675     ppb = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ipb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01676}01676 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01677}01677     ax  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01678}01678     ay  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01679}01679     az  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01680}01680 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01681}01681     dd =       mp[0]*ax*ax + mp[3]*ay*ay + mp[5]*az*az \(\backslash\)}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01682}01682       + 2.0*(mp[1]*ax*ay + mp[2]*ax*az + mp[4]*ay*az);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01683}01683     assert(dd>0);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01684}01684     len += sqrt(dd);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01685}01685   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01686}01686 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01687}01687   dd  = 1.0 / (double)3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01688}01688   len = 1.0 / len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01689}01689   len *= dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01690}01690   memcpy(oldc,ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01691}01691 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01692}01692   lon = \mbox{\hyperlink{boulep__3d_8c_a3413ba7be6f4ae2955ce4072471daf00}{MMG5\_boulevolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,ib,\&list[0]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01693}01693 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01694}01694   coe     = 1.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01695}01695   iter    = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01696}01696   maxiter = 20;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01697}01697   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01698}01698     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = oldc[0] + coe * nx * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01699}01699     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = oldc[1] + coe * ny * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01700}01700     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = oldc[2] + coe * nz * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01701}01701 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01702}01702     \textcolor{keywordflow}{for} (l=0; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01703}01703       iel = list[l] / 4 ;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01704}01704       pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01705}01705 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01706}01706       qual = MMG5\_caltet(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}},pt1);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01707}01707       \textcolor{comment}{/*warning if we increase the coefficient (ex 1.4), the mesh quality becomes poor very quickly*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01708}01708       \textcolor{keywordflow}{if} ( qual*1.01 <= pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}}) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01709}01709       qualtet[l] = qual;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01710}01710 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01711}01711     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01712}01712     \textcolor{keywordflow}{if} ( l >= lon )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01713}01713     coe *= 0.5;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01714}01714   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01715}01715   \textcolor{keywordflow}{while} ( ++iter <= maxiter );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01716}01716   \textcolor{keywordflow}{if} ( iter > maxiter) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01717}01717     memcpy(ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},oldc,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01718}01718     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01719}01719   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01720}01720 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01721}01721   \textcolor{keywordflow}{for} (l=0; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01722}01722     iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01723}01723     pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01724}01724     pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}} = qualtet[l];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01725}01725     pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01726}01726   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01727}01727   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01728}01728 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01729}01729 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01730}01730 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01746}\mbox{\hyperlink{libmmg3d__private_8h_a54be68a55925cf00d2c61553b9b26bae}{01746}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_a1bb3470119319330106e3bd6f7275f1e}{MMG3D\_movnormal\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}},MMG5\_int k,\textcolor{keywordtype}{int} ib) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01747}01747   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt,pt1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01748}01748   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} ppa,ppb,p1,p2,p3;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01749}01749   \textcolor{keywordtype}{int}         j,iter,maxiter,l,lon;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01750}01750   int64\_t     list[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01751}01751   MMG5\_int    ipb,iel,i1,i2,i3;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01752}01752   \textcolor{keywordtype}{double}      coe,crit,qualtet[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01753}01753   \textcolor{keywordtype}{double}      ax,ay,az,bx,by,bz,nx,ny,nz,dd,len,qual,oldc[3],oldp[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01754}01754 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01755}01755   assert(k);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01756}01756   assert(ib<4);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01757}01757   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01758}01758 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01759}01759   ppa  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ib]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01760}01760 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01761}01761   \textcolor{keywordflow}{if} ( ppa-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} || (ppa-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01762}01762     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01763}01763   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01764}01764 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01765}01765   \textcolor{comment}{/*compute normal*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01766}01766   i1 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01767}01767   i2 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01768}01768   i3 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][2]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01769}01769   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01770}01770   p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01771}01771   p3 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01772}01772 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01773}01773   ax = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01774}01774   ay = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01775}01775   az = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01776}01776 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01777}01777   bx = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01778}01778   by = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01779}01779   bz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01780}01780 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01781}01781   nx = (ay*bz -\/ az*by);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01782}01782   ny = (az*bx -\/ ax*bz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01783}01783   nz = (ax*by -\/ ay*bx);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01784}01784 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01785}01785   dd = sqrt(nx*nx+ny*ny+nz*nz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01786}01786   dd = 1./dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01787}01787   nx *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01788}01788   ny *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01789}01789   nz *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01790}01790   len = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01791}01791   \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01792}01792     ipb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][j] ];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01793}01793     ppb = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ipb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01794}01794 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01795}01795     ax  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01796}01796     ay  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01797}01797     az  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01798}01798 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01799}01799     dd    =   sqrt(ax*ax +ay*ay +az*az);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01800}01800     len  +=   dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01801}01801   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01802}01802 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01803}01803   dd  = 1.0 / (double)3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01804}01804   len *= dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01805}01805 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01806}01806 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01807}01807   memcpy(oldp,ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01808}01808   oldc[0] = 1./3.*(p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]+p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]+p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01809}01809   oldc[1] = 1./3.*(p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]+p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]+p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01810}01810   oldc[2] = 1./3.*(p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]+p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]+p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01811}01811 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01812}01812   lon = \mbox{\hyperlink{boulep__3d_8c_a3413ba7be6f4ae2955ce4072471daf00}{MMG5\_boulevolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,ib,\&list[0]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01813}01813 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01814}01814   \textcolor{keywordflow}{if} ( !lon ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01815}01815 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01816}01816   \textcolor{comment}{/*vol crit*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01817}01817   crit = \mbox{\hyperlink{mmgcommon__private_8h_ac2c72474b86ce1a63e0056659340ffa8}{MMG5\_orvol}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}},pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}});}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01818}01818   \textcolor{keywordflow}{for} (l=1; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01819}01819     iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01820}01820     pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01821}01821     \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}} < crit)  crit = pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01822}01822   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01823}01823   coe     = 0.471404;\textcolor{comment}{//2.12132; //3/sqrt(2) : hauteur d'un tetra reg de cote c : c*sqrt(2)/3}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01824}01824   iter    = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01825}01825   maxiter = 10;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01826}01826   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01827}01827     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = oldc[0] + coe * nx * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01828}01828     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = oldc[1] + coe * ny * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01829}01829     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = oldc[2] + coe * nz * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01830}01830     \textcolor{keywordflow}{for} (l=0; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01831}01831       iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01832}01832       pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01833}01833       qual = MMG5\_caltet(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}},pt1);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01834}01834       \textcolor{keywordflow}{if} ( qual < crit ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01835}01835         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01836}01836       \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01837}01837       qualtet[l] = qual;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01838}01838 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01839}01839     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01840}01840     \textcolor{keywordflow}{if} ( l >= lon )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01841}01841     coe *= 0.5;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01842}01842   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01843}01843   \textcolor{keywordflow}{while} ( ++iter <= maxiter );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01844}01844   \textcolor{keywordflow}{if} ( iter > maxiter) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01845}01845     memcpy(ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},oldp,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01846}01846     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01847}01847   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01848}01848 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01849}01849   \textcolor{keywordflow}{for} (l=0; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01850}01850     iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01851}01851     pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01852}01852     pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}} = qualtet[l];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01853}01853     pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01854}01854   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01855}01855   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01856}01856 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01857}01857 \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01858}01858 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01875}\mbox{\hyperlink{libmmg3d__private_8h_a5264b29090839e0129dec9a8e8db4f84}{01875}} \textcolor{keywordtype}{int} \mbox{\hyperlink{movpt__3d_8c_aadb5d7c16c2ca86cc5cc950a76ab24c6}{MMG3D\_movv\_iso}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}},MMG5\_int k,\textcolor{keywordtype}{int} ib) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01876}01876   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt,pt1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01877}01877   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} ppa,ppb,p1,p2,p3;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01878}01878   \textcolor{keywordtype}{int}         j,iter,maxiter,l,lon;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01879}01879   int64\_t     list[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01880}01880   MMG5\_int    ipb,iadr,iel,i1,i2,i3;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01881}01881   \textcolor{keywordtype}{double}      hp,coe,crit,qualtet[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01882}01882   \textcolor{keywordtype}{double}      ax,ay,az,bx,by,bz,nx,ny,nz,dd,len,qual,oldc[3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01883}01883 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01884}01884   assert(k);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01885}01885   assert(ib<4);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01886}01886   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01887}01887 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01888}01888   ppa  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ib]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01889}01889   \textcolor{keywordflow}{if} ( (ppa-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) || (ppa-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) ) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01890}01890     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01891}01891   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01892}01892 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01893}01893   iadr = (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ib])*\mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}}-\/>size;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01894}01894   hp   = \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}}-\/>m[iadr];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01895}01895 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01896}01896   \textcolor{comment}{/*compute normal*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01897}01897   i1 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][0]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01898}01898   i2 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][1]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01899}01899   i3 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][2]];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01900}01900   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01901}01901   p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01902}01902   p3 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[i3];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01903}01903 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01904}01904   ax = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01905}01905   ay = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01906}01906   az = p3-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01907}01907 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01908}01908   bx = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01909}01909   by = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01910}01910   bz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01911}01911 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01912}01912   nx = (ay*bz -\/ az*by);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01913}01913   ny = (az*bx -\/ ax*bz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01914}01914   nz = (ax*by -\/ ay*bx);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01915}01915 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01916}01916   dd = sqrt(nx*nx+ny*ny+nz*nz);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01917}01917   dd = 1./dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01918}01918   nx *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01919}01919   ny *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01920}01920   nz *=dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01921}01921   len = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01922}01922   \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01923}01923     ipb = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ib][j] ];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01924}01924     ppb = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ipb];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01925}01925 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01926}01926     ax  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01927}01927     ay  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01928}01928     az  = ppb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01929}01929 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01930}01930     dd    =   sqrt(ax*ax +ay*ay +az*az);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01931}01931     len  +=   dd/hp;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01932}01932   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01933}01933 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01934}01934   dd  = 1.0 / (double)3.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01935}01935   len *= dd;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01936}01936   \textcolor{keywordflow}{if}(len > 0.) len = 1.0 / len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01937}01937 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01938}01938   memcpy(oldc,ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01939}01939 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01940}01940   lon = \mbox{\hyperlink{boulep__3d_8c_a3413ba7be6f4ae2955ce4072471daf00}{MMG5\_boulevolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,ib,\&list[0]);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01941}01941 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01942}01942   \textcolor{keywordflow}{if}(!lon) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01943}01943 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01944}01944   \textcolor{comment}{/*qual crit*/}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01945}01945   crit = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01946}01946   \textcolor{keywordflow}{for} (l=1; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01947}01947     iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01948}01948     pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01949}01949     \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}} < crit )}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01950}01950       crit = pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01951}01951   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01952}01952 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01953}01953   crit *= 1.01;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01954}01954   coe     = 1.;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01955}01955   iter    = 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01956}01956   maxiter = 20;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01957}01957   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01958}01958 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01959}01959     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = oldc[0] + coe * nx * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01960}01960     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = oldc[1] + coe * ny * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01961}01961     ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = oldc[2] + coe * nz * len;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01962}01962     \textcolor{keywordflow}{for} (l=0; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01963}01963       iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01964}01964       pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01965}01965       qual = MMG5\_caltet(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}},pt1);}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01966}01966       \textcolor{keywordflow}{if} ( qual < crit )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01967}01967       qualtet[l] = qual;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01968}01968 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01969}01969     \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01970}01970     \textcolor{keywordflow}{if} ( l >= lon )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01971}01971     coe *= 0.5;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01972}01972   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01973}01973   \textcolor{keywordflow}{while} ( ++iter <= maxiter );}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01974}01974   \textcolor{keywordflow}{if} ( iter > maxiter) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01975}01975     memcpy(ppa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},oldc,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01976}01976     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01977}01977   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01978}01978 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01979}01979   \textcolor{keywordflow}{for} (l=0; l<lon; l++) \{}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01980}01980     iel = list[l] / 4;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01981}01981     pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01982}01982     pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}} = qualtet[l];}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01983}01983     pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01984}01984   \}}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01985}01985   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01986}01986 }
\DoxyCodeLine{\Hypertarget{movpt__3d_8c_source_l01987}01987 \}}

\end{DoxyCode}
