\hypertarget{mmg3_8c_source}{}\doxysection{mmg3.\+c}
\label{mmg3_8c_source}\index{src/common/mmg3.c@{src/common/mmg3.c}}
\mbox{\hyperlink{mmg3_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00034}00034 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgcommon__private_8h}{mmgcommon\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00049}\mbox{\hyperlink{mmg3_8c_a64f84d4e08e5b9fcac2b0e38fca8be54}{00049}} \textcolor{keywordtype}{short} \mbox{\hyperlink{mmg3_8c_a64f84d4e08e5b9fcac2b0e38fca8be54}{MMG5\_dikmov}} ( \mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} disp,\textcolor{keywordtype}{short} *lastt,\textcolor{keywordtype}{short} shortmax,}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00050}00050                     MMG5\_int chkmovmesh(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}},\textcolor{keywordtype}{short},MMG5\_int*) ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00051}00051   \textcolor{keywordtype}{int}     it,maxit;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00052}00052   \textcolor{keywordtype}{short}   t,tmin,tmax;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00053}00053   int8\_t  \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00055}00055   maxit = 200;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00056}00056   it = 0;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00058}00058   tmin = 0;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00059}00059   tmax = shortmax;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00061}00061   *lastt = 0;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00063}00063   \textcolor{comment}{/* If full displacement can be achieved */}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00064}00064   \textcolor{keywordflow}{if} ( !chkmovmesh(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},disp,tmax,NULL) )}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00065}00065     \textcolor{keywordflow}{return} tmax;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00067}00067   \textcolor{comment}{/* Else, find the largest displacement by dichotomy */}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00068}00068   \textcolor{keywordflow}{while}( tmin != tmax \&\& it < maxit ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00069}00069     t = (tmin+tmax)/2;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00071}00071     \textcolor{comment}{/* Case that tmax = tmin +1 : check move with tmax */}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00072}00072     \textcolor{keywordflow}{if} ( t == tmin ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00073}00073       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = chkmovmesh(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},disp,tmax,NULL);}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00074}00074       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00075}00075         \textcolor{keywordflow}{return} tmax;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00076}00076       \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00077}00077       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00078}00078         \textcolor{keywordflow}{if} ( tmin==0 ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00079}00079           *lastt = tmax;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00080}00080         \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00081}00081         \textcolor{keywordflow}{return} tmin;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00082}00082       \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00083}00083     \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00085}00085     \textcolor{comment}{/* General case: check move with t */}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00086}00086     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = chkmovmesh(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},disp,t,NULL);}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00087}00087     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00088}00088       tmin = t;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00089}00089     \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00090}00090     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00091}00091       tmax = t;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00092}00092 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00093}00093     it++;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00094}00094   \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00096}00096   \textcolor{keywordflow}{if} ( tmin==0 ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00097}00097     *lastt=t;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00098}00098   \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00100}00100   \textcolor{keywordflow}{return} tmin;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00101}00101 \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00112}\mbox{\hyperlink{mmg3_8c_a54db5271cac8478505188b7088a24e71}{00112}} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmg3_8c_a54db5271cac8478505188b7088a24e71}{MMG5\_saveDisp}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} disp) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00113}00113   FILE        *out;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00114}00114   MMG5\_int    k;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00115}00115   \textcolor{keywordtype}{char}        data[256],*ptr;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00116}00116 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00117}00117   strcpy(data,disp-\/>\mbox{\hyperlink{structMMG5__Sol_a6bdd57c014e0875fa3789cac17d46dc4}{namein}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00118}00118   ptr = strstr(data,\textcolor{stringliteral}{"{}.sol"{}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00119}00119   *ptr = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00120}00120   strcat(data,\textcolor{stringliteral}{"{}.o.disp.sol"{}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00122}00122   out = fopen(data,\textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00124}00124   fprintf(out,\textcolor{stringliteral}{"{}MeshVersionFormatted 1\(\backslash\)n\(\backslash\)nDimension\(\backslash\)n\%d\(\backslash\)n\(\backslash\)n"{}},disp-\/>\mbox{\hyperlink{structMMG5__Sol_ae3b5dbc309de3697e1cc9f2e4a6a7b61}{dim}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00125}00125   fprintf(out,\textcolor{stringliteral}{"{}SolAtVertices\(\backslash\)n\%"{}}MMG5\_PRId\textcolor{stringliteral}{"{}\(\backslash\)n 1 2\(\backslash\)n"{}},disp-\/>\mbox{\hyperlink{structMMG5__Sol_aec9805cc13914dc2b870c07753adb31d}{np}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00127}00127   \textcolor{comment}{/* Print solutions */}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00128}00128   \textcolor{keywordflow}{for}(k=1; k<= disp-\/>\mbox{\hyperlink{structMMG5__Sol_aec9805cc13914dc2b870c07753adb31d}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00129}00129     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00130}00130     \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac70707181547b168ced906589500bde4}{dim}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00131}00131       fprintf(out,\textcolor{stringliteral}{"{} \%f"{}},disp-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac70707181547b168ced906589500bde4}{dim}}*k+i]);}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00132}00132     \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00133}00133     fprintf(out,\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00134}00134   \}}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00136}00136   fprintf(out,\textcolor{stringliteral}{"{}\(\backslash\)nEnd"{}});}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00137}00137   fclose(out);}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00139}00139   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmg3_8c_source_l00140}00140 \}}

\end{DoxyCode}
