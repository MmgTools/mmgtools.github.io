\hypertarget{mmgs1_8c_source}{}\doxysection{mmgs1.\+c}
\label{mmgs1_8c_source}\index{src/mmgs/mmgs1.c@{src/mmgs/mmgs1.c}}
\mbox{\hyperlink{mmgs1_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00035}00035 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmgs__private_8h}{libmmgs\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgsexterns__private_8h}{mmgsexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgexterns__private_8h}{mmgexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{inlined__functions__private_8h}{inlined\_functions\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00040}00040 \textcolor{keyword}{extern} int8\_t \mbox{\hyperlink{mmgs1_8c_ab5450ef31db0c3c4df4c9f370b3a791a}{ddb}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00052}\mbox{\hyperlink{mmgs1_8c_a6501536d697952d6a069675e0cb5ba76}{00052}} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a6501536d697952d6a069675e0cb5ba76}{MMGS\_dichoto}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int k,MMG5\_int *vx) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00053}00053   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}   pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00054}00054   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}  pa,pb,ps;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00055}00055   \textcolor{keywordtype}{double}       o[3][3],p[3][3];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00056}00056   \textcolor{keywordtype}{float}        to,tp,t;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00057}00057   MMG5\_int     ia,ib;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00058}00058   \textcolor{keywordtype}{int}          i1,i2,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}},it,maxit;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00059}00059   int8\_t       i,j;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00061}00061   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00062}00062   \textcolor{comment}{/* get point on surface and along segment for edge split */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00063}00063   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00064}00064     memset(p[i],0,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00065}00065     memset(o[i],0,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00066}00066     \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00067}00067       i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00068}00068       i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00069}00069       ia = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00070}00070       ib = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00071}00071       pa = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ia];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00072}00072       pb = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ib];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00073}00073       ps = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[vx[i]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00074}00074       o[i][0] = 0.5 * (pa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + pb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00075}00075       o[i][1] = 0.5 * (pa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + pb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00076}00076       o[i][2] = 0.5 * (pa-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + pb-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00077}00077       p[i][0] = ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00078}00078       p[i][1] = ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00079}00079       p[i][2] = ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00080}00080     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00081}00081   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00082}00082   maxit = 4;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00083}00083   it = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00084}00084   tp = 1.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00085}00085   to = 0.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00086}00086   j  = 10;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00087}00087   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00088}00088     \textcolor{comment}{/* compute new position */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00089}00089     t = 0.5 * (tp + to);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00090}00090     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00091}00091       \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00092}00092         ps = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[vx[i]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00093}00093         ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[i][0] + t*(p[i][0] -\/ o[i][0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00094}00094         ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[i][1] + t*(p[i][1] -\/ o[i][1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00095}00095         ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[i][2] + t*(p[i][2] -\/ o[i][2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00096}00096         j=i;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00097}00097       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00098}00098     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00099}00099     \textcolor{keywordflow}{switch} (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}}) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00100}00100     \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00101}00101       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_aaf61b676742f0bfeec081b85f3e3e0f6}{MMGS\_split1\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,j,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00102}00102       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00103}00103     \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00104}00104       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a34daeb22e8ceb9b3c50f7b55318986f1}{MMGS\_split3\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00105}00105       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00106}00106     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00107}00107       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a1332346bfc6c9a4212b81e6dd7098400}{MMG5\_split2\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00108}00108       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00109}00109     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00110}00110     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00111}00111       to = t;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00112}00112     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00113}00113       tp = t;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00114}00114   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00115}00115   \textcolor{keywordflow}{while} ( ++it < maxit );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00116}00116   \textcolor{comment}{/* restore coords of last valid pos. */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00117}00117   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00118}00118     t = to;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00119}00119     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00120}00120       \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00121}00121         ps = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[vx[i]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00122}00122         ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[i][0] + t*(p[i][0] -\/ o[i][0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00123}00123         ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[i][1] + t*(p[i][1] -\/ o[i][1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00124}00124         ps-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[i][2] + t*(p[i][2] -\/ o[i][2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00125}00125       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00126}00126     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00127}00127   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00129}00129   \textcolor{comment}{/* For very ill-\/shaped elements we can have no valid position */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00130}00130   assert ( j< 10 );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00131}00131   \textcolor{keywordflow}{switch} (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}}) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00132}00132   \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00133}00133     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_aaf61b676742f0bfeec081b85f3e3e0f6}{MMGS\_split1\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,j,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00134}00134     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00135}00135   \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00136}00136     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a34daeb22e8ceb9b3c50f7b55318986f1}{MMGS\_split3\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00137}00137     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00138}00138   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00139}00139     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a1332346bfc6c9a4212b81e6dd7098400}{MMG5\_split2\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00140}00140     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00141}00141   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00142}00142   \textcolor{keywordflow}{return} \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00143}00143 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00156}\mbox{\hyperlink{mmgs1_8c_ad5b2232dc0fee41e97ab19661f3a5760}{00156}} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_ad5b2232dc0fee41e97ab19661f3a5760}{MMGS\_dichoto1b}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, MMG5\_int iel, \textcolor{keywordtype}{int} ia, MMG5\_int ip) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00157}00157   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}   pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00158}00158   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}  p0,p1,ppt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00159}00159   MMG5\_int     np,nq;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00160}00160   \textcolor{keywordtype}{int}          it,maxit,i1,i2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00161}00161   \textcolor{keywordtype}{double}       m[3],o[3],tp,to,t;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00162}00162   int8\_t       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00164}00164   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00166}00166   i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[ia];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00167}00167   i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00168}00168   np = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00169}00169   nq = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00170}00170   p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00171}00171   p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nq];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00173}00173   \textcolor{comment}{/* initial coordinates for new point */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00174}00174   ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00175}00175   o[0] = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00176}00176   o[1] = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00177}00177   o[2] = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00178}00178 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00179}00179   \textcolor{comment}{/* midpoint along edge */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00180}00180   m[0] = 0.5*(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00181}00181   m[1] = 0.5*(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00182}00182   m[2] = 0.5*(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00184}00184   maxit = 4;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00185}00185   it    = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00186}00186   tp    = 1.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00187}00187   to    = 0.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00188}00188   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00189}00189     t = 0.5*(to + tp);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00190}00190     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = m[0] + t*(o[0]-\/m[0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00191}00191     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = m[1] + t*(o[1]-\/m[1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00192}00192     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = m[2] + t*(o[2]-\/m[2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00193}00193 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00194}00194     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a8a0260c5560fff9b9aeae208566abf03}{MMGS\_simbulgept}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,iel,ia,ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00195}00195     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00196}00196       to = t;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00197}00197     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00198}00198       tp = t;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00199}00199   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00200}00200   \textcolor{keywordflow}{while} ( ++it < maxit );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00201}00201   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )  t = to;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00203}00203   \textcolor{comment}{/* For very ill-\/shaped elements, we can have no valid position */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00204}00204   ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = m[0] + t*(o[0]-\/m[0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00205}00205   ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = m[1] + t*(o[1]-\/m[1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00206}00206   ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = m[2] + t*(o[2]-\/m[2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00208}00208   \textcolor{keywordflow}{return}  \mbox{\hyperlink{libmmgs__private_8h_a8a0260c5560fff9b9aeae208566abf03}{MMGS\_simbulgept}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,iel,ia,ip) ;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00209}00209 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00210}00210 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00211}00211 \textcolor{comment}{/* check if edge need to be split and return a binary coding the numbers of the}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00212}00212 \textcolor{comment}{ * edges of tria iel that should be split according to a hausdorff distance}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00213}00213 \textcolor{comment}{ * criterion */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00214}\mbox{\hyperlink{libmmgs__private_8h_a59627429fa37902216c6ed2d6cf7353b}{00214}} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a41eea268b187706c8f6ddcf0cedd729b}{chkedg}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int iel) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00215}00215   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00216}00216   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p[3];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00217}00217   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}     par;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00218}00218   \textcolor{keywordtype}{double}        n[3][3],t[3][3],nt[3],c1[3],c2[3],*n1,*n2,t1[3],t2[3];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00219}00219   \textcolor{keywordtype}{double}        ps,ps2,cosn,ux,uy,uz,ll,li,dd,hausd,hmax;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00220}00220   \textcolor{keywordtype}{int}           l,isloc;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00221}00221   int8\_t        i,i1,i2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00222}00222   \textcolor{keyword}{static} int8\_t mmgWarn0 = 0, mmgWarn1 = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00223}00223 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00224}00224   pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00225}00225   p[0] = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[0]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00226}00226   p[1] = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[1]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00227}00227   p[2] = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[2]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00229}00229   \textcolor{comment}{/* normal recovery */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00230}00230   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00231}00231     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(p[i]-\/>tag) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00232}00232       \mbox{\hyperlink{mmgcommon__private_8h_abb8ea4584fddf99cd69c9dcf99553c29}{MMG5\_nortri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,n[i]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00233}00233     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00234}00234     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(p[i]-\/>tag) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00235}00235       \mbox{\hyperlink{mmgcommon__private_8h_abb8ea4584fddf99cd69c9dcf99553c29}{MMG5\_nortri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,nt);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00236}00236       n1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p[i]-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00237}00237       n2  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p[i]-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00238}00238       ps  = n1[0]*nt[0] + n1[1]*nt[1] + n1[2]*nt[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00239}00239       ps2 = n2[0]*nt[0] + n2[1]*nt[1] + n2[2]*nt[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00240}00240       \textcolor{keywordflow}{if} ( fabs(ps) > fabs(ps2) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00241}00241         memcpy(\&n[i],n1,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00242}00242       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00243}00243         memcpy(\&n[i],n2,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00244}00244       memcpy(\&t[i],p[i]-\/>n,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00245}00245     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00246}00246     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00247}00247       memcpy(\&n[i],p[i]-\/>n,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00248}00248   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00250}00250   \textcolor{comment}{/* analyze edges */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00251}00251   \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00252}00252     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00254}00254     i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00255}00255     i2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00257}00257     \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00258}00258     hmax   = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00259}00259     hausd  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00260}00260     isloc  = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00261}00261     \textcolor{keywordflow}{for} (l=0; l<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; l++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00262}00262       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[l];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00263}00263       \textcolor{keywordflow}{if} ( \textcolor{comment}{/*((par-\/>elt == MMG5\_Vertex) \&\&}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00264}00264 \textcolor{comment}{            ( (p[i1]-\/>ref == par-\/>ref ) || (p[i2]-\/>ref == par-\/>ref) ))}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00265}00265 \textcolor{comment}{            || */} ((par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} == \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} == par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}}) ) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00266}00266         \textcolor{keywordflow}{if} ( !isloc ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00267}00267           hmax  = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00268}00268           hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00269}00269           isloc = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00270}00270         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00271}00271         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00272}00272           hausd = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}},hausd);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00273}00273           hmax  = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}},hmax);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00274}00274         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00275}00275       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00276}00276     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00278}00278     \textcolor{comment}{/* check length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00279}00279     ux = p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00280}00280     uy = p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00281}00281     uz = p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00282}00282     ll = ux*ux + uy*uy + uz*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00283}00283     \textcolor{keywordflow}{if} ( ll > hmax*hmax ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00284}00284       \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00285}00285       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00286}00286     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00287}00287     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) \&\& p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} > \mbox{\hyperlink{mmgcommon__private_8h_a5e6a354c68173d51dd0a254c1dde1405}{MG\_NOTAG}} \&\& p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} > \mbox{\hyperlink{mmgcommon__private_8h_a5e6a354c68173d51dd0a254c1dde1405}{MG\_NOTAG}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00288}00288       \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00289}00289       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00290}00290     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00292}00292     \textcolor{comment}{/* Hausdorff w/r tangent direction */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00293}00293     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00294}00294       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(p[i1]-\/>tag) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00295}00295         li = 1.0 / sqrt(ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00296}00296         t1[0] = li*ux;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00297}00297         t1[1] = li*uy;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00298}00298         t1[2] = li*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00299}00299       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00300}00300       \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00301}00301         \textcolor{keywordflow}{if}(!((p[i1]-\/>tag \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}) ||  \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(p[i1]-\/>tag) ) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00302}00302           \textcolor{comment}{//  if(t[i1][0] > 10) \{}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00303}00303           \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00304}00304             fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: a-\/ at least 1 geometrical"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00305}00305                     \textcolor{stringliteral}{"{} problem\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00306}00306             mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00307}00307           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00308}00308           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00309}00309         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00310}00310         memcpy(t1,t[i1],3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00311}00311       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00313}00313       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(p[i2]-\/>tag) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00314}00314         li = 1.0 / sqrt(ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00315}00315         t2[0] = li*ux;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00316}00316         t2[1] = li*uy;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00317}00317         t2[2] = li*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00318}00318       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00319}00319       \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00320}00320         \textcolor{keywordflow}{if}(!((p[i2]-\/>tag \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}) || \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(p[i2]-\/>tag) ) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00321}00321           \textcolor{keywordflow}{if} ( !mmgWarn1 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00322}00322             fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: b-\/ at least 1 geometrical"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00323}00323                     \textcolor{stringliteral}{"{} problem\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00324}00324             mmgWarn1 = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00325}00325           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00326}00326           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00327}00327         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00328}00328         memcpy(t2,t[i2],3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00329}00329       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00330}00330 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00331}00331       ps = t1[0]*ux + t1[1]*uy + t1[2]*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00332}00332       ps *= ps;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00333}00333       cosn = ps/ll ;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00334}00334       cosn *= (1.0-\/cosn);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00335}00335       cosn *= (0.25*ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00336}00336       \textcolor{keywordflow}{if} ( cosn > hausd*hausd ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00337}00337         \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00338}00338         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00339}00339       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00341}00341       ps = -\/(t2[0]*ux + t2[1]*uy + t2[2]*uz);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00342}00342       ps *= ps;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00343}00343       cosn = ps/ll ;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00344}00344       cosn *= (1.0-\/cosn);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00345}00345       cosn *= (0.25*ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00346}00346       \textcolor{keywordflow}{if} ( cosn > hausd*hausd ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00347}00347         \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00348}00348         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00349}00349       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00350}00350     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00351}00351     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00352}00352       n1 = n[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00353}00353       n2 = n[i2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00355}00355       ps = ux*n1[0] + uy*n1[1] + uz*n1[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00356}00356       c1[0] = (2.0*p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ ps*n1[0]) / 3.0 -\/ p[i1]-\/>c[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00357}00357       c1[1] = (2.0*p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ ps*n1[1]) / 3.0 -\/ p[i1]-\/>c[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00358}00358       c1[2] = (2.0*p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ ps*n1[2]) / 3.0 -\/ p[i1]-\/>c[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00359}00359 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00360}00360       ps = -\/(ux*n2[0] + uy*n2[1] + uz*n2[2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00361}00361       c2[0] = (2.0*p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ ps*n2[0]) / 3.0 -\/ p[i2]-\/>c[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00362}00362       c2[1] = (2.0*p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ ps*n2[1]) / 3.0 -\/ p[i2]-\/>c[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00363}00363       c2[2] = (2.0*p[i2]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p[i1]-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ ps*n2[2]) / 3.0 -\/ p[i2]-\/>c[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00364}00364 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00365}00365       \textcolor{comment}{/* squared cosines */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00366}00366       ps = c1[0]*ux + c1[1]*uy + c1[2]*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00367}00367       ps *= ps;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00368}00368       dd = c1[0]*c1[0] + c1[1]*c1[1] + c1[2]*c1[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00369}00369       cosn  =  ps / (dd*ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00370}00370       cosn *= (1.0-\/cosn);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00371}00371       cosn *= (0.25*ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00372}00372       \textcolor{keywordflow}{if} ( cosn > hausd*hausd ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00373}00373         \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00374}00374         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00375}00375       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00377}00377       ps = -\/c2[0]*ux -\/ c2[1]*uy -\/ c2[2]*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00378}00378       ps *= ps;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00379}00379       dd = c2[0]*c2[0]+c2[1]*c2[1]+c2[2]*c2[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00380}00380       cosn  =  ps / (dd*ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00381}00381       cosn *= (1.0-\/cosn);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00382}00382       cosn *= (0.25*ll);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00383}00383       \textcolor{keywordflow}{if} ( cosn > hausd*hausd ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00384}00384         \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00385}00385         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00386}00386       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00387}00387     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00388}00388   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00389}00389 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00390}00390   \textcolor{keywordflow}{return} pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00391}00391 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00405}00405 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00406}\mbox{\hyperlink{mmgs1_8c_a52ec4ae0b1017c46be54588fe4a17d8d}{00406}} \textcolor{keywordtype}{void} \mbox{\hyperlink{mmgs1_8c_a52ec4ae0b1017c46be54588fe4a17d8d}{MMGS\_set\_localFunc}} ( \mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met, int8\_t typchk,}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00407}00407                           \textcolor{keywordtype}{double} (**MMGS\_lenEdg)(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}},MMG5\_int ,MMG5\_int,int8\_t),}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00408}00408                           \textcolor{keywordtype}{double} (**MMGS\_caltri)(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}},\mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}})) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00410}00410   \textcolor{keywordflow}{if} ( met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00411}00411     \textcolor{keywordflow}{if} ( (typchk == 1) \&\& (met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}} == 6) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00412}00412       *MMGS\_lenEdg = \mbox{\hyperlink{inlined__functions__private_8h_a7b9b1b9af66388894bcaf0d347b0da71}{MMG5\_lenSurfEdg33\_ani}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00413}00413       *MMGS\_caltri = \mbox{\hyperlink{mmgcommon__private_8h_afb12ed378c17c44e2b0eb5e3b4d7ad29}{MMG5\_caltri33\_ani}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00414}00414     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00415}00415     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( typchk == 2 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00416}00416       *MMGS\_lenEdg = MMG5\_lenSurfEdg;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00417}00417       *MMGS\_caltri = MMG5\_calelt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00418}00418     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00419}00419     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00420}00420       *MMGS\_lenEdg = \mbox{\hyperlink{inlined__functions__private_8h_a2764ba495bf15419565494fc6141474b}{MMG5\_lenSurfEdg\_iso}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00421}00421       *MMGS\_caltri = \mbox{\hyperlink{mmgcommon__private_8h_ae9ac730599a38ad9ffaab940e5fd9f83}{MMG5\_caltri\_iso}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00422}00422     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00423}00423   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00424}00424 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00425}00425 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00426}00426 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00428}\mbox{\hyperlink{mmgs1_8c_a562dcf0a1478904e0f0bc3e49e5fb1eb}{00428}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a562dcf0a1478904e0f0bc3e49e5fb1eb}{swpmsh}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,int8\_t typchk) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00429}00429   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00430}00430   \textcolor{keywordtype}{int}           it,maxit;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00431}00431   MMG5\_int      k,ns,nns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00432}00432   int8\_t        i;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00434}00434   \textcolor{comment}{/* Local function pointer toward the suitable functions to use for edge length}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00435}00435 \textcolor{comment}{   * and quality computation depending on the adaptation phase */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00436}00436   double (*MMGS\_lenEdg)(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}} ,MMG5\_int ,MMG5\_int, int8\_t ) = NULL;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00437}00437   double (*MMGS\_caltri)(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}} ,\mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}} pt ) = \mbox{\hyperlink{mmgcommon__private_8h_ae9ac730599a38ad9ffaab940e5fd9f83}{MMG5\_caltri\_iso}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00438}00438 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00439}00439   \mbox{\hyperlink{mmgs1_8c_a52ec4ae0b1017c46be54588fe4a17d8d}{MMGS\_set\_localFunc}} ( met, typchk, \&MMGS\_lenEdg, \&MMGS\_caltri);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00440}00440 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00441}00441   it = nns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00442}00442   maxit = 2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00443}00443   \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}}++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00444}00444   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00445}00445     ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00446}00446     \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00447}00447       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00448}00448       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00449}00449 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00450}00450       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00451}00451         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) || \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00452}00452         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_a2d5bd8fecf36668b5d575b78efd9d869}{chkswp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i,typchk,}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00453}00453                          MMGS\_lenEdg,MMGS\_caltri) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00454}00454           ns += \mbox{\hyperlink{libmmgs__private_8h_a4e7c7102eaba4a6b66a358d82ad12c70}{swapar}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00455}00455           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00456}00456         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00457}00457       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00458}00458     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00459}00459     nns += ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00460}00460   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00461}00461   \textcolor{keywordflow}{while} ( ns > 0 \&\& ++it < maxit );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00462}00462   \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& nns > 0 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00463}00463     fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} edge swapped\(\backslash\)n"{}},nns);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00464}00464 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00465}00465   \textcolor{keywordflow}{return} nns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00466}00466 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00467}00467 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00468}00468 \textcolor{comment}{/* Analyze triangles and move points to make mesh more uniform */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00469}\mbox{\hyperlink{mmgs1_8c_a1b0e36dc703af0990adc006b5c0e412b}{00469}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a1b0e36dc703af0990adc006b5c0e412b}{movtri}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,\textcolor{keywordtype}{int} maxit) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00470}00470   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00471}00471   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00472}00472   \textcolor{keywordtype}{int}           it,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}},ilist;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00473}00473   MMG5\_int      k,base,list[\mbox{\hyperlink{mmgcommon__private_8h_a891c73c5a9d1da972ad398df6e9d7f28}{MMG5\_TRIA\_LMAX}}+2],nm,ns,nnm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00474}00474   int8\_t        i;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00475}00475 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00476}00476   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00477}00477     fprintf(stdout,\textcolor{stringliteral}{"{}  ** OPTIMIZING MESH\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00479}00479   base = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00480}00480   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++)  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k].\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = base;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00481}00481 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00482}00482   it = nnm = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00483}00483   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00484}00484     base++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00485}00485     nm = ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00486}00486     for (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00487}00487       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00488}00488       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00490}00490       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00491}00491         ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00492}00492 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00493}00493         \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} == base || \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) || ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00494}00494           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00495}00495 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00496}00496         int8\_t dummy;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00497}00497         ilist = \mbox{\hyperlink{boulep_8c_a71f8e5d4eb5962634fdd646773a14e09}{MMG5\_boulet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,i,list,1,\&dummy);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00499}00499         \textcolor{keywordflow}{if} ( ilist < 1 ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00500}00500 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00501}00501         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00502}00502           \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = movridpt(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,list,ilist);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00503}00503           \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00504}00504             ns++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00505}00505           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00506}00506         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00507}00507         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00508}00508           \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = movintpt(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,list,ilist);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00509}00509         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00510}00510 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00511}00511         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00512}00512           nm++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00513}00513           ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = base;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00514}00514         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00515}00515       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00516}00516     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00517}00517     nnm += nm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00518}00518     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} )  fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} moved, \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} geometry\(\backslash\)n"{}},nm,ns);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00519}00519   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00520}00520   \textcolor{keywordflow}{while} ( ++it < maxit \&\& nm > 0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00521}00521 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00522}00522   \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& nnm > 0 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00523}00523     fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} vertices moved, \%d iter.\(\backslash\)n"{}},nnm,it);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00524}00524 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00525}00525   \textcolor{keywordflow}{return} nnm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00526}00526 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00536}00536 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00537}\mbox{\hyperlink{mmgs1_8c_ac278b8ada5dc46e7591adb387f72b1e1}{00537}} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_ac278b8ada5dc46e7591adb387f72b1e1}{MMGS\_delPatternPts}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Hash}{MMG5\_Hash}} hash)}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00538}00538 \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00539}00539   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}   pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00540}00540   MMG5\_int     vx[3],k;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00541}00541   \textcolor{keywordtype}{int}          i,i1,i2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00542}00542 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00543}00543   \textcolor{comment}{/* Delete the useless added points */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00544}00544   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00545}00545     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00546}00546     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00547}00547 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00548}00548     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00549}00549       i1    = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00550}00550       i2    = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00551}00551       vx[i] = \mbox{\hyperlink{hash_8c_ab5de9343b5c738f6614f3a1598faa338}{MMG5\_hashGet}}(\&hash,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00552}00552 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00553}00553       \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00554}00554         \mbox{\hyperlink{libmmgs__private_8h_a6a2ec4607e262012308cece90c528da8}{MMGS\_delPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},vx[i]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00555}00555         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{hash_8c_a664448f735b3d71e4e122a1874b2ebd1}{MMG5\_hashUpdate}}(\&hash,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2],0) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00556}00556           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to delete point idx"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00557}00557                   \textcolor{stringliteral}{"{} along edge \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{}.\(\backslash\)n"{}}, \_\_func\_\_,}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00558}00558                   \mbox{\hyperlink{gentools__s_8c_a4913c15d69c6ffc6af29d6b2eed26200}{MMGS\_indPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]),}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00559}00559                   \mbox{\hyperlink{gentools__s_8c_a4913c15d69c6ffc6af29d6b2eed26200}{MMGS\_indPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00560}00560           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},hash.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00561}00561           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00562}00562         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00563}00563       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00564}00564     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00565}00565   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00566}00566   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00567}00567 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00579}\mbox{\hyperlink{mmgs1_8c_a5e4d37e6ba429429a6625e1665572a4b}{00579}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a5e4d37e6ba429429a6625e1665572a4b}{anaelt}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,int8\_t typchk) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00580}00580   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00581}00581   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt,p1,p2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00582}00582   \mbox{\hyperlink{structMMG5__Hash}{MMG5\_Hash}}     hash;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00583}00583   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}   pb;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00584}00584   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}  go;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00585}00585   \textcolor{keywordtype}{double}        s,o[3],no[3],to[3],dd,len;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00586}00586   \textcolor{keywordtype}{int}           i,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}},it;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00587}00587   MMG5\_int      ns,nc,ni,ic;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00588}00588   MMG5\_int      k,nt,vx[3],j,ip,ip1,ip2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00589}00589   int8\_t        i1,i2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00590}00590   \textcolor{keyword}{static} \textcolor{keywordtype}{double} uv[3][2] = \{ \{0.5,0.5\}, \{0.,0.5\}, \{0.5,0.\} \};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00591}00591   \textcolor{keyword}{static} int8\_t mmgWarn0=0,mmgWarn1=0,mmgWarn2=0,mmgWarn3=0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00592}00592 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00593}00593   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{hash_8c_a8dafcb56c527c1ed983952055b52668c}{MMG5\_hashNew}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&hash,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}},3*\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}) ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00594}00594   ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00595}00595   s  = 0.5;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00596}00596   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00597}00597     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00598}00598 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00599}00599     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00600}00600       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00601}00601     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00603}00603     pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00604}00604 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00605}00605     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00606}00606       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00607}00607     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00608}00608 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00609}00609     \textcolor{comment}{/* Required triangle */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00610}00610     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[0]) \&\& \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[1]) \&\& \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[2]) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00611}00611 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00612}00612     \textcolor{comment}{/* check element cut */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00613}00613     \textcolor{keywordflow}{if} ( typchk == 1 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00614}00614       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgs1_8c_a41eea268b187706c8f6ddcf0cedd729b}{chkedg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00615}00615     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00616}00616     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( typchk == 2 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00617}00617       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00618}00618         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00619}00619 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00620}00620         i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00621}00621         i2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00622}00622         len = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2],0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00623}00623         \textcolor{keywordflow}{if} ( !len ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00624}00624         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( len > \mbox{\hyperlink{libmmgs__private_8h_a570d538c62811133c82ef03e3c1af910}{MMGS\_LLONG}} )  \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00625}00625           \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00626}00626         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00627}00627       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00628}00628       \textcolor{keywordflow}{if} ( !pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00629}00629     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00630}00630     ns++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00631}00631 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00632}00632     \textcolor{comment}{/* geometric support */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00633}00633     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&pb,1);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00634}00634     assert(\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00635}00635 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00636}00636     \textcolor{comment}{/* scan edges to split */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00637}00637     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00638}00638       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00639}00639       i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00640}00640       i2  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00641}00641       ip1 = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00642}00642       ip2 = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00643}00643       ip = \mbox{\hyperlink{hash_8c_ab5de9343b5c738f6614f3a1598faa338}{MMG5\_hashGet}}(\&hash,ip1,ip2);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00644}00644 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00645}00645       \textcolor{comment}{/* do not compute the point twice except along special edges */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00646}00646       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) \&\& ip > 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00647}00647 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00648}00648       \textcolor{comment}{/* new point along edge */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00649}00649       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{bezier__s_8c_af28863e323b0285b67041c01f8fbbe2b}{MMGS\_bezierInt}}(\&pb,uv[i],o,no,to);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00650}00650       \textcolor{keywordflow}{if} ( !ip ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00651}00651         ip = \mbox{\hyperlink{libmmgs__private_8h_a0b7b978371c90e3af3caeb2a837ce0c2}{MMGS\_newPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},o,\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ? to : no);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00652}00652 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00653}00653         \textcolor{keywordflow}{if} ( !ip ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00654}00654           \textcolor{comment}{/* reallocation of point table */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00655}00655           \mbox{\hyperlink{libmmgs__private_8h_a4d0aab3588bad229409880c7c6c7e1ff}{MMGS\_POINT\_REALLOC}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ip,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa236af3993812da0fae647a11e9088b9}{gap}},}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00656}00656                               fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00657}00657                                       \textcolor{stringliteral}{"{} allocate a new point.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00658}00658                               \mbox{\hyperlink{mmgcommon__private_8h_a39637ec72523047aff8a4aa73d7014c9}{MMG5\_INCREASE\_MEM\_MESSAGE}}();}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00659}00659                               \mbox{\hyperlink{mmgs1_8c_ac278b8ada5dc46e7591adb387f72b1e1}{MMGS\_delPatternPts}}( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, hash);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00660}00660                               \textcolor{keywordflow}{return} -\/1}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00661}00661                               ,o,\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ? to : no);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00662}00662           \textcolor{comment}{// Now pb-\/>p contain a wrong memory address.}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00663}00663           pb.\mbox{\hyperlink{structMMG5__Bezier_a560b0f0c0cd5a3da7c4796499f146ca4}{p}}[0] = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[0]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00664}00664           pb.\mbox{\hyperlink{structMMG5__Bezier_a560b0f0c0cd5a3da7c4796499f146ca4}{p}}[1] = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[1]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00665}00665           pb.\mbox{\hyperlink{structMMG5__Bezier_a560b0f0c0cd5a3da7c4796499f146ca4}{p}}[2] = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[2]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00666}00666         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00667}00667 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00668}00668         \mbox{\hyperlink{hash_8c_abf9ecdc9c796612c38768d7d15d28642}{MMG5\_hashEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&hash,ip1,ip2,ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00669}00669         p1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00670}00670         p2  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00671}00671         ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00672}00672 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00673}00673         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00674}00674           ++\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00675}00675           \textcolor{keywordflow}{if}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}} > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}})\{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00676}00676             \textcolor{comment}{/* reallocation of xpoint table */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00677}00677             \mbox{\hyperlink{mmgcommon__private_8h_a7c5021138095892cf2699f36a7c526ae}{MMG5\_TAB\_RECALLOC}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}},\mbox{\hyperlink{mmgcommon__private_8h_a50b381cd31a4a90064ce1d936a7c037d}{MMG5\_GAP}},\mbox{\hyperlink{structMMG5__xPoint}{MMG5\_xPoint}},}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00678}00678                                \textcolor{stringliteral}{"{}larger xpoint table"{}},}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00679}00679                                \textcolor{keywordflow}{return} -\/1);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00680}00680           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00681}00681           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00682}00682           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} = pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00683}00683           \textcolor{keywordflow}{if} ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tria_a224dfed682ca131cfbd0ee79694cf613}{edg}}[i] || p2-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tria_a224dfed682ca131cfbd0ee79694cf613}{edg}}[i] )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00684}00684             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}} = pt-\/>\mbox{\hyperlink{structMMG5__Tria_a224dfed682ca131cfbd0ee79694cf613}{edg}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00685}00685           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00686}00686           go = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}}];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00687}00687           memset(go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}},0x00,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00688}00688           memcpy(go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}},no,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00690}00690           dd = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] + go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] + go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00691}00691           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] -\/= dd*go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00692}00692           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] -\/= dd*go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00693}00693           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] -\/= dd*go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00694}00694           dd = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] + ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] + ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00695}00695           \textcolor{keywordflow}{if} ( dd > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00696}00696             dd = 1.0 / sqrt(dd);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00697}00697             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00698}00698             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00699}00699             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00700}00700           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00701}00701         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00702}00702         \textcolor{keywordflow}{if} ( met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00703}00703           \textcolor{keywordflow}{if} ( typchk == 1 \&\& (met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}}>1) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00704}00704             \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{intmet__s_8c_aac6590ef1d5b729d80fc39636967a675}{MMGS\_intmet33\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i,ip,s);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00705}00705           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00706}00706             \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = intmet(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i,ip,s);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00707}00707         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00708}00708 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00709}00709         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00710}00710           \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00711}00711             fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to interpolate at least"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00712}00712                     \textcolor{stringliteral}{"{} 1 metric.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00713}00713             mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00714}00714           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00715}00715           \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00716}00716         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00717}00717       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00718}00718       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} \&\& !(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00719}00719         ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00720}00720         go  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00721}00721         memcpy(go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}},no,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00722}00722 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00723}00723         \textcolor{comment}{/* a computation of the tangent with respect to these two normals is possible */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00724}00724         ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2] -\/ go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00725}00725         ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0] -\/ go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00726}00726         ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1] -\/ go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00727}00727         dd = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] + ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] + ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00728}00728         \textcolor{keywordflow}{if} ( dd > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00729}00729           dd = 1.0 / sqrt(dd);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00730}00730           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00731}00731           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00732}00732           ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00733}00733         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00734}00734         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00735}00735           \textcolor{keywordflow}{if} ( !mmgWarn1 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00736}00736             mmgWarn1 = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00737}00737             fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: flattened angle around ridge."{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00738}00738                     \textcolor{stringliteral}{"{} Unable to split it.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00739}00739           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00740}00740           \textcolor{comment}{/* Remove the point */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00741}00741           \mbox{\hyperlink{libmmgs__private_8h_a6a2ec4607e262012308cece90c528da8}{MMGS\_delPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00742}00742           \mbox{\hyperlink{hash_8c_a664448f735b3d71e4e122a1874b2ebd1}{MMG5\_hashUpdate}}(\&hash,ip1,ip2,0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00743}00743         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00744}00744       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00745}00745     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00746}00746   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00747}00747   \textcolor{keywordflow}{if} ( !ns ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00748}00748     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},hash.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00749}00749     \textcolor{keywordflow}{return} ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00750}00750   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00751}00751 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00752}00752   \textcolor{comment}{/* step 2. checking if split by adjacent */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00753}00753   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00754}00754     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00755}00755     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00756}00756     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} == 7 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00757}00757 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00758}00758     \textcolor{comment}{/* geometric support */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00759}00759     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&pb,1);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00760}00760     assert(\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00761}00761     nc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00763}00763     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00764}00764       i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00765}00765       i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00766}00766       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00767}00767         ip = \mbox{\hyperlink{hash_8c_ab5de9343b5c738f6614f3a1598faa338}{MMG5\_hashGet}}(\&hash,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00768}00768         \textcolor{keywordflow}{if} ( ip > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00769}00769           \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00770}00770           nc++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00771}00771           \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00772}00772             \textcolor{comment}{/* new point along edge */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00773}00773             \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{bezier__s_8c_af28863e323b0285b67041c01f8fbbe2b}{MMGS\_bezierInt}}(\&pb,uv[i],o,no,to);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00774}00774             assert(\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00775}00775 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00776}00776             ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00777}00777             go  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00778}00778             memcpy(go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}},no,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00779}00779 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00780}00780             \textcolor{comment}{/* a computation of the tangent with respect to these two normals is possible */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00781}00781             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2] -\/ go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00782}00782             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0] -\/ go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00783}00783             ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1] -\/ go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1]*go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00784}00784             dd = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] + ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] + ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2]*ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00785}00785             \textcolor{keywordflow}{if} ( dd > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00786}00786               dd = 1.0 / sqrt(dd);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00787}00787               ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00788}00788               ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00789}00789               ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] *= dd;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00790}00790             \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00791}00791           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00792}00792         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00793}00793       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00794}00794     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00795}00795     \textcolor{keywordflow}{if} ( nc > 0 )  ++ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00796}00796   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00797}00797   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} \&\& ns ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00798}00798     fprintf(stdout,\textcolor{stringliteral}{"{}     \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} analyzed  \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} proposed\(\backslash\)n"{}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}},ns);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00799}00799     fflush(stdout);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00800}00800   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00801}00801 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00803}00803   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++)}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00804}00804     \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k].\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00805}00805 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00806}00806   it = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00807}00807   nc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00808}00808   j  = 0; \textcolor{comment}{// To remove maybe-\/uninitialized warning on arm}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00809}00809   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00810}00810     ni = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00811}00811     for (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00812}00812       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00813}00813       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00814}00814       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} == 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00815}00815 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00816}00816       vx[0] = vx[1] = vx[2] = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00817}00817       pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} = ic = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00819}00819       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00820}00820         i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00821}00821         i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00822}00822         vx[i] = \mbox{\hyperlink{hash_8c_ab5de9343b5c738f6614f3a1598faa338}{MMG5\_hashGet}}(\&hash,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00823}00823         \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00824}00824           \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}},i);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00825}00825           \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[vx[i]].\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} > 2 )  ic = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00826}00826           j = i;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00827}00827         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00828}00828       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00829}00829       \textcolor{keywordflow}{if} ( !pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00830}00830       \textcolor{keywordflow}{switch} (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}}) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00831}00831       \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00832}00832         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_aaf61b676742f0bfeec081b85f3e3e0f6}{MMGS\_split1\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,j,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00833}00833         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00834}00834       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00835}00835         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a34daeb22e8ceb9b3c50f7b55318986f1}{MMGS\_split3\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00836}00836         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00837}00837       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00838}00838         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a1332346bfc6c9a4212b81e6dd7098400}{MMG5\_split2\_sim}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00839}00839         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00840}00840       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00841}00841       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00842}00842 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00843}00843       ni++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00844}00844       \textcolor{keywordflow}{if} ( ic == 0 \&\& \mbox{\hyperlink{mmgs1_8c_a6501536d697952d6a069675e0cb5ba76}{MMGS\_dichoto}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00845}00845         \textcolor{keywordflow}{for} (i=0; i<3; i++)}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00846}00846           \textcolor{keywordflow}{if} ( vx[i] > 0 )  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[vx[i]].\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}}++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00847}00847       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00848}00848       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00849}00849         \textcolor{keywordflow}{if} ( it < 20 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00850}00850           \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00851}00851             \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00852}00852               p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i]]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00853}00853               p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i]]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00854}00854               ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[vx[i]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00855}00855               ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = 0.5 * (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] + p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00856}00856               ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = 0.5 * (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] + p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00857}00857               ppt-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = 0.5 * (p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] + p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00858}00858             \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00859}00859           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00860}00860         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00861}00861         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00862}00862           \textcolor{keywordflow}{if} ( it==20 \&\& (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}} > 5) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00863}00863             \textcolor{keywordflow}{if} ( !mmgWarn2 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00864}00864               fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: surfacic pattern: unable to"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00865}00865                       \textcolor{stringliteral}{"{} find a valid split for at least 1 point. Point(s)"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00866}00866                       \textcolor{stringliteral}{"{} deletion."{}},\_\_func\_\_ );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00867}00867               mmgWarn2 = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00868}00868             \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00869}00869           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00870}00870           \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00871}00871             \textcolor{keywordflow}{if} ( vx[i] > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00872}00872               \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{hash_8c_a664448f735b3d71e4e122a1874b2ebd1}{MMG5\_hashUpdate}}(\&hash,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i]],}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00873}00873                                      pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i]],0) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00874}00874                 fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to delete point"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00875}00875                         \textcolor{stringliteral}{"{} idx along edge \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{}.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00876}00876                         \_\_func\_\_,\mbox{\hyperlink{gentools__s_8c_a4913c15d69c6ffc6af29d6b2eed26200}{MMGS\_indPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i]]),}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00877}00877                         \mbox{\hyperlink{gentools__s_8c_a4913c15d69c6ffc6af29d6b2eed26200}{MMGS\_indPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i]]));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00878}00878                 \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},hash.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00879}00879                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00880}00880               \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00881}00881               \mbox{\hyperlink{libmmgs__private_8h_a6a2ec4607e262012308cece90c528da8}{MMGS\_delPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},vx[i]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00882}00882             \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00883}00883           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00884}00884         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00885}00885       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00886}00886     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00887}00887     nc += ni;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00888}00888   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00889}00889   \textcolor{keywordflow}{while}( ni > 0 \&\& ++it < 40 );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00890}00890 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00891}00891   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} \&\& nc ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00892}00892     fprintf(stdout,\textcolor{stringliteral}{"{}     \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} corrected,  \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{} invalid\(\backslash\)n"{}},nc,ni);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00893}00893     fflush(stdout);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00894}00894   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00895}00895 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00896}00896   \textcolor{comment}{/* step 4. splitting */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00897}00897   ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00898}00898   nt = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00899}00899   \textcolor{keywordflow}{for} (k=1; k<=nt; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00900}00900     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00901}00901     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>ref < 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00902}00902     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pt-\/>flag == 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00903}00903 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00904}00904     j  = -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00905}00905     vx[0] = vx[1] = vx[2] = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00906}00906     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00907}00907       i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00908}00908       i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00909}00909       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pt-\/>flag,i) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00910}00910         vx[i] = \mbox{\hyperlink{hash_8c_ab5de9343b5c738f6614f3a1598faa338}{MMG5\_hashGet}}(\&hash,pt-\/>v[i1],pt-\/>v[i2]);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00911}00911         \textcolor{keywordflow}{if} ( !vx[i] ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00912}00912           \textcolor{keywordflow}{if} ( !mmgWarn3 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00913}00913             mmgWarn3 = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00914}00914             fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to create point on"{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00915}00915                     \textcolor{stringliteral}{"{} at least 1 edge.\(\backslash\)n Exit program.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00916}00916           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00917}00917           \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00918}00918         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00919}00919         j = i;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00920}00920       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00921}00921     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00922}00922     \textcolor{keywordflow}{if} ( pt-\/>flag == 1 || pt-\/>flag == 2 || pt-\/>flag == 4 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00923}00923       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a2a75ebf1b6a007e5535785eaea589850}{MMGS\_split1}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,j,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00924}00924       ns++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00925}00925     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00926}00926     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pt-\/>flag == 7 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00927}00927       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a7622a2a2c76459ab5d92253918107026}{MMGS\_split3}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00928}00928       ns++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00929}00929     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00930}00930     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00931}00931       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_acdb38b10e66129aad4d524a8b8434ae8}{MMGS\_split2}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,vx);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00932}00932       ns++;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00933}00933     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00934}00934     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00935}00935   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00936}00936   \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} || abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5) \&\& ns > 0 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00937}00937     fprintf(stdout,\textcolor{stringliteral}{"{}     \%7"{}} MMG5\_PRId \textcolor{stringliteral}{"{} splitted\(\backslash\)n"{}},ns);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00938}00938   \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},hash.item);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00939}00939 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00940}00940   \textcolor{keywordflow}{return} ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00941}00941 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00942}00942 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00954}\mbox{\hyperlink{mmgs1_8c_aad9af2aeabdc1d706b046db28157a1d7}{00954}} MMG5\_int \mbox{\hyperlink{mmgs1_8c_aad9af2aeabdc1d706b046db28157a1d7}{chkspl}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int k,\textcolor{keywordtype}{int} i) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00955}00955   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt,pt1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00956}00956   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00957}00957   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}  go;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00958}00958   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}   b;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00959}00959   \textcolor{keywordtype}{double}        s,uv[2],o[3],no[3],to[3];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00960}00960   \textcolor{keywordtype}{int}           \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00961}00961   MMG5\_int      ip,*adja,jel;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00962}00962   int8\_t        i1,i2,j,jj,j2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00963}00963 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00964}00964   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}} > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_afe3e3e7865486b4ed66cd2c9265d6acf}{xpmax}}-\/2 )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00965}00965   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00966}00966   i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00967}00967   i2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00968}00968   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i1]) || \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i2]) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00969}00969   adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[3*(k-\/1)+1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00970}00970   jel  = adja[i] / 3;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00971}00971   \textcolor{keywordflow}{if} ( jel ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00972}00972     j   = adja[i] \% 3;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00973}00973     jj  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[j];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00974}00974     j2  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[j];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00975}00975     pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[jel];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00976}00976     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt1-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[jj]) || \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt1-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[j2]) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00977}00977   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00978}00978 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00979}00979   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&b,1);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00980}00980   assert ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00981}00981 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00982}00982   \textcolor{comment}{/* create midedge point */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00983}00983   uv[0] = 0.5;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00984}00984   uv[1] = 0.5;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00985}00985   \textcolor{keywordflow}{if} (i == 1)         uv[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00986}00986   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( i == 2 )  uv[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00987}00987 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00988}00988   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{bezier__s_8c_af28863e323b0285b67041c01f8fbbe2b}{MMGS\_bezierInt}}(\&b,uv,o,no,to);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00989}00989   assert(\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00990}00990   ip = \mbox{\hyperlink{libmmgs__private_8h_a0b7b978371c90e3af3caeb2a837ce0c2}{MMGS\_newPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},o,\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ? to : no);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00991}00991   \textcolor{keywordflow}{if} ( !ip ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00992}00992     \textcolor{comment}{/* reallocation of point table */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00993}00993     \mbox{\hyperlink{libmmgs__private_8h_a4d0aab3588bad229409880c7c6c7e1ff}{MMGS\_POINT\_REALLOC}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ip,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa236af3993812da0fae647a11e9088b9}{gap}},}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00994}00994                         \mbox{\hyperlink{mmgcommon__private_8h_a39637ec72523047aff8a4aa73d7014c9}{MMG5\_INCREASE\_MEM\_MESSAGE}}();}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00995}00995                         \textcolor{keywordflow}{return} -\/1}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00996}00996                         ,o,\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ? to : no);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00997}00997   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00998}00998 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l00999}00999   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01000}01000     ++\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01001}01001     ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01002}01002     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} = pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01003}01003     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01004}01004     go = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aa20b932fedde1ff99cf9df3b196f07ef}{xp}}];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01005}01005     memcpy(go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}},no,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01006}01006   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01007}01007   s = 0.5;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01008}01008 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01009}01009   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = intmet(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i,ip,s);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01010}01010   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01011}01011 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01012}01012   \textcolor{keywordflow}{return} ip;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01013}01013 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01014}01014 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01025}\mbox{\hyperlink{mmgs1_8c_a60f6083cf0f75f12773939e3410cb31d}{01025}} \textcolor{keyword}{static} MMG5\_int \mbox{\hyperlink{mmgs1_8c_a60f6083cf0f75f12773939e3410cb31d}{colelt}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,int8\_t typchk) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01026}01026   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01027}01027   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p1,p2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01028}01028   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}     par;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01029}01029   \textcolor{keywordtype}{double}        ll,ux,uy,uz,hmin;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01030}01030   MMG5\_int      nc,list[\mbox{\hyperlink{mmgcommon__private_8h_a891c73c5a9d1da972ad398df6e9d7f28}{MMG5\_TRIA\_LMAX}}+2],k;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01031}01031   \textcolor{keywordtype}{int}           l,isloc,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}},ilist;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01032}01032   int8\_t        i,i1,i2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01033}01033 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01034}01034   \textcolor{comment}{/* Local function pointer toward the suitable functions to use for edge length}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01035}01035 \textcolor{comment}{   * and quality computation depending on the adaptation phase */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01036}01036   double (*MMGS\_lenEdg)(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}} ,MMG5\_int ,MMG5\_int, int8\_t ) = NULL;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01037}01037   double (*MMGS\_caltri)(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} \mbox{\hyperlink{API__functionsf__2d_8c_a75584f1b13bdd380dfef977b340126da}{sol}} ,\mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}} pt ) = \mbox{\hyperlink{mmgcommon__private_8h_ae9ac730599a38ad9ffaab940e5fd9f83}{MMG5\_caltri\_iso}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01038}01038 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01039}01039   \mbox{\hyperlink{mmgs1_8c_a52ec4ae0b1017c46be54588fe4a17d8d}{MMGS\_set\_localFunc}} ( met, typchk, \&MMGS\_lenEdg, \&MMGS\_caltri);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01040}01040 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01041}01041   nc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01042}01042   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01043}01043     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01044}01044     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01045}01045 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01046}01046     \textcolor{comment}{/* check edge length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01047}01047     pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01048}01048 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01049}01049     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01050}01050       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01051}01051 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01052}01052       i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01053}01053       i2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01054}01054       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01055}01055       p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01056}01056       \textcolor{keywordflow}{if} ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} || p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01057}01057       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01058}01058       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} > p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} || p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} > pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01059}01059 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01060}01060       \textcolor{comment}{/* check length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01061}01061       \textcolor{keywordflow}{if} ( typchk == 1 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01062}01062         ux = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01063}01063         uy = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01064}01064         uz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01065}01065         ll = ux*ux + uy*uy + uz*uz;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01066}01066 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01067}01067         \textcolor{comment}{/* local parameters*/}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01068}01068         hmin  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01069}01069         isloc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01070}01070         \textcolor{keywordflow}{for} (l=0; l<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; l++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01071}01071           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[l];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01072}01072           \textcolor{keywordflow}{if} ( \textcolor{comment}{/*((par-\/>elt == MMG5\_Vertex) \&\&}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01073}01073 \textcolor{comment}{                ( (p1-\/>ref == par-\/>ref ) || (p2-\/>ref == par-\/>ref) ))}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01074}01074 \textcolor{comment}{                || */}((par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} == \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} == par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}}) ) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01075}01075             \textcolor{keywordflow}{if} ( !isloc ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01076}01076               hmin  = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01077}01077               isloc = 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01078}01078             \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01079}01079             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01080}01080               hmin  = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}},hmin);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01081}01081             \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01082}01082           \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01083}01083         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01084}01084         \textcolor{keywordflow}{if} ( ll > hmin*hmin )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01085}01085       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01086}01086       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01087}01087         ll = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2],0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01088}01088         \textcolor{keywordflow}{if} ( !ll ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01089}01089         \textcolor{keywordflow}{if} ( ll > \mbox{\hyperlink{libmmgs__private_8h_ae247a987dc3ef6dcbae38be7fc994cb7}{MMGS\_LSHRT}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01090}01090       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01091}01091 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01092}01092       \textcolor{comment}{/* check if geometry preserved */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01093}01093       ilist = \mbox{\hyperlink{colver__s_8c_aea074daee2550fea8cfc7551f698606e}{chkcol}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i,list,typchk,MMGS\_lenEdg,MMGS\_caltri);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01094}01094 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01095}01095       int8\_t open = (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[3*(k-\/1)+1+i] == 0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01096}01096 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01097}01097       \textcolor{keywordflow}{if} ( ilist+open > 3 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01098}01098         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{colver__s_8c_a39a5444b08cea2976dd42821ff16f6d3}{colver}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list,ilist);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01099}01099         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01100}01100         nc += \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01101}01101         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01102}01102       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01103}01103       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ilist == 3 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01104}01104         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{colver__s_8c_a7519c000b525f1cec179ed858c05f47f}{colver3}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01105}01105         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01106}01106         nc += \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01107}01107         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01108}01108       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01109}01109       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ilist == 2 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01110}01110         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{colver__s_8c_ab6da8e5639a065f0e2e0e53ebe3c150a}{colver2}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01111}01111         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01112}01112         nc += \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01113}01113         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01114}01114       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01115}01115     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01116}01116   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01117}01117   \textcolor{keywordflow}{if} ( nc > 0 \&\& (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01118}01118     fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} vertices removed\(\backslash\)n"{}},nc);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01119}01119 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01120}01120   \textcolor{keywordflow}{return} nc;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01121}01121 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01122}01122 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01132}\mbox{\hyperlink{mmgs1_8c_a8c4b0cb108ef9ffa7f88d314a219ba7e}{01132}} \textcolor{keyword}{static} MMG5\_int \mbox{\hyperlink{mmgs1_8c_a8c4b0cb108ef9ffa7f88d314a219ba7e}{adpspl}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01133}01133   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01134}01134   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p1,p2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01135}01135   \textcolor{keywordtype}{double}        len,lmax;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01136}01136   \textcolor{keywordtype}{int}           \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01137}01137   MMG5\_int      ip,ns,k;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01138}01138   int8\_t        i,i1,i2,imax;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01139}01139 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01140}01140   ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01141}01141   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01142}01142     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01143}01143     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01144}01144 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01145}01145     \textcolor{comment}{/* check edge length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01146}01146     pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01147}01147     imax = -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01148}01148     lmax = -\/1.0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01149}01149     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01150}01150       i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01151}01151       i2  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01152}01152       len = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2],0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01153}01153 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01154}01154       \textcolor{keywordflow}{if} ( !len ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01155}01155 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01156}01156       \textcolor{keywordflow}{if} ( len > lmax ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01157}01157         lmax = len;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01158}01158         imax = i;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01159}01159       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01160}01160     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01161}01161     \textcolor{keywordflow}{if} ( lmax < \mbox{\hyperlink{libmmgs__private_8h_a49e2ee871a938555d90063b99d16979b}{MMGS\_LOPTL}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01162}01162     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[imax]) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01163}01163 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01164}01164     \textcolor{comment}{/* check length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01165}01165     i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[imax];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01166}01166     i2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[imax];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01167}01167     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01168}01168     p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01169}01169     \textcolor{keywordflow}{if} ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} || p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01170}01170 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01171}01171     ip = \mbox{\hyperlink{mmgs1_8c_aad9af2aeabdc1d706b046db28157a1d7}{chkspl}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,imax);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01172}01172     \textcolor{keywordflow}{if} ( ip < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01173}01173       \textcolor{comment}{/* Lack of memory, go to collapse step. */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01174}01174       \textcolor{keywordflow}{return} (ns);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01175}01175     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01176}01176     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ip > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01177}01177       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_a8a0260c5560fff9b9aeae208566abf03}{MMGS\_simbulgept}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,imax,ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01178}01178       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01179}01179         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{mmgs1_8c_ad5b2232dc0fee41e97ab19661f3a5760}{MMGS\_dichoto1b}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,imax,ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01180}01180         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01181}01181           \mbox{\hyperlink{libmmgs__private_8h_a6a2ec4607e262012308cece90c528da8}{MMGS\_delPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01182}01182           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01183}01183         \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01184}01184       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01185}01185       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmgs__private_8h_af78f2d5f99b366ab6a8ada4be72986a8}{split1b}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,imax,ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01186}01186 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01187}01187       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01188}01188         \textcolor{comment}{/* Lack of memory, go to collapse step. */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01189}01189         \mbox{\hyperlink{libmmgs__private_8h_a6a2ec4607e262012308cece90c528da8}{MMGS\_delPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},ip);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01190}01190         \textcolor{keywordflow}{return} ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01191}01191       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01192}01192       \textcolor{comment}{/* if we realloc memory in split1b pt pointer is not valid anymore. */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01193}01193       ns += \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01194}01194     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01195}01195   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01196}01196   \textcolor{keywordflow}{return} ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01197}01197 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01198}01198 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01208}\mbox{\hyperlink{mmgs1_8c_ae8be0691345b57d115b1a67b109e4b41}{01208}} \textcolor{keyword}{static} MMG5\_int \mbox{\hyperlink{mmgs1_8c_ae8be0691345b57d115b1a67b109e4b41}{adpcol}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01209}01209   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01210}01210   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p1,p2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01211}01211   \textcolor{keywordtype}{double}        len;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01212}01212   MMG5\_int      nc,k,list[\mbox{\hyperlink{mmgcommon__private_8h_a891c73c5a9d1da972ad398df6e9d7f28}{MMG5\_TRIA\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01213}01213   \textcolor{keywordtype}{int}           \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}},ilist;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01214}01214   int8\_t        i,i1,i2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01215}01215 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01216}01216   nc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01217}01217   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac2b242eb440476131b4dee4b6bcc1ec4}{nt}}; k++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01218}01218     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[k];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01219}01219     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} < 0 )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01220}01220 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01221}01221     \textcolor{comment}{/* check edge length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01222}01222     pt-\/>\mbox{\hyperlink{structMMG5__Tria_a6b188066f24738473865292223c9c320}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01223}01223     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01224}01224       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i]) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01225}01225 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01226}01226       \textcolor{comment}{/* check length */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01227}01227       i1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01228}01228       i2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01229}01229       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01230}01230       p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01231}01231       \textcolor{keywordflow}{if} ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} || p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01232}01232 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01233}01233       len = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2],0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01234}01234       \textcolor{keywordflow}{if} ( !len ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01235}01235       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( len > \mbox{\hyperlink{libmmgs__private_8h_a3861620c769c8e22f6aca500dc0e1b1a}{MMGS\_LOPTS}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01236}01236 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01237}01237       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01238}01238       p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]];}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01239}01239       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmgs__private_8h_aeca8a318e44bf3c9d33ea7eda695a363}{MS\_SIN}}(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01240}01240       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} > p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} || p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} > pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i] )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01242}01242       \textcolor{comment}{/* check if geometry preserved */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01243}01243       ilist = \mbox{\hyperlink{colver__s_8c_aea074daee2550fea8cfc7551f698606e}{chkcol}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,i,list,2,MMG5\_lenSurfEdg,MMG5\_calelt);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01244}01244 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01245}01245       int8\_t open = (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[3*(k-\/1)+1+i] == 0);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01246}01246 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01247}01247       \textcolor{keywordflow}{if} ( ilist+open > 3 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01248}01248         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} =  \mbox{\hyperlink{colver__s_8c_a39a5444b08cea2976dd42821ff16f6d3}{colver}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list,ilist);;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01249}01249         nc +=  \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01250}01250         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01251}01251         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01252}01252       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01253}01253       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ilist == 3 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01254}01254         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{colver__s_8c_a7519c000b525f1cec179ed858c05f47f}{colver3}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01255}01255         nc += \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01256}01256         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01257}01257         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01258}01258       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01259}01259       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ilist == 2 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01260}01260         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{colver__s_8c_ab6da8e5639a065f0e2e0e53ebe3c150a}{colver2}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01261}01261         nc += \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01262}01262         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01263}01263         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01264}01264       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01265}01265     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01266}01266   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01267}01267   \textcolor{keywordflow}{return} nc;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01268}01268 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01269}01269 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01270}01270 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01271}01271 \textcolor{comment}{/* analyze triangles and split or collapse to match gradation */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01272}\mbox{\hyperlink{mmgs1_8c_ac683a19639cdbe4b52d0be1584213dec}{01272}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_ac683a19639cdbe4b52d0be1584213dec}{adptri}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int* permNodGlob) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01273}01273   \textcolor{keywordtype}{int}         it,maxit;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01274}01274   int64\_t     nnc,nns,nnf,nnm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01275}01275   MMG5\_int    nc,ns,nf,nm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01276}01276 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01277}01277   \textcolor{comment}{/* iterative mesh modifications */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01278}01278   it = nnc = nns = nnf = nnm = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01279}01279   maxit = 10;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01280}01280   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01281}01281     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a7acd0480162265e5e18557dbff01b008}{noinsert}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01282}01282       ns = \mbox{\hyperlink{mmgs1_8c_a8c4b0cb108ef9ffa7f88d314a219ba7e}{adpspl}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01283}01283       \textcolor{keywordflow}{if} ( ns < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01284}01284         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to complete mesh. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01285}01285         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01286}01286       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01287}01287 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01288}01288       \textcolor{comment}{/* renumbering if available and needed */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01289}01289       \textcolor{keywordflow}{if} ( it==1 \&\& !\mbox{\hyperlink{librnbg_8c_aba0725242dda8f86a5fad61f769d6dd4}{MMG5\_scotchCall}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,NULL,permNodGlob) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01290}01290         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01291}01291 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01292}01292       nc = \mbox{\hyperlink{mmgs1_8c_ae8be0691345b57d115b1a67b109e4b41}{adpcol}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01293}01293       \textcolor{keywordflow}{if} ( nc < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01294}01294         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to complete mesh. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01295}01295         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01296}01296       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01297}01297     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01298}01298     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01299}01299       ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01300}01300       nc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01301}01301     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01302}01302 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01303}01303     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a36af167c34f2a00b183e819d3178d627}{noswap}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01304}01304       nf = \mbox{\hyperlink{mmgs1_8c_a562dcf0a1478904e0f0bc3e49e5fb1eb}{swpmsh}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,2);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01305}01305       \textcolor{keywordflow}{if} ( nf < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01306}01306         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to improve mesh. Exiting.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01307}01307         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01308}01308       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01309}01309     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01310}01310     \textcolor{keywordflow}{else}  nf = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01311}01311 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01312}01312     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a9f37862a1a9afb4333fe095e623a7f2f}{nomove}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01313}01313       nm = \mbox{\hyperlink{mmgs1_8c_a1b0e36dc703af0990adc006b5c0e412b}{movtri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,1);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01314}01314       \textcolor{keywordflow}{if} ( nm < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01315}01315         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to improve mesh. Exiting.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01316}01316         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01317}01317       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01318}01318     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01319}01319     \textcolor{keywordflow}{else}  nm = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01320}01320 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01321}01321     nnc += nc;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01322}01322     nns += ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01323}01323     nnf += nf;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01324}01324     nnm += nm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01325}01325     \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& ns+nc+nf+nm > 0 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01326}01326       fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} splitted, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} collapsed, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} swapped, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} moved\(\backslash\)n"{}},ns,nc,nf,nm);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01327}01327     \textcolor{keywordflow}{if} ( ns < 10 \&\& MMG5\_abs(nc-\/ns) < 3 )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01328}01328     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( it > 3 \&\& MMG5\_abs(nc-\/ns) < 0.3 * \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(nc,ns) )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01329}01329   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01330}01330   \textcolor{keywordflow}{while}( ++it < maxit \&\& nc+ns > 0 );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01331}01331 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01332}01332   \textcolor{comment}{/* renumbering if available */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01333}01333   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{librnbg_8c_aba0725242dda8f86a5fad61f769d6dd4}{MMG5\_scotchCall}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,NULL,permNodGlob) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01334}01334     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01335}01335 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01336}01336   \textcolor{comment}{/*shape optim*/}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01337}01337   it  = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01338}01338   maxit = 2;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01339}01339   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01340}01340 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01341}01341     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a9f37862a1a9afb4333fe095e623a7f2f}{nomove}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01342}01342       nm = \mbox{\hyperlink{mmgs1_8c_a1b0e36dc703af0990adc006b5c0e412b}{movtri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,5);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01343}01343       \textcolor{keywordflow}{if} ( nm < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01344}01344         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to improve mesh.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01345}01345         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01346}01346       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01347}01347       nnm += nm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01348}01348     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01349}01349     \textcolor{keywordflow}{else}  nm = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01350}01350 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01351}01351     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a36af167c34f2a00b183e819d3178d627}{noswap}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01352}01352       nf = \mbox{\hyperlink{mmgs1_8c_a562dcf0a1478904e0f0bc3e49e5fb1eb}{swpmsh}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,2);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01353}01353       \textcolor{keywordflow}{if} ( nf < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01354}01354         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to improve mesh. Exiting.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01355}01355         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01356}01356       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01357}01357       nnf += nf;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01358}01358     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01359}01359     \textcolor{keywordflow}{else}  nf = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01360}01360 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01361}01361     \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& nf+nm > 0 )\{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01362}01362       fprintf(stdout,\textcolor{stringliteral}{"{}                                            "{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01363}01363       fprintf(stdout,\textcolor{stringliteral}{"{}\%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} swapped, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} moved\(\backslash\)n"{}},nf,nm);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01364}01364     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01365}01365   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01366}01366   \textcolor{keywordflow}{while}( ++it < maxit \&\& nm+nf > 0 );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01367}01367 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01368}01368   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a9f37862a1a9afb4333fe095e623a7f2f}{nomove}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01369}01369     nm = \mbox{\hyperlink{mmgs1_8c_a1b0e36dc703af0990adc006b5c0e412b}{movtri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,5);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01370}01370     \textcolor{keywordflow}{if} ( nm < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01371}01371       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to improve mesh.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01372}01372       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01373}01373     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01374}01374   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01375}01375   \textcolor{keywordflow}{else}  nm = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01376}01376   nnm += nm;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01377}01377   \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& nm > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01378}01378     fprintf(stdout,\textcolor{stringliteral}{"{}                                                              \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} moved\(\backslash\)n"{}},nm);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01379}01379   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01380}01380 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01381}01381   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01382}01382     \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) < 5 \&\& (nnc > 0 || nns > 0) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01383}01383       fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} PRId64 \textcolor{stringliteral}{"{} splitted, \%8"{}} PRId64 \textcolor{stringliteral}{"{} collapsed, \%8"{}} PRId64 \textcolor{stringliteral}{"{} swapped, \%8"{}} PRId64 \textcolor{stringliteral}{"{} moved, \%d iter. \(\backslash\)n"{}},nns,nnc,nnf,nnm,it);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01384}01384   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01385}01385   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01386}01386 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01387}01387 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01388}01388 \textcolor{comment}{/* analyze tetrahedra and split if needed */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01389}\mbox{\hyperlink{mmgs1_8c_a699316c829572399f5af3fa96a1bac8c}{01389}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a699316c829572399f5af3fa96a1bac8c}{anatri}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,int8\_t typchk) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01390}01390   MMG5\_int     nc,ns,nf,nnc,nns,nnf;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01391}01391   \textcolor{keywordtype}{int}          it,maxit;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01392}01392 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01393}01393   \textcolor{comment}{/* analyze tetras : initial splitting */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01394}01394   nns = nnc = nnf = it = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01395}01395   maxit = 5;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01396}01396   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01397}01397     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a7acd0480162265e5e18557dbff01b008}{noinsert}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01398}01398       \textcolor{comment}{/* memory free */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01399}01399       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01400}01400       \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}} = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01401}01401 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01402}01402       \textcolor{comment}{/* analyze surface */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01403}01403       ns = \mbox{\hyperlink{mmgs1_8c_a5e4d37e6ba429429a6625e1665572a4b}{anaelt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,typchk);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01404}01404       \textcolor{keywordflow}{if} ( ns < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01405}01405         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to complete surface mesh. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01406}01406         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01407}01407       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01408}01408 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01409}01409       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{hash__s_8c_a1233a38bc6805c4e74e00b61500a42b9}{MMGS\_hashTria}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01410}01410         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Hashing problem. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01411}01411         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01412}01412       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01413}01413 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01414}01414       \textcolor{comment}{/* collapse short edges */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01415}01415       nc = \mbox{\hyperlink{mmgs1_8c_a60f6083cf0f75f12773939e3410cb31d}{colelt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,typchk);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01416}01416       \textcolor{keywordflow}{if} ( nc < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01417}01417         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to collapse mesh. Exiting.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01418}01418         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01419}01419       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01420}01420     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01421}01421     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01422}01422       ns = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01423}01423       nc = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01424}01424     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01425}01425 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01426}01426     \textcolor{comment}{/* attempt to swap */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01427}01427     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a36af167c34f2a00b183e819d3178d627}{noswap}} ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01428}01428       nf = \mbox{\hyperlink{mmgs1_8c_a562dcf0a1478904e0f0bc3e49e5fb1eb}{swpmsh}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,typchk);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01429}01429       \textcolor{keywordflow}{if} ( nf < 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01430}01430         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to improve mesh. Exiting.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01431}01431         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01432}01432       \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01433}01433     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01434}01434     \textcolor{keywordflow}{else} nf = 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01435}01435 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01436}01436     nnc += nc;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01437}01437     nns += ns;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01438}01438     nnf += nf;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01439}01439     \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& ns+nc > 0 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01440}01440       fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} splitted, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} collapsed, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} swapped\(\backslash\)n"{}},ns,nc,nf);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01441}01441     \textcolor{keywordflow}{if} ( it > 3 \&\& MMG5\_abs(nc-\/ns) < 0.1 * \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(nc,ns) )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01442}01442   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01443}01443   \textcolor{keywordflow}{while} ( ++it < maxit \&\& ns+nc+nf > 0 );}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01444}01444 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01445}01445   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01446}01446     \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) < 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} ) \&\& nns+nnc > 0 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01447}01447       fprintf(stdout,\textcolor{stringliteral}{"{}     \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} splitted, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} collapsed, \%8"{}} MMG5\_PRId \textcolor{stringliteral}{"{} swapped, \%d iter.\(\backslash\)n"{}},nns,nnc,nnf,it);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01448}01448   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01449}01449 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01450}01450   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01451}01451 \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01452}01452 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01462}\mbox{\hyperlink{libmmgs__private_8h_a8fc263e718ed28c794713a7c0370042f}{01462}} \textcolor{keywordtype}{int} \mbox{\hyperlink{mmgs1_8c_a1b5d39f52fe2cdac020f3d8bbaf9d8c0}{MMG5\_mmgs1}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int *permNodGlob) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01463}01463 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01464}01464   \textcolor{comment}{/* renumbering if available */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01465}01465   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01466}01466     fprintf(stdout,\textcolor{stringliteral}{"{}  ** MESH ANALYSIS\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01467}01467 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01468}01468   \textcolor{comment}{/*-\/-\/-\/ stage 1: geometric mesh */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01469}01469   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01470}01470     fprintf(stdout,\textcolor{stringliteral}{"{}  ** GEOMETRIC MESH\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01471}01471 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01472}01472   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgs1_8c_a699316c829572399f5af3fa96a1bac8c}{anatri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,1) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01473}01473     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to split mesh-\/> Exiting.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01474}01474     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01475}01475   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01476}01476 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01477}01477   \textcolor{comment}{/* Debug: export variable MMG\_SAVE\_ANATRI1 to save adapted mesh at the end of}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01478}01478 \textcolor{comment}{   * anatri wave */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01479}01479   \textcolor{keywordflow}{if} ( getenv(\textcolor{stringliteral}{"{}MMG\_SAVE\_ANATRI1"{}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01480}01480     printf(\textcolor{stringliteral}{"{}  \#\# WARNING: EXIT AFTER ANATRI-\/1."{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01481}01481            \textcolor{stringliteral}{"{} (MMG\_SAVE\_ANATRI1 env variable is exported).\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01482}01482     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01483}01483   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01484}01484 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01485}01485   \textcolor{comment}{/* renumbering if available */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01486}01486   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{librnbg_8c_aba0725242dda8f86a5fad61f769d6dd4}{MMG5\_scotchCall}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,NULL,permNodGlob) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01487}01487     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01488}01488 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01489}01489   \textcolor{comment}{/*-\/-\/-\/ stage 2: computational mesh */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01490}01490   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01491}01491     fprintf(stdout,\textcolor{stringliteral}{"{}  ** COMPUTATIONAL MESH\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01492}01492 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01493}01493   \textcolor{comment}{/* define metric map */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01494}01494   \textcolor{keywordflow}{if} ( !MMGS\_defsiz(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01495}01495     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Metric undefined. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01496}01496     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01497}01497   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01498}01498 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01499}01499  \textcolor{comment}{/* Debug: export variable MMG\_SAVE\_DEFSIZ to save adapted mesh at the end of}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01500}01500 \textcolor{comment}{   * anatet wave */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01501}01501   \textcolor{keywordflow}{if} ( getenv(\textcolor{stringliteral}{"{}MMG\_SAVE\_DEFSIZ"{}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01502}01502     printf(\textcolor{stringliteral}{"{}  \#\# WARNING: EXIT AFTER DEFSIZ."{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01503}01503            \textcolor{stringliteral}{"{} (MMG\_SAVE\_DEFSIZ env variable is exported).\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01504}01504     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01505}01505   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01506}01506 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01507}01507   \mbox{\hyperlink{isosiz_8c_a17983471b35e1479e8a132192cc7b223}{MMG5\_gradation\_info}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01508}01508   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a61dba6868b2752cab22a2dc59d2e8104}{hgrad}} > 0. ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01509}01509      \textcolor{keywordflow}{if} (!MMGS\_gradsiz(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01510}01510       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Gradation problem. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01511}01511       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01512}01512     \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01513}01513   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01514}01514 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01515}01515   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_ae2e1a6d9ad39421bc8c6113b42f1fe88}{hgradreq}} > 0. ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01516}01516     MMGS\_gradsizreq(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met);}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01517}01517   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01518}01518 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01519}01519   \textcolor{comment}{/* Debug: export variable MMG\_SAVE\_GRADSIZ to save adapted mesh at the end of}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01520}01520 \textcolor{comment}{   * anatet wave */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01521}01521   \textcolor{keywordflow}{if} ( getenv(\textcolor{stringliteral}{"{}MMG\_SAVE\_GRADSIZ"{}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01522}01522     printf(\textcolor{stringliteral}{"{}  \#\# WARNING: EXIT AFTER GRADSIZ."{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01523}01523            \textcolor{stringliteral}{"{} (MMG\_SAVE\_GRADSIZ env variable is exported).\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01524}01524     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01525}01525   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01526}01526 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01527}01527   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgs1_8c_a699316c829572399f5af3fa96a1bac8c}{anatri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,2) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01528}01528     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to proceed adaptation. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01529}01529     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01530}01530   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01531}01531   \textcolor{comment}{/* Debug: export variable MMG\_SAVE\_ANATRI1 to save adapted mesh at the end of}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01532}01532 \textcolor{comment}{   * anatri wave */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01533}01533   \textcolor{keywordflow}{if} ( getenv(\textcolor{stringliteral}{"{}MMG\_SAVE\_ANATRI2"{}}) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01534}01534     printf(\textcolor{stringliteral}{"{}  \#\# WARNING: EXIT AFTER ANATRI-\/2."{}}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01535}01535            \textcolor{stringliteral}{"{} (MMG\_SAVE\_ANATRI2 env variable is exported).\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01536}01536     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01537}01537   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01538}01538 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01539}01539   \textcolor{comment}{/* renumbering if available */}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01540}01540   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{librnbg_8c_aba0725242dda8f86a5fad61f769d6dd4}{MMG5\_scotchCall}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,NULL,permNodGlob) )}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01541}01541     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01542}01542 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01543}01543   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgs1_8c_ac683a19639cdbe4b52d0be1584213dec}{adptri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,permNodGlob) ) \{}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01544}01544     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Unable to adapt. Exit program.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01545}01545     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01546}01546   \}}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01547}01547 }
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01548}01548   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mmgs1_8c_source_l01549}01549 \}}

\end{DoxyCode}
