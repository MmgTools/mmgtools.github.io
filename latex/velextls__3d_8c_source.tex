\hypertarget{velextls__3d_8c_source}{}\doxysection{velextls\+\_\+3d.\+c}
\label{velextls__3d_8c_source}\index{src/mmg3d/velextls\_3d.c@{src/mmg3d/velextls\_3d.c}}
\mbox{\hyperlink{velextls__3d_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00035}00035 \textcolor{preprocessor}{\#ifdef USE\_ELAS}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmg3d__private_8h}{libmmg3d\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00038}00038 \textcolor{preprocessor}{\#include "{}ls\_calls.h"{}}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00040}\mbox{\hyperlink{velextls__3d_8c_a7a399282b9c797b41094beff0f9272d5}{00040}} \textcolor{preprocessor}{\#define MMG5\_DEGTOL    0.75}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00041}\mbox{\hyperlink{velextls__3d_8c_af95cddc625432b0fac3eaeaa9dc506c7}{00041}} \textcolor{preprocessor}{\#define \_LS\_LAMBDA      10.0e5}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00042}\mbox{\hyperlink{velextls__3d_8c_a487e121df6b0d93e78ba41135ca0d1b9}{00042}} \textcolor{preprocessor}{\#define \_LS\_MU          8.2e5}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00043}00043 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00059}\mbox{\hyperlink{velextls__3d_8c_a21834247bb8f5c4a3b30c0500b5f19d0}{00059}} MMG5\_int* \mbox{\hyperlink{velextls__3d_8c_a21834247bb8f5c4a3b30c0500b5f19d0}{MMG5\_packLS}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} disp,LSst *lsst,MMG5\_int *npfin) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00060}00060   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}    pt,pt1;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00061}00061   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}   pxt;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00062}00062   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00063}00063   \textcolor{keywordtype}{double}         u[3];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00064}00064   \textcolor{keywordtype}{int}            n,nlay,ilist,ilisto,ilistck;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00065}00065   MMG5\_int       k,ip,npf,ntf,iel,jel,*perm,*invperm,*adja,*list,vper[4];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00066}00066   \textcolor{keywordtype}{int}            refdirh,refdirnh;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00067}00067   int8\_t         i,j,jface;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00069}00069   \textcolor{comment}{/* LibElas is not compatible with int64: Check for int32 overflow */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00070}00070   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}} > INT\_MAX || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}} > INT\_MAX ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00071}00071     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: impossible to call elasticity library"{}}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00072}00072             \textcolor{stringliteral}{"{} with int64 integers.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00073}00073     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00074}00074   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00076}00076   nlay = 20;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00077}00077   refdirh = 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00078}00078   refdirnh = 1;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00079}00079   npf = 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00080}00080   ntf = 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00081}00081   u[0] = u[1] = u[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00082}00082   *npfin = 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00084}00084   \mbox{\hyperlink{mmgcommon__private_8h_a5119d3bed2b1273e7741600bb22b2088}{MMG5\_ADD\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}+1)*\textcolor{keyword}{sizeof}(MMG5\_int),\textcolor{stringliteral}{"{}element list"{}},\textcolor{keywordflow}{return} NULL);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00085}00085   \mbox{\hyperlink{mmgcommon__private_8h_a08f3c7818d5a7de38d88dd83b622c99f}{MMG5\_SAFE\_CALLOC}}(list,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}+1,MMG5\_int,\textcolor{keywordflow}{return} NULL);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00087}00087   \mbox{\hyperlink{mmgcommon__private_8h_a5119d3bed2b1273e7741600bb22b2088}{MMG5\_ADD\_MEM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}+1)*\textcolor{keyword}{sizeof}(MMG5\_int),\textcolor{stringliteral}{"{}point permutation"{}},\textcolor{keywordflow}{return} NULL);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00088}00088   \mbox{\hyperlink{mmgcommon__private_8h_a08f3c7818d5a7de38d88dd83b622c99f}{MMG5\_SAFE\_CALLOC}}(perm,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}+1,MMG5\_int,\textcolor{keywordflow}{return} NULL);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00090}00090   ilist = ilisto = ilistck = 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00092}00092   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}; k++)}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00093}00093     \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k].\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}} = 0;      \textcolor{comment}{// A faire fusionner avec celui de mmg3d3.c}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00095}00095   \textcolor{comment}{/* Step 1: pile all the tetras containing a triangle with ref DISPREF */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00096}00096   \textcolor{keywordflow}{for}(k=1; k<=mesh-\/>ne; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00097}00097     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00098}00098     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || !pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00099}00099     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00101}00101     \textcolor{keywordflow}{for}(i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00102}00102       \textcolor{keywordflow}{if} ( (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[i] == \mbox{\hyperlink{mmgcommon__private_8h_a3afd9aebb3b91849ebbc7cb48a57527f}{MMG5\_DISPREF}}) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00103}00103         ilist++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00104}00104         list[ilist] = k;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00105}00105         \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}},0);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00107}00107         \textcolor{keywordflow}{for}(j=0; j<4; j++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00108}00108           ip = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[j];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00109}00109           \textcolor{keywordflow}{if} ( !perm[ip] ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00110}00110             npf++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00111}00111             perm[ip] = npf;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00112}00112           \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00113}00113         \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00114}00114         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00115}00115       \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00116}00116     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00117}00117   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00118}00118   \textcolor{keywordflow}{if} ( !npf ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00119}00119     fprintf(stderr,}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00120}00120             \textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: no triangle with reference \%d in the mesh.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00121}00121             \textcolor{stringliteral}{"{}              Nothing to move.\(\backslash\)n"{}},\_\_func\_\_,\mbox{\hyperlink{mmgcommon__private_8h_a3afd9aebb3b91849ebbc7cb48a57527f}{MMG5\_DISPREF}});}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00122}00122     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00123}00123     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00124}00124     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00125}00125   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00127}00127   \textcolor{comment}{/* Step 2: create a layer around these tetras */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00128}00128   \textcolor{keywordflow}{for}(n=0; n<nlay; n++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00129}00129     ilistck = ilisto;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00130}00130     ilisto = ilist;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00132}00132     \textcolor{keywordflow}{for}(k=ilistck+1; k<=ilisto; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00133}00133       iel = list[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00134}00134       adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(iel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00136}00136       \textcolor{keywordflow}{for}(i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00137}00137         jel = adja[i] / 4;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00138}00138         \textcolor{keywordflow}{if} ( !jel ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00139}00139         pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00140}00140         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt1) \&\& (!\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}},0) ) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00141}00141           ilist++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00142}00142           assert( ilist <= mesh-\/>ne );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00143}00143           \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}},0);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00144}00144           list[ilist] = jel;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00146}00146           \textcolor{keywordflow}{for}(j=0; j<4; j++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00147}00147             ip = pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[j];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00148}00148             \textcolor{keywordflow}{if} ( !perm[ip] ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00149}00149               npf++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00150}00150               perm[ip] = npf;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00151}00151             \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00152}00152           \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00153}00153         \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00154}00154       \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00155}00155     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00156}00156   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00158}00158   \textcolor{comment}{/* Creation of the inverse permutation table */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00159}00159   \mbox{\hyperlink{mmgcommon__private_8h_a5119d3bed2b1273e7741600bb22b2088}{MMG5\_ADD\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},(npf+1)*\textcolor{keyword}{sizeof}(MMG5\_int),\textcolor{stringliteral}{"{}permutation table"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00160}00160                   \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00161}00161                   \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00162}00162                   \textcolor{keywordflow}{return} NULL );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00163}00163   \mbox{\hyperlink{mmgcommon__private_8h_a08f3c7818d5a7de38d88dd83b622c99f}{MMG5\_SAFE\_CALLOC}} ( invperm,(npf+1),MMG5\_int,}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00164}00164                       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00165}00165                       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00166}00166                       \textcolor{keywordflow}{return} NULL );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00167}00167 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00168}00168   \textcolor{comment}{/* Step 3: count of the surface triangles in the new mesh}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00169}00169 \textcolor{comment}{     Code for pt-\/>mark : if MG\_GET(pt-\/>mark,0) = in the list}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00170}00170 \textcolor{comment}{     if !MG\_GET(pt-\/>mark,0) = not in the list}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00171}00171 \textcolor{comment}{     if MG\_GET(pt-\/>mark, i+1) : face i has a boundary triangle which has already been counted */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00172}00172   \textcolor{keywordflow}{for}(k=1; k<=ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00173}00173     iel = list[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00174}00174     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00175}00175     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(iel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00176}00176     \textcolor{keywordflow}{if} (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}) pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00178}00178     \textcolor{keywordflow}{for}(i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00179}00179       jel = adja[i] / 4;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00180}00180       jface = adja[i] \% 4;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00181}00181 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00182}00182       \textcolor{comment}{/* Face i carries a non homogeneous Dirichlet BC */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00183}00183       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[i] == \mbox{\hyperlink{mmgcommon__private_8h_a3afd9aebb3b91849ebbc7cb48a57527f}{MMG5\_DISPREF}}) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00184}00184         \textcolor{comment}{/* If this triangle has not been taken into account */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00185}00185         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}},i+1) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00187}00187         ntf++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00188}00188         \textcolor{keywordflow}{if} ( !jel ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00189}00189         pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00190}00190         \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}},jface+1);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00191}00191       \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00192}00192       \textcolor{comment}{/* iel has no neighbour through face i within the list */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00193}00193       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !jel || ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel].\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}} ) ) ntf++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00194}00194     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00195}00195   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00197}00197   \textcolor{comment}{/* Step 4: creation of the mesh for elasticity */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00198}00198   \textcolor{keywordflow}{if} ( !LS\_mesh(lsst,npf,0,ntf,ilist) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00199}00199     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_mesh. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00200}00200             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00201}00201     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00202}00202     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00203}00203     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00204}00204     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00205}00205   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00206}00206 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00207}00207   \textcolor{comment}{/* Set verbosity and debug info */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00208}00208   LS\_setPar(lsst, (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}} > 0), 0);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00210}00210   \textcolor{comment}{/* Step 5: fill the LS mesh */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00211}00211   \textcolor{comment}{/* Add vertices */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00212}00212   \textcolor{keywordflow}{for}(k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00213}00213     ip = perm[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00214}00214     \textcolor{keywordflow}{if} ( !ip ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00216}00216     p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00217}00217     invperm[ip] = k;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00218}00218     \textcolor{keywordflow}{if} ( !LS\_addVer(lsst,ip,p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p0-\/>\mbox{\hyperlink{structMMG5__Point_a9ee09f6dae5e3b5d0ea646f63e1d5bbd}{ref}}) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00219}00219       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_addVer. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00220}00220               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00221}00221       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00222}00222       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00223}00223       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00224}00224       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00225}00225     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00226}00226   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00227}00227 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00228}00228   \textcolor{comment}{/* Add tetrahedra */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00229}00229   \textcolor{keywordflow}{for}(k=1; k<=ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00230}00230     iel = list[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00231}00231     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00233}00233     \textcolor{keywordflow}{for}(i=0; i<4; i++)}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00234}00234       vper[i] = perm[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00235}00235 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00236}00236     \mbox{\hyperlink{API__functionsf__2d_8c_a8fa1e72d65c006f7a41f14c6fd681a9d}{if}} (!LS\_addTet(lsst,(\textcolor{keywordtype}{int})k,(\textcolor{keywordtype}{int}*)vper,0) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00237}00237       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_addTet. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00238}00238               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00239}00239       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00240}00240       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00241}00241       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00242}00242       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00243}00243     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00244}00244   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00246}00246   \textcolor{comment}{/* Add surface triangles */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00247}00247   ntf = 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00248}00248   \textcolor{keywordflow}{for}(k=1; k<=ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00249}00249     iel = list[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00250}00250     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00251}00251     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(iel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00252}00252     \textcolor{keywordflow}{if} (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}) pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00254}00254     \textcolor{keywordflow}{for}(i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00255}00255       jel = adja[i] / 4;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00257}00257       \textcolor{comment}{/* Face i carries a non homogeneous Dirichlet BC */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00258}00258       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[i] == \mbox{\hyperlink{mmgcommon__private_8h_a3afd9aebb3b91849ebbc7cb48a57527f}{MMG5\_DISPREF}}) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00259}00259         \textcolor{comment}{/* If this triangle has not been taken into account */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00260}00260         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}},i+1) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00261}00261         ntf++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00262}00262         \textcolor{keywordflow}{for} (j=0; j<3; j++)}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00263}00263           vper[j] = perm[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[i][j]]];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00265}00265         \mbox{\hyperlink{API__functionsf__2d_8c_a8fa1e72d65c006f7a41f14c6fd681a9d}{if}} ( !LS\_addTri(lsst,(\textcolor{keywordtype}{int})ntf,(\textcolor{keywordtype}{int}*)vper,refdirnh) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00266}00266           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_addTri. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00267}00267                   \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00268}00268           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00269}00269           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00270}00270           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00271}00271           \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00272}00272         \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00273}00273       \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00274}00274       \textcolor{comment}{/* iel has no neighbour through face i within list */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00275}00275       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !jel || (!\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel].\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}}) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00276}00276         ntf++;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00277}00277         \textcolor{keywordflow}{for} (j=0; j<3; j++)}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00278}00278           vper[j] = perm[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[i][j]]];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00280}00280         \mbox{\hyperlink{API__functionsf__2d_8c_a8fa1e72d65c006f7a41f14c6fd681a9d}{if}} ( !LS\_addTri(lsst,(\textcolor{keywordtype}{int})ntf,(\textcolor{keywordtype}{int}*)vper,refdirh) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00281}00281           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_addTri. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00282}00282                   \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00283}00283           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00284}00284           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00285}00285           \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00286}00286           \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00287}00287         \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00288}00288       \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00289}00289     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00290}00290   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00292}00292   \textcolor{keywordflow}{if} ( (abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 4 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}}) \&\& (ilist+npf+ntf > 0) )}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00293}00293     printf(\textcolor{stringliteral}{"{}Number of packed tetra \%d, points \%"{}} MMG5\_PRId}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00294}00294            \textcolor{stringliteral}{"{}, triangles \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{}\(\backslash\)n"{}},ilist,npf,ntf);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00295}00295 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00296}00296   \textcolor{comment}{/* Add boundary conditions */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00297}00297   \textcolor{keywordflow}{if} ( !LS\_setBC(lsst,Dirichlet,refdirnh,\textcolor{charliteral}{'f'},LS\_tri,NULL) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00298}00298     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_set BC. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00299}00299             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00300}00300     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00301}00301     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00302}00302     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00303}00303     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00304}00304   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00305}00305 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00306}00306   \textcolor{keywordflow}{if} ( !LS\_setBC(lsst,Dirichlet,refdirh,\textcolor{charliteral}{'v'},LS\_tri,u) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00307}00307     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_set BC. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00308}00308             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00309}00309     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00310}00310     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00311}00311     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00312}00312     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00313}00313   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00314}00314 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00315}00315   \textcolor{comment}{/* Add materials */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00316}00316   \textcolor{keywordflow}{if} ( !LS\_setLame(lsst,0,\mbox{\hyperlink{velextls__3d_8c_af95cddc625432b0fac3eaeaa9dc506c7}{\_LS\_LAMBDA}},\mbox{\hyperlink{velextls__3d_8c_a487e121df6b0d93e78ba41135ca0d1b9}{\_LS\_MU}}) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00317}00317     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_setLame. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00318}00318             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00319}00319     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00320}00320     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00321}00321     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00322}00322     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00323}00323   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00324}00324 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00325}00325   \textcolor{comment}{/* Transfer displacement */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00326}00326   \textcolor{keywordflow}{if} ( !LS\_newSol(lsst) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00327}00327     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_newSol. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00328}00328             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00329}00329     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00330}00330     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00331}00331     \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00332}00332     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00333}00333   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00334}00334 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00335}00335   \textcolor{keywordflow}{for}(k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00336}00336     ip = perm[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00337}00337     \textcolor{keywordflow}{if} ( !ip ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00338}00338 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00339}00339     \textcolor{keywordflow}{if} ( !LS\_addSol(lsst,ip,\&disp-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[3*k]) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00340}00340       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_addSol. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00341}00341               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00342}00342       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00343}00343       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00344}00344       \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00345}00345       \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00346}00346     \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00347}00347   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00349}00349   *npfin = npf;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00350}00350   \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},list );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00351}00351   \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},perm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00353}00353   \textcolor{keywordflow}{return} invperm;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00354}00354 \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00369}\mbox{\hyperlink{velextls__3d_8c_a43176f8da2a1de6fdd49a4d51b861de9}{00369}} \textcolor{keywordtype}{int} \mbox{\hyperlink{velextls__3d_8c_a43176f8da2a1de6fdd49a4d51b861de9}{MMG5\_unpackLS}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} disp,LSst *lsst,MMG5\_int npf,MMG5\_int *invperm) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00370}00370   \textcolor{keywordtype}{double}     *u;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00371}00371   MMG5\_int   ip,k;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00372}00372   int8\_t     i;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00374}00374   u = LS\_getSol(lsst);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00375}00375 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00376}00376   \textcolor{keywordflow}{for}(k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00377}00377     \textcolor{keywordflow}{for}(i=0; i<3; i++)}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00378}00378       disp-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[3*k+i] = 0.0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00379}00379   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00380}00380 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00381}00381   \textcolor{keywordflow}{for}(k=1; k<=npf; k++) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00382}00382     ip = invperm[k];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00383}00383 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00384}00384     \textcolor{keywordflow}{for}(i=0; i<3; i++)}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00385}00385       disp-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[3*ip+i] = u[3*(k-\/1)+i];}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00386}00386   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00387}00387 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00388}00388   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00389}00389 \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00390}00390 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00400}\mbox{\hyperlink{libmmg3d__private_8h_a29763f9622be6ce61b0dcda8e4a697fa}{00400}} \textcolor{keywordtype}{int} \mbox{\hyperlink{velextls__3d_8c_ad3dfa1003054ebb2566376100684947d}{MMG5\_velextLS}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} disp) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00401}00401   LSst        *lsst;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00402}00402   MMG5\_int    npf,*invperm;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00403}00403 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00404}00404   \textcolor{comment}{/* Creation of the data structure for the submesh */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00405}00405   lsst    = LS\_init(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac70707181547b168ced906589500bde4}{dim}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a6855e354a811ec0c62a1eb6241f5c866}{ver}},P1,1);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00406}00406   invperm = \mbox{\hyperlink{velextls__3d_8c_a21834247bb8f5c4a3b30c0500b5f19d0}{MMG5\_packLS}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},disp,lsst,\&npf);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00408}00408   \textcolor{keywordflow}{if} ( !npf ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00409}00409     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn MMG5\_packLS. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00410}00410             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00411}00411     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00412}00412   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00414}00414   \textcolor{comment}{/* Resolution of the elasticity system on the submesh */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00415}00415   \textcolor{keywordflow}{if} ( !LS\_elastic(lsst) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00416}00416     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: Problem in fn elasti1. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00417}00417             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00418}00418     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00419}00419   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00421}00421   \textcolor{comment}{/* Update of the displacement */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00422}00422   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{velextls__3d_8c_a43176f8da2a1de6fdd49a4d51b861de9}{MMG5\_unpackLS}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},disp,lsst,npf,invperm) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00423}00423     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn MMG5\_unpackLS. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00424}00424             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00425}00425     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00426}00426   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00428}00428   \textcolor{comment}{/* Free memory */}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00429}00429   \mbox{\hyperlink{mmgcommon__private_8h_afcb0359c0182a916e54e9470e5dd7eea}{MMG5\_DEL\_MEM}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, invperm );}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00431}00431   \textcolor{keywordflow}{if} ( !LS\_stop(lsst) ) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00432}00432     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: problem in fn LS\_stop. Exiting.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00433}00433             \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00434}00434     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00435}00435   \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00437}00437   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00438}00438 \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00439}00439 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00445}00445 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00446}00446 \textcolor{keywordtype}{void} MMG3D\_unused\_function(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00447}00447   \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00448}00448 \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00449}00449 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00450}00450 \textcolor{keywordtype}{void} \_\_attribute\_\_((unused)) MMG3D\_unused\_function(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00451}00451   \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00452}00452 \}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00453}00453 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00454}00454 }
\DoxyCodeLine{\Hypertarget{velextls__3d_8c_source_l00455}00455 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
