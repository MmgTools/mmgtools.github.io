\hypertarget{anisomovpt__s_8c_source}{}\doxysection{anisomovpt\+\_\+s.\+c}
\label{anisomovpt__s_8c_source}\index{src/mmgs/anisomovpt\_s.c@{src/mmgs/anisomovpt\_s.c}}
\mbox{\hyperlink{anisomovpt__s_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmgs__private_8h}{libmmgs\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgexterns__private_8h}{mmgexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00049}\mbox{\hyperlink{anisomovpt__s_8c_af31128f60a909c3ddc2ba5dffbc42722}{00049}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisomovpt__s_8c_af31128f60a909c3ddc2ba5dffbc42722}{movintpt\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int *list,\textcolor{keywordtype}{int} ilist) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00050}00050   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}     pt,pt0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00051}00051   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p0,ppt0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00052}00052   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}    pb;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00053}00053   \textcolor{keywordtype}{double}         r[3][3],lispoi[3*\mbox{\hyperlink{mmgcommon__private_8h_a891c73c5a9d1da972ad398df6e9d7f28}{MMG5\_TRIA\_LMAX}}+1],*m0;\textcolor{comment}{//,m[6],mo[6];}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00054}00054   \textcolor{keywordtype}{double}         gv[2],area,detloc,step,lambda[3],o[3],no[3],to[3],uv[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00055}00055   \textcolor{keywordtype}{double}         calold,calnew,caltmp;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00056}00056   MMG5\_int       k,iel,kel,nump,nbeg,nend;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00057}00057   int8\_t         i0,i1,i2,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00058}00058   \textcolor{keyword}{static} \textcolor{keywordtype}{int}     warn=0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00059}00059   \textcolor{keyword}{static} int8\_t  mmgErr0=0,mmgErr1=0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00061}00061   step = 0.1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00063}00063   \textcolor{comment}{/* Make sure ball of point is closed */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00064}00064   iel = list[0] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00065}00065   i0  = list[0] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00066}00066   i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00068}00068   pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00069}00069   nump = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00070}00070   nbeg = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00071}00071   p0   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nump];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00072}00072   m0   = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*nump];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00073}00073   assert( !p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} );}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00075}00075   iel = list[ilist-\/1] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00076}00076   i0  = list[ilist-\/1] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00077}00077   i2  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00079}00079   pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00080}00080   nend = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00081}00081   \textcolor{keywordflow}{if} ( nbeg != nend )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00083}00083   \textcolor{comment}{/* Rotation of the ball of p0 */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00084}00084   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__s_8c_ab2d8e4e151cfbd92fb6696fa067e5cae}{MMGS\_surfballRotation}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,list,ilist,r,lispoi,p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}})  ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00085}00085     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00086}00086   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00090}00090   gv[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00091}00091   gv[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00092}00092 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00093}00093   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00094}00094     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00095}00095     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00096}00096     \textcolor{keywordflow}{if} ( !MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&pb,1) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00098}00098     \textcolor{comment}{/* Compute integral of sqrt(T\string^J(xi)  M(P(xi)) J(xi)) * P(xi) over the triangle */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00099}00099     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisomovpt_8c_a9af878bacdda84894d6e28bb26b6043b}{MMG5\_elementWeight}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt,p0,\&pb,r,gv) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00100}00100       \textcolor{keywordflow}{if} ( !warn ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00101}00101         ++warn;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00102}00102         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: unable to compute optimal position for at least"{}}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00103}00103                 \textcolor{stringliteral}{"{} 1 point.\(\backslash\)n"{}},\_\_func\_\_ );}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00104}00104       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00105}00105       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00106}00106     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00107}00107   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00109}00109   \textcolor{comment}{/* At this point : gv = -\/ gradient of V = direction to follow */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00111}00111   area = lispoi[1]*gv[1] -\/ lispoi[2]*gv[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00112}00112   kel = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00113}00113   \textcolor{keywordflow}{if} ( area >= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00114}00114     \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00115}00115       detloc = gv[0]*lispoi[3*(k+1)+2] -\/ gv[1]*lispoi[3*(k+1)+1]; \textcolor{comment}{/*orientation with respect to p2 */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00116}00116       \textcolor{keywordflow}{if} ( detloc >= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00117}00117         kel = k;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00118}00118         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00119}00119       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00120}00120     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00121}00121     \textcolor{keywordflow}{if} ( k == ilist )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00122}00122   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00123}00123   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00124}00124     \textcolor{keywordflow}{for} (k=ilist-\/1; k>=0; k-\/-\/) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00125}00125       detloc = lispoi[3*k+1]*gv[1] -\/ lispoi[3*k+2]*gv[0]; \textcolor{comment}{//orientation with respect to p2}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00126}00126       \textcolor{keywordflow}{if} ( detloc >= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00127}00127         kel = k;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00128}00128         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00129}00129       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00130}00130     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00131}00131     \textcolor{keywordflow}{if} ( k == -\/1 )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00132}00132   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00134}00134   \textcolor{comment}{/* Sizing of time step : make sure point does not go out corresponding triangle. */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00135}00135   area = -\/ gv[1]*(lispoi[3*(kel+1)+1] -\/ lispoi[3*(kel)+1]) \(\backslash\)}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00136}00136     + gv[0]*(lispoi[3*(kel+1)+2] -\/ lispoi[3*(kel)+2]);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00137}00137   \textcolor{keywordflow}{if} ( fabs(area) < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00138}00138   area = 1.0 / area;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00139}00139   step *= area;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00141}00141   area = lispoi[3*(kel)+1]*(lispoi[3*(kel+1)+2] -\/ lispoi[3*(kel)+2]) \(\backslash\)}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00142}00142     -\/ lispoi[3*(kel)+2 ]*(lispoi[3*(kel+1)+1] -\/ lispoi[3*(kel)+1]);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00143}00143   step *= area;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00144}00144   step = fabs(step);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00145}00145   gv[0] *= step;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00146}00146   gv[1] *= step;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00148}00148   \textcolor{comment}{/* Computation of the barycentric coordinates of the new point in the corresponding triangle. */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00149}00149   area = lispoi[3*kel+1]*lispoi[3*(kel+1)+2] -\/ lispoi[3*kel+2]*lispoi[3*(kel+1)+1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00150}00150   \textcolor{keywordflow}{if} ( area < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00151}00151   area = 1.0 / area;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00152}00152   lambda[1] = lispoi[3*(kel+1)+2]*gv[0] -\/ lispoi[3*(kel+1)+1]*gv[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00153}00153   lambda[2] = -\/lispoi[3*(kel)+2]*gv[0] + lispoi[3*(kel)+1]*gv[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00154}00154   lambda[1]*= (area);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00155}00155   lambda[2]*= (area);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00156}00156   lambda[0] = 1.0 -\/ lambda[1] -\/ lambda[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00159}00159   iel = list[kel] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00160}00160   i0  = list[kel] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00161}00161   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00163}00163   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,\&pb,1);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00164}00164   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00165}00165     \textcolor{keywordflow}{if}( !mmgErr0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00166}00166       mmgErr0 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00167}00167       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: function MMG5\_bezierCP return 0.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00168}00168               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00169}00169     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00170}00170     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00171}00171   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00173}00173   \textcolor{comment}{/* Now, for Bezier interpolation, one should identify which of i,i1,i2 is 0,1,2}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00174}00174 \textcolor{comment}{     recall uv[0] = barycentric coord associated to pt-\/>v[1], uv[1] associated to pt-\/>v[2] */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00175}00175   \textcolor{keywordflow}{if} ( i0 == 0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00176}00176     uv[0] = lambda[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00177}00177     uv[1] = lambda[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00178}00178   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00179}00179   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( i0 == 1 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00180}00180     uv[0] = lambda[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00181}00181     uv[1] = lambda[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00182}00182   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00183}00183   \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00184}00184     uv[0] = lambda[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00185}00185     uv[1] = lambda[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00186}00186   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00188}00188   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{bezier__s_8c_af28863e323b0285b67041c01f8fbbe2b}{MMGS\_bezierInt}}(\&pb,uv,o,no,to);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00189}00189   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00190}00190     \textcolor{keywordflow}{if}( !mmgErr1 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00191}00191       mmgErr1 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00192}00192       fprintf(stderr,\textcolor{stringliteral}{"{}  \#\# Warning: \%s: function MMGS\_bezierInt return 0.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00193}00193               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00194}00194     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00195}00195     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00196}00196   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00197}00197 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00198}00198   \textcolor{comment}{/* Second test : check whether geometric approximation has not been too much degraded */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00199}00199   ppt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00200}00200   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00201}00201   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00202}00202   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00204}00204   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = no[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00205}00205   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = no[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00206}00206   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = no[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00207}00207   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}  = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00209}00209   \textcolor{comment}{// parallel transport of metric at p0 to new point}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00210}00210   \mbox{\hyperlink{mettools_8c_a997d2af801a2f9f019d7fc5418e1b3fe}{MMG5\_paratmet}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}},m0,o,no,\&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[0]);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00211}00211 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00212}00212   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00213}00213   \textcolor{keywordflow}{for} (k= 0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00214}00214     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00215}00215     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00216}00216     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00217}00217     pt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00218}00218     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}));}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00219}00219     pt0-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i0] = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00221}00221     caltmp = \mbox{\hyperlink{libmmgs__private_8h_a28c818db0497e95d1f8f0ca4554b9e53}{caleltsig\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,iel);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00222}00222     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold,caltmp);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00223}00223     caltmp = \mbox{\hyperlink{libmmgs__private_8h_a28c818db0497e95d1f8f0ca4554b9e53}{caleltsig\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00224}00224     \textcolor{keywordflow}{if} ( caltmp < \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} )  \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00225}00225       \textcolor{comment}{/* We don't check the input triangle qualities, thus we may have a very}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00226}00226 \textcolor{comment}{       * bad triangle in our mesh */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00227}00227       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00228}00228     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00229}00229     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,caltmp);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00231}00231     \textcolor{keywordflow}{if} ( calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00232}00232     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}})  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00233}00233     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < 0.3*calold )      \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00234}00234     \textcolor{comment}{/* if ( chkedg(mesh,0) )  return 0; */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00235}00235   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00237}00237   \textcolor{comment}{/* Finally, update coordinates and normals of point, if new position is accepted :*/}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00238}00238   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00239}00239   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00240}00240   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00241}00241 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00242}00242   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = no[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00243}00243   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = no[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00244}00244   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = no[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00246}00246   memcpy(m0,\&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[0],6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00248}00248   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00249}00249 \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00251}00251 \textcolor{comment}{/* Compute movement of a ref, or ridge point whose ball is passed */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00252}\mbox{\hyperlink{anisomovpt__s_8c_af6aa26f2afe2922a217615167aa57b45}{00252}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisomovpt__s_8c_af6aa26f2afe2922a217615167aa57b45}{movridpt\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int *list,\textcolor{keywordtype}{int} ilist) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00253}00253   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_pTria}}    pt,pt0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00254}00254   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p0,p1,p2,ppt0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00255}00255   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}  go;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00256}00256   \textcolor{keywordtype}{double}        *m0,*m00,step,l1old,l2old,ll1old,ll2old;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00257}00257   \textcolor{keywordtype}{double}        lam0,lam1,lam2,o[3],nn1[3],nn2[3],to[3],mo[6];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00258}00258   \textcolor{keywordtype}{double}        l1new,l2new,calold,calnew;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00259}00259   MMG5\_int      it,it1,it2,ip,ip0,ip1,ip2,k,iel;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00260}00260   int8\_t        voy1,voy2,isrid,isrid1,isrid2,i0,i1,i2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00261}00261   \textcolor{keyword}{static} int8\_t mmgWarn0 = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00263}00263   step  = 0.2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00264}00264   isrid1 = isrid2 = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00265}00265   it1   = it2 = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00266}00266   ip1   = ip2 = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00267}00267   voy1  = voy2 = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00269}00269   \textcolor{comment}{/* First step : make sure 2 ridge edges pass through point, and recoved them,}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00270}00270 \textcolor{comment}{     along with neighbouring triangles */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00271}00271   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00272}00272     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00273}00273     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00274}00274     i1  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00275}00275     i2  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00276}00276     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00278}00278     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i1]) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00279}00279       \textcolor{keywordflow}{if} ( !it1 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00280}00280         it1  = iel;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00281}00281         ip1  = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]; \textcolor{comment}{// edge(i1) = (p0p2)}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00282}00282         voy1 = i1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00283}00283         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i1] \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} )  isrid1 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00284}00284       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00285}00285       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( it1 \&\& !it2 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00286}00286         \textcolor{keywordflow}{if} ( ip1 != pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2] ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00287}00287           it2  = iel;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00288}00288           ip2  = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2]; \textcolor{comment}{// edge(i1) = (p0p2)}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00289}00289           voy2 = i1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00290}00290           \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i1] \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} )  isrid2 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00291}00291         \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00292}00292       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00293}00293       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( it1 \&\& it2 \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2] != ip1) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i2] != ip2) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00294}00294         \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00295}00295           mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00296}00296           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 point at the"{}}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00297}00297                   \textcolor{stringliteral}{"{} intersection of 3 ridge edges\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00298}00298         \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00299}00299         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00300}00300       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00301}00301     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00303}00303     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i2]) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00304}00304       \textcolor{keywordflow}{if} ( !it1 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00305}00305         it1  = iel;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00306}00306         ip1  = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]; \textcolor{comment}{// edge(i2) = (p0p1)}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00307}00307         voy1 = i2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00308}00308         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i2] \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} )  isrid1 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00309}00309       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00310}00310       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( it1 \&\& !it2 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00311}00311         \textcolor{keywordflow}{if} ( ip1 != pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1] ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00312}00312           it2  = iel;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00313}00313           ip2  = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1]; \textcolor{comment}{// edge(i1) = (p0p2)}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00314}00314           voy2 = i2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00315}00315           \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[i2] \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} )  isrid2 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00316}00316         \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00317}00317       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00318}00318       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( it1 \&\& it2 \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1] != ip1) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i1] != ip2) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00319}00319         \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00320}00320           mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00321}00321           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 point at the"{}}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00322}00322                   \textcolor{stringliteral}{"{} intersection of 3 ridge edges\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00323}00323         \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00324}00324         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00325}00325       \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00326}00326     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00327}00327   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00329}00329   \textcolor{comment}{/* Second step : compute lengths of edges (p0p1),(p0p2) */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00330}00330   iel = list[0] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00331}00331   i0  = list[0] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00332}00332   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00333}00333   ip0 = pt-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00334}00334   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00335}00335   p1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00336}00336   p2  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00337}00337   m0  = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*ip0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00338}00338 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00339}00339   l1old = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ip0,ip1,1);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00340}00340   l2old = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ip0,ip2,1);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00341}00341 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00342}00342   \textcolor{keywordflow}{if} ( (!l1old) || (!l2old) ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00344}00344   \textcolor{keywordflow}{if} ( l1old < l2old ) \{ \textcolor{comment}{//move towards p2}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00345}00345     ip    = ip2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00346}00346     isrid = isrid2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00347}00347     it    = it2;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00348}00348   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00349}00349   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00350}00350     ip    = ip1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00351}00351     isrid = isrid1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00352}00352     it    = it1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00353}00353   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00355}00355   \textcolor{comment}{/* Third step : infer arc length of displacement, parameterized over edges */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00356}00356   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmgs__private_8h_ab503f764513a0792a46d05187fc1e76d}{MMGS\_paramDisp}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},it,isrid,ip0,ip,step,o) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00357}00357     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00358}00358   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00359}00359 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00360}00360   \textcolor{comment}{/* check whether proposed move is admissible uner consideration of distances */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00361}00361   \textcolor{comment}{/* Normal and tangent vector updates */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00362}00362   lam0 = (1.0-\/step)*(1.0-\/step);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00363}00363   lam1 = 2.0*step*(1.0-\/step);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00364}00364   lam2 = step*step;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00366}00366   \textcolor{comment}{/* Move is made towards p2 */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00367}00367   ll1old = l1old*l1old;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00368}00368   ll2old = l2old*l2old;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00369}00369 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00370}00370   \textcolor{keywordflow}{if} ( l2old > l1old ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00371}00371     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmgs__private_8h_a18a4e5e1f352340028176ed49a0feb13}{MMGS\_moveTowardPoint}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,p2,ll2old,lam0,lam1,lam2,nn1,nn2,to) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00372}00372       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00373}00373     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00375}00375     \textcolor{comment}{/* Interpolation of metric between ip0 and ip2 */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00376}00376     \textcolor{keywordflow}{if} ( isrid ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00377}00377       \textcolor{keywordflow}{if}(!\mbox{\hyperlink{intmet_8c_abe31c2406aeecd6b3ffbd8ec8dfa30e4}{MMG5\_intridmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it2].\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[voy2]],}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00378}00378                           \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it2].\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[voy2]],(1.0-\/step),nn1,mo))}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00379}00379         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00380}00380     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00381}00381     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00382}00382       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mettools_8c_a997d2af801a2f9f019d7fc5418e1b3fe}{MMG5\_paratmet}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}},m0,o,nn1,mo) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00383}00383     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00384}00384   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00386}00386   \textcolor{comment}{/* Move along p1 */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00387}00387   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00388}00388     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmgs__private_8h_a18a4e5e1f352340028176ed49a0feb13}{MMGS\_moveTowardPoint}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,p1,ll1old,lam0,lam1,lam2,nn1,nn2,to) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00389}00389       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00390}00390     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00392}00392     \textcolor{comment}{/* Interpolation of metric between ip0 and ip1 */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00393}00393     \textcolor{keywordflow}{if} ( isrid ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00394}00394       \mbox{\hyperlink{intmet_8c_abe31c2406aeecd6b3ffbd8ec8dfa30e4}{MMG5\_intridmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it1].\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[voy1]],}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00395}00395                       \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[it1].\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[voy1]],(1.0-\/step),nn1,mo);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00396}00396     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00397}00397     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00398}00398       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mettools_8c_a997d2af801a2f9f019d7fc5418e1b3fe}{MMG5\_paratmet}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}},p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}},m0,o,nn1,mo) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00399}00399     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00400}00400   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00401}00401 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00402}00402   \textcolor{comment}{/* Check proposed motion */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00403}00403   ppt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00404}00404   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00405}00405   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} = p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}};}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00406}00406 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00407}00407   go = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00408}00408   go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0] = nn1[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00409}00409   go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1] = nn1[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00410}00410   go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2] = nn1[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00412}00412   \textcolor{keywordflow}{if} ( isrid ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00413}00413     go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0] = nn2[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00414}00414     go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1] = nn2[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00415}00415     go-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2] = nn2[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00416}00416   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00418}00418   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00419}00419   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00420}00420   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00421}00421 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00422}00422   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = to[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00423}00423   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = to[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00424}00424   ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = to[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00426}00426   m00 = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00427}00427   memcpy(m00,mo,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00428}00428 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00429}00429   \textcolor{comment}{/* Check whether proposed move is admissible under consideration of distances */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00430}00430   l1new = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0,ip1,1);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00431}00431   l2new = MMG5\_lenSurfEdg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0,ip2,1);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00432}00432 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00433}00433   \textcolor{keywordflow}{if} ( (!l1new) || (!l2new) ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00434}00434 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00435}00435   \textcolor{keywordflow}{if} ( fabs(l2new -\/l1new) >= fabs(l2old -\/l1old) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00436}00436     ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00437}00437     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00438}00438   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00440}00440   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00441}00441     iel = list[k] / 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00442}00442     i0  = list[k] \% 3;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00443}00443     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[iel];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00444}00444     pt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac316cb685f82f5bae1d52eea1cd5629b}{tria}}[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00445}00445     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}));}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00446}00446     pt0-\/>\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i0] = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00447}00447 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00448}00448     calold = \mbox{\hyperlink{libmmgs__private_8h_a28c818db0497e95d1f8f0ca4554b9e53}{caleltsig\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,iel);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00449}00449     calnew = \mbox{\hyperlink{libmmgs__private_8h_a28c818db0497e95d1f8f0ca4554b9e53}{caleltsig\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00450}00450     \textcolor{keywordflow}{if} ( (calnew < 0.001) \&\& (calnew<calold) ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00451}00451       ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00452}00452       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00453}00453     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00454}00454     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < 0.3*calold ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00455}00455       ppt0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} = 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00456}00456       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00457}00457     \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00458}00458     \textcolor{comment}{/* if ( chkedg(mesh,0) )  return 0;*/}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00459}00459   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00460}00460 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00461}00461   \textcolor{comment}{/* Coordinates, normals, tangents update */}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00462}00462   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] = o[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00463}00463   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] = o[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00464}00464   p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] = o[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00465}00465 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00466}00466   \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0] = nn1[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00467}00467   \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[1] = nn1[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00468}00468   \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[2] = nn1[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00470}00470   \textcolor{keywordflow}{if} ( isrid ) \{}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00471}00471     \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0] = nn2[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00472}00472     \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[1] = nn2[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00473}00473     \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[2] = nn2[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00474}00474   \}}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00475}00475 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00476}00476   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0] = to[0];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00477}00477   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[1] = to[1];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00478}00478   p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[2] = to[2];}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00479}00479   memcpy(m0,mo,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00480}00480 }
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00481}00481   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisomovpt__s_8c_source_l00482}00482 \}}

\end{DoxyCode}
