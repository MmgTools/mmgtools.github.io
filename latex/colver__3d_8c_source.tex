\hypertarget{colver__3d_8c_source}{}\doxysection{colver\+\_\+3d.\+c}
\label{colver__3d_8c_source}\index{src/mmg3d/colver\_3d.c@{src/mmg3d/colver\_3d.c}}
\mbox{\hyperlink{colver__3d_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{inlined__functions__3d__private_8h}{inlined\_functions\_3d\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmg3dexterns__private_8h}{mmg3dexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00039}00039 \textcolor{keyword}{extern} int8\_t  \mbox{\hyperlink{colver__3d_8c_ab5450ef31db0c3c4df4c9f370b3a791a}{ddb}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00043}\mbox{\hyperlink{colver__3d_8c_abd1766c81a4b5209dfbb7d8212c22707}{00043}} \textcolor{keywordtype}{int} \mbox{\hyperlink{colver__3d_8c_abd1766c81a4b5209dfbb7d8212c22707}{MMG5\_chkcol\_int}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int k,int8\_t iface,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00044}00044                     int8\_t iedg,int64\_t *list,\textcolor{keywordtype}{int} ilist,int8\_t typchk) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00045}00045   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt,pt0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00046}00046   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00047}00047   \textcolor{keywordtype}{double}        calold,calnew,caltmp,ll,lon;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00048}00048   MMG5\_int      j,iel,nq,nr;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00049}00049   int8\_t        i,jj,ip,iq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00051}00051   iq  = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[iedg]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00052}00052   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00053}00053   pt0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00054}00054   nq  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00056}00056   lon = 1.6;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00057}00057   \textcolor{keywordflow}{if} ( typchk == 2 \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00058}00058     lon = MMG5\_lenedg(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iface][iedg],pt);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00060}00060     \textcolor{keywordflow}{if} ( !lon ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00061}00061     \textcolor{comment}{/*on cherche a se rapprocher de 1*/}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00062}00062     \textcolor{comment}{//lon = MG\_MAX(0.8/lon,1.6);// test ok but less good than the next one}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00063}00063     lon = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(2.-\/lon,1.6);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00064}00064   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00066}00066   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00067}00067   \textcolor{keywordflow}{for} (j=0; j<ilist; j++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00068}00068     iel = list[j] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00069}00069     ip  = list[j] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00070}00070     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00072}00072     \textcolor{comment}{/* exclude elements from shell */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00073}00073     \textcolor{keywordflow}{for} (jj=0; jj<4; jj++)  \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[jj] == nq )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00074}00074     \textcolor{keywordflow}{if} ( jj < 4 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00075}00075     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00076}00076     \textcolor{comment}{/* Update edges tag for pt0 (needed by lenedg). */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00078}00078     \textcolor{comment}{/* prevent from recreating internal edge between boundaries */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00079}00079     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_afbff0a58e26e6ef7c1b8b3e0e00b132a}{fem}}==typchk ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00080}00080       p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00081}00081       \textcolor{keywordflow}{if} ( (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& !(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a3ce2c9eede0b495fb73c8d1993ed965c}{MG\_PARBDY}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00082}00082         i = ip;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00083}00083         \textcolor{keywordflow}{for} (jj=0; jj<3; jj++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00084}00084           i = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00085}00085           p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00086}00086           \textcolor{keywordflow}{if} ( (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& !(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a3ce2c9eede0b495fb73c8d1993ed965c}{MG\_PARBDY}}) )\{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00087}00087             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00088}00088           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00089}00089         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00091}00091         \textcolor{comment}{/* Prevent from creating a tetra with 4 bdy vertices */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00092}00092         \textcolor{comment}{// Algiane (2022) this test is useless I think (because we forbid the}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00093}00093         \textcolor{comment}{// creation of internal edges between boundary points)}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00094}00094 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00095}00095         i  = ip;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00096}00096         nr = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00097}00097         \textcolor{keywordflow}{for} (jj=0; jj<3; jj++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00098}00098           i = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00099}00099           p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00100}00100           \textcolor{keywordflow}{if} ( (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& !(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a3ce2c9eede0b495fb73c8d1993ed965c}{MG\_PARBDY}}) ) ++nr;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00101}00101         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00102}00102         \textcolor{keywordflow}{if} ( nr==3 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00103}00103           assert ( 0 \&\& \textcolor{stringliteral}{"{}Uncomment this test, it is not useless"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00104}00104           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00105}00105         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00106}00106 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00107}00107       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00108}00108     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00109}00109     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00110}00110       \textcolor{comment}{/* In aniso : prevent from creating a tetra with 4 ridges vertices or}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00111}00111 \textcolor{comment}{       * internal edges between two ridges (unable to split it after because of}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00112}00112 \textcolor{comment}{       * the ridge metric) */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00113}00113       \textcolor{keywordflow}{if} ( met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}}==6 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00114}00114         p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00116}00116         \textcolor{keywordflow}{if} ( (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}}) \&\& !\mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00117}00117           i = ip;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00118}00118           \textcolor{keywordflow}{for} (jj=0; jj<3; jj++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00119}00119             i = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00120}00120             p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00121}00121             \textcolor{keywordflow}{if} ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} \&\& !\mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00122}00122               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00123}00123             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00124}00124           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00125}00125 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00126}00126           \textcolor{comment}{// Algiane (2022) this test is useless because we forbid the creation of}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00127}00127           \textcolor{comment}{// internal edges between boundary points but we can keep it in case we}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00128}00128           \textcolor{comment}{// comment the previous test}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00129}00129 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00130}00130           i  = ip;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00131}00131           nr = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00132}00132           \textcolor{keywordflow}{for} (jj=0; jj<3; jj++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00133}00133             i = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00134}00134             p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00135}00135             \textcolor{keywordflow}{if} ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} \&\& !\mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00136}00136               ++nr;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00137}00137             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00138}00138           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00139}00139           \textcolor{keywordflow}{if} ( nr==3 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00140}00140             assert ( 0 \&\& \textcolor{stringliteral}{"{}Uncomment this test, it is not useless"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00141}00141             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00142}00142           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00143}00143 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00144}00144         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00145}00145       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00146}00146     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00148}00148     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip] = nq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00150}00150     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold,pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00151}00151     \textcolor{keywordflow}{if} ( typchk==1 \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}} > 1 )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00152}00152       caltmp = \mbox{\hyperlink{libmmg3d__private_8h_a9ca1aba7ffb80ae15c740d63be629f7c}{MMG5\_caltet33\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt0);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00153}00153     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00154}00154       caltmp = \mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00156}00156     \textcolor{keywordflow}{if} ( caltmp < \mbox{\hyperlink{mmgcommon__private_8h_a80cb4724e6dc20a024e2b27dd47508da}{MMG5\_NULKAL}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00157}00157     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,caltmp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00158}00158     \textcolor{comment}{/* check length */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00159}00159     \textcolor{keywordflow}{if} ( typchk == 2 \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00160}00160       \textcolor{keywordflow}{for} (jj=0; jj<6; jj++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00161}00161         \textcolor{comment}{/* Rough evaluation of edge length (doesn't take into account if some of}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00162}00162 \textcolor{comment}{         * the modified edges of pt0 are boundaries): for a more precise}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00163}00163 \textcolor{comment}{         * computation, we need to update the edge tags of pt0.  */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00164}00164         ll = MMG5\_lenedgspl(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,jj,pt0);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00165}00165         \textcolor{keywordflow}{if} ( (!ll) || (ll > lon) )\textcolor{comment}{//LOPTL too small, we need to put greater than 1.41}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00166}00166           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00167}00167       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00168}00168     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00169}00169   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00170}00170   \textcolor{keywordflow}{if} ( calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00171}00171   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} || calnew < 0.3*calold )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00173}00173   \textcolor{keywordflow}{return} ilist;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00174}00174 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00192}00192 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00193}\mbox{\hyperlink{colver__3d_8c_af0168755e4adf3d5442862c407bdc9f3}{00193}} MMG5\_int \mbox{\hyperlink{colver__3d_8c_af0168755e4adf3d5442862c407bdc9f3}{MMG3D\_unfold\_shell}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}}  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int start,MMG5\_int end, MMG5\_int na, MMG5\_int nb,MMG5\_int piv,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00194}00194                        MMG5\_int *iel,int8\_t *iopp) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00195}00195   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}  pt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00196}00196   MMG5\_int     adj,*adja;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00197}00197   int8\_t       i,ipiv,isface;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00199}00199   adj = start;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00200}00200   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00201}00201     *iel  = adj;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00202}00202     pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[*iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00203}00203     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(*iel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00204}00204 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00205}00205     \textcolor{comment}{/* Identification of edge number in tetra iel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00206}00206     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{boulep__3d_8c_a53d91bf065c84f3721527a80d4a8a628}{MMG3D\_findEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,*iel,na,nb,1,NULL,\&i) ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00208}00208     \textcolor{comment}{/* set sense of travel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00209}00209     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ] == piv ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00210}00210       adj  = adja[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00211}00211       ipiv = \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00212}00212       *iopp = \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00213}00213       piv  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ipiv];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00214}00214     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00215}00215     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00216}00216       adj  = adja[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1] ] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00217}00217       ipiv = \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00218}00218       *iopp = \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00219}00219       piv  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ipiv];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00220}00220     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00221}00221 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00222}00222     isface = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00223}00223     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00224}00224       isface = (\mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} \& \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[*iopp]);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00225}00225     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00226}00226   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00227}00227   \textcolor{keywordflow}{while} ( adj \&\& ( adj != end ) \&\& !isface );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00229}00229   \textcolor{keywordflow}{return} piv;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00230}00230 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00231}00231 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00250}00250 \textcolor{keyword}{static} \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00251}\mbox{\hyperlink{colver__3d_8c_a459f9bf58c5963a2ab3cab51eb7977fd}{00251}} \mbox{\hyperlink{colver__3d_8c_a459f9bf58c5963a2ab3cab51eb7977fd}{MMG5\_topchkcol\_bdy}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int k,\textcolor{keywordtype}{int} iface,int8\_t iedg,MMG5\_int *lists,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00252}00252                     \textcolor{keywordtype}{int} ilists) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00253}00253   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00254}00254   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}  pxt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00255}00255   \textcolor{keywordtype}{double}        n0[3],n1[3],devnew;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00256}00256   MMG5\_int      nump,numq,iel,jel,jel1,nap,nbp,naq,nbq,nro;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00257}00257   int8\_t        ip,iq,iopp,i,j,j1,jface,jface1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00259}00259   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00260}00260   ip = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[iedg]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00261}00261   iq = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[iedg]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00262}00262   nump = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00263}00263   numq = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00265}00265   \textcolor{comment}{/* Surface ball has been enumerated as f1,...,f2 -\/ f1,f2 = both triangles of}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00266}00266 \textcolor{comment}{   * surface shell, point nap, facing the first vanishing face in surface ball}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00267}00267 \textcolor{comment}{   * of p */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00268}00268   nro = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][iedg]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00269}00269 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00270}00270   jel = lists[1] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00271}00271   jface = lists[1] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00273}00273   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00274}00274   \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00275}00275     i = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[jface][j];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00276}00276     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != nump \&\& pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != nro ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00277}00277   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00278}00278   assert(j<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00280}00280   nap = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00282}00282   \textcolor{comment}{/* Unfold shell of (numq,nro), starting from (jel,jface), with pivot nump */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00283}00283   naq = \mbox{\hyperlink{colver__3d_8c_af0168755e4adf3d5442862c407bdc9f3}{MMG3D\_unfold\_shell}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,k,numq,nro,nump,\&iel,\&iopp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00285}00285   \textcolor{keywordflow}{if} ( naq < 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00286}00286     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00287}00287   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00288}00288   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( nap == naq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00289}00289     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00290}00290   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00292}00292   assert ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k].\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& \textcolor{stringliteral}{"{}initial tetra is not boundary"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00293}00293   pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k].\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00295}00295   \textcolor{keywordflow}{if} ( !( \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[iedg]]]) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00296}00296           \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[iedg]]])   ) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00298}00298     \textcolor{comment}{/* Check the normal deviation between the boundary faces sharing the edge}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00299}00299 \textcolor{comment}{     * numq (or nump)-\/nro */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00300}00300     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_ae1bb6a2d0e15eb4a15420b4ef77401a8}{MMG5\_norpts}} (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},numq,nro,nap,n0) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00301}00301     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmg3d__private_8h_adb5db44fed44cff9439ce1dd2cf1cf1c}{MMG5\_norface}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iopp    ,n1) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00303}00303     devnew = n0[0]*n1[0] + n0[1]*n1[1] + n0[2]*n1[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00304}00304     \textcolor{keywordflow}{if} ( devnew < mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_ad9247431b83de722fdb8b7b7c0e1fca9}{dhd}} ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00305}00305   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00307}00307   \textcolor{comment}{/*  Point nbp, facing the second vanishing face in surface ball of p */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00308}00308   jel1   = lists[ilists-\/1] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00309}00309   jface1 = lists[ilists-\/1] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00310}00310   pt     = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00311}00311   \textcolor{keywordflow}{for} (j1=0; j1<3; j1++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00312}00312     i = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[jface1][j1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00313}00313     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != nump \&\& pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != numq )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00314}00314   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00315}00315   assert(j1<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00317}00317   nro   = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00318}00318   jel   = lists[ilists-\/2] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00319}00319   jface = lists[ilists-\/2] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00320}00320   pt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00321}00321   \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00322}00322     i = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[jface][j];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00323}00323     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != nump \&\& pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i] != nro )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00324}00324   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00325}00325   assert(j<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00327}00327   nbp = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00329}00329   \textcolor{comment}{/* Unfold shell of (numq,nro), starting from (jel,jface), with pivot nump */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00330}00330   nbq = \mbox{\hyperlink{colver__3d_8c_af0168755e4adf3d5442862c407bdc9f3}{MMG3D\_unfold\_shell}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},lists[ilists-\/1]/4,k,numq,nro,nump,\&iel,\&iopp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00331}00331 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00332}00332   \textcolor{keywordflow}{if} ( nbq < 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00333}00333     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00334}00334   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00335}00335   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( nbp == nbq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00336}00336     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00337}00337   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00338}00338 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00339}00339   pxt      = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel1].\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00341}00341   \textcolor{keywordflow}{if} ( !( \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[jface1][\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[j1]]]) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00342}00342           \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[jface1][\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[j1]]])   ) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00344}00344     \textcolor{comment}{/* Check the normal deviation between the boundary faces sharing the edge}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00345}00345 \textcolor{comment}{     * numq (or nump)-\/nro */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00346}00346     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_ae1bb6a2d0e15eb4a15420b4ef77401a8}{MMG5\_norpts}} (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},nro,numq,nbp,n0) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00347}00347     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmg3d__private_8h_adb5db44fed44cff9439ce1dd2cf1cf1c}{MMG5\_norface}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iopp    ,n1) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00349}00349     devnew = n0[0]*n1[0] + n0[1]*n1[1] + n0[2]*n1[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00350}00350     \textcolor{keywordflow}{if} ( devnew < mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_ad9247431b83de722fdb8b7b7c0e1fca9}{dhd}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00351}00351   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00353}00353   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00354}00354 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00376}00376 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00377}\mbox{\hyperlink{colver__3d_8c_a39102926cf86828ba92a164f4107dcd8}{00377}} \textcolor{keywordtype}{int} \mbox{\hyperlink{colver__3d_8c_a39102926cf86828ba92a164f4107dcd8}{MMG3D\_get\_shellEdgeTag\_oneDir}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}}  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int start, MMG5\_int na, MMG5\_int nb,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00378}00378                                   int16\_t *tag,MMG5\_int *ref, MMG5\_int piv,MMG5\_int adj,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00379}00379                                   int8\_t *filled) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00380}00380   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}  pt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00381}00381   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00382}00382   MMG5\_int     *adja;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00383}00383   int8\_t       i;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00384}00384 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00385}00385   *filled = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00386}00386   \textcolor{keywordflow}{while} ( adj \&\& (adj != start) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00387}00387     pt     = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[adj];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00388}00388 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00389}00389     \textcolor{comment}{/* identification of edge number in tetra adj */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00390}00390     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{boulep__3d_8c_a53d91bf065c84f3721527a80d4a8a628}{MMG3D\_findEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,adj,na,nb,1,NULL,\&i) ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00392}00392     \textcolor{comment}{/* update edge ref and tag */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00393}00393     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00394}00394       pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00395}00395       *ref  = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00396}00396       \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00397}00397         *tag |= pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00398}00398         *filled = 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00399}00399         \textcolor{keywordflow}{return} adj;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00400}00400       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00401}00401     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00402}00402 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00403}00403     \textcolor{comment}{/* set new triangle for travel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00404}00404     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(adj-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00405}00405     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ] == piv ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00406}00406       adj = adja[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00407}00407       piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1] ];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00408}00408     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00409}00409     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00410}00410       adj = adja[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1] ] /4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00411}00411       piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00412}00412     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00413}00413   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00415}00415   \textcolor{keywordflow}{return} adj;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00416}00416 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00431}00431 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00432}\mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{00432}} \textcolor{keywordtype}{int} \mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{MMG3D\_get\_shellEdgeTag}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}}  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int start, int8\_t ia,int16\_t *tag,MMG5\_int *ref) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00433}00433   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}  pt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00434}00434   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00435}00435   MMG5\_int     piv,na,nb,adj,*adja;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00436}00436   int8\_t       filled;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00437}00437 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00438}00438   pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[start];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00440}00440   assert( start >= 1 \&\&  \mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00441}00441 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00442}00442   pxt  = NULL;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00443}00443   na   = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ia][0]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00444}00444   nb   = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ia][1]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00446}00446   \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00447}00447     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00448}00448     \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00449}00449       *tag |= pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00450}00450       *ref = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[ia];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00451}00451       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00452}00452     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00453}00453   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00454}00454 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00455}00455   \textcolor{comment}{/* Travel in one direction */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00456}00456   adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(start-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00457}00457   adj = adja[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][0]] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00458}00458   piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][1]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00459}00459 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00460}00460   adj = \mbox{\hyperlink{colver__3d_8c_a39102926cf86828ba92a164f4107dcd8}{MMG3D\_get\_shellEdgeTag\_oneDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},start,na,nb,tag,ref,piv,adj,\&filled);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00462}00462   \textcolor{comment}{/* If an xtetra has been found or if all shell has been travelled, stop, else,}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00463}00463 \textcolor{comment}{   * travel it the other sense */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00464}00464   \textcolor{keywordflow}{if} ( adj > 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00465}00465     assert ( (adj == start) || filled );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00466}00466     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00467}00467   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00468}00468   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( adj < 0 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00470}00470   assert(!adj);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00471}00471 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00472}00472   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[start];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00473}00473   adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(start-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00474}00474   adj = adja[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][1]] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00475}00475   piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][0]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00477}00477   adj = \mbox{\hyperlink{colver__3d_8c_a39102926cf86828ba92a164f4107dcd8}{MMG3D\_get\_shellEdgeTag\_oneDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},start,na,nb,tag,ref,piv,adj,\&filled);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00479}00479   \textcolor{keywordflow}{if} ( adj < 0 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00480}00480 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00481}00481   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00482}00482 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00483}00483 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00515}\mbox{\hyperlink{colver__3d_8c_ad9418ecaa79c07f9efc8e5e3195caeb4}{00515}} \textcolor{keywordtype}{int} \mbox{\hyperlink{colver__3d_8c_ad9418ecaa79c07f9efc8e5e3195caeb4}{MMG5\_chkcol\_bdy}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int k,int8\_t iface,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00516}00516                     int8\_t iedg,int64\_t *listv,\textcolor{keywordtype}{int} ilistv,MMG5\_int *lists,\textcolor{keywordtype}{int} ilists,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00517}00517                     MMG5\_int refmin,MMG5\_int refplus, int8\_t typchk,\textcolor{keywordtype}{int} isnm,int8\_t isnmint) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00518}00518   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}  pt,pt0,pt1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00519}00519   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00520}00520   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}    tt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00521}00521   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}    par;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00522}00522   \textcolor{keywordtype}{double}       calold,calnew,caltmp,nadja[3],nprvold[3],nprvnew[3],ncurold[3],ncurnew[3];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00523}00523   \textcolor{keywordtype}{double}       ps,devold,devnew,hmax,hausd;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00524}00524   MMG5\_int     nump,numq,ndepmin,ndepplus,l,kk,iel;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00525}00525   \textcolor{keywordtype}{int}          nr,nbbdy,isloc,iedgeOpp,ipp;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00526}00526   int16\_t      tag;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00527}00527   int8\_t       iopp,iopp2,ia,ip,i,iq,i0,i1,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}},isminp,isplp;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00528}00528 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00529}00529   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}  p0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00530}00530 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00531}00531 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00532}00532   pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00533}00533   pxt  = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00534}00534   pt0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00535}00535   ip   = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[iedg]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00536}00536   nump = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00537}00537   numq = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iface][\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[iedg]]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00538}00538 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00539}00539 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00540}00540   p0   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[nump];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00541}00541   assert(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00542}00542   assert(p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00543}00543 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00544}00544   \textcolor{comment}{/* Remove maybe-\/uninitialized value warning */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00545}00545   nprvold[0] = nprvold[1] = nprvold[2] = 0.;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00546}00546   ncurold[0] = ncurold[1] = ncurold[2]  = 0.;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00547}00547   nprvnew[0] = nprvnew[1] = nprvnew[2] = 0.;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00548}00548   ncurnew[0] = ncurnew[1] = ncurnew[2]  = 0.;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00549}00549 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00550}00550 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00551}00551   ndepmin = ndepplus = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00552}00552   isminp  = isplp = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00553}00553 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00554}00554   \textcolor{keywordflow}{if} ( !isnm ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00555}00555     refmin  = \mbox{\hyperlink{libmmgtypes_8h_aed8cf58b56d356e8026cde3efa0c7559}{MG\_MINUS}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00556}00556     refplus = \mbox{\hyperlink{libmmgtypes_8h_a9f312ca9c00e41dcab801f0b31f0b9fa}{MG\_PLUS}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00557}00557   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00558}00558 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00559}00559   \textcolor{keywordflow}{if} ( !isnmint ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00560}00560     \textcolor{comment}{/* prevent collapse in case surface ball has 3 triangles */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00561}00561     \textcolor{keywordflow}{if} ( ilists <= 2 )  \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// ATTENTION, Normalement, avec 2 c est bon !}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00562}00562 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00563}00563     \textcolor{comment}{/* Surfacic ball is enumerated with first tet having (pq) as edge n° MMG5\_iprv2[ip] on face iopp */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00564}00564     \mbox{\hyperlink{libmmg3d__private_8h_a6001aac4611eb4d133c6e7bd21f191a2}{MMG5\_startedgsurfball}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},nump,numq,lists,ilists);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00565}00565   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00566}00566 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00567}00567   \textcolor{comment}{/* check tetra quality */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00568}00568   calold = calnew = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00569}00569   \textcolor{keywordflow}{for} (l=0; l<ilistv; l++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00570}00570     iel = listv[l] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00571}00571     ipp = listv[l] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00572}00572     assert(iel \&\& ipp >=0 \&\& ipp < 4 \&\& \textcolor{stringliteral}{"{}unexpected tetra or local vertex idx"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00573}00573 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00574}00574     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00575}00575 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00576}00576     \textcolor{keywordflow}{if} ( !isnmint ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00577}00577       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} == refmin ) isminp = 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00578}00578       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} == refplus ) isplp = 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00579}00579     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00580}00580 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00581}00581     \textcolor{comment}{/* Topological test for tetras of the shell */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00582}00582     \textcolor{keywordflow}{for} (iq=0; iq<4; iq++)}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00583}00583       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iq] == numq )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00584}00584 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00585}00585     \textcolor{keywordflow}{if} ( iq < 4 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00586}00586       nbbdy = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00587}00587       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} )  \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00588}00588         pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00589}00589       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00590}00590 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00591}00591       \textcolor{keywordflow}{for} (i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00592}00592         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) )  nbbdy++;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00593}00593       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00594}00594 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00595}00595       \textcolor{keywordflow}{if} ( nbbdy == 4 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00596}00596         \textcolor{comment}{/* Only one element in the domain: we don't want to delete it */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00597}00597         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00598}00598       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00599}00599       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( nbbdy == 3 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00600}00600         \textcolor{comment}{/* Topological problem triggered when one of the two faces of collapsed}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00601}00601 \textcolor{comment}{         edge is the only internal one : closing a part of the domain */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00603}00603         \textcolor{comment}{/* Identification of edge number in tetra iel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00604}00604         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{boulep__3d_8c_a53d91bf065c84f3721527a80d4a8a628}{MMG3D\_findEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,iel,numq,nump,1,NULL,\&ia) ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00606}00606         i0 = \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00607}00607         i1 = \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00608}00608         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (!(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i0] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) || !(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i1] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}})) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00609}00609           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00610}00610       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00611}00611 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00612}00612       \textcolor{comment}{/* Now check that the 2 faces identified by collapse are not boundary */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00613}00613       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ipp] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[iq] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00614}00614         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00616}00616       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} )  \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00617}00617         \textcolor{keywordflow}{for} (i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00618}00618           \textcolor{keywordflow}{if} ( i==ipp || i==iq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00619}00619             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00620}00620           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00621}00621 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00622}00622           \textcolor{comment}{/*  Avoid surface crimping: check that the collapse doesn't merge 3}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00623}00623 \textcolor{comment}{           *  bdy edge along a non bdy face: we have to check the edge of each}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00624}00624 \textcolor{comment}{           *  shell because some MG\_BDY tags may be missings due to the creation}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00625}00625 \textcolor{comment}{           *  of an xtetra during a previous collapse */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00626}00626           \textcolor{keywordflow}{if} ( !(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00627}00627             int16\_t tag0,tag1,tag2;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00628}00628             \textcolor{keywordtype}{int}     ref0,ref1,ref2;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00629}00629 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00630}00630             tag0 = tag1 = tag2 = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00631}00631             ref0 = ref1 = ref2 = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00632}00632 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00633}00633             \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{MMG3D\_get\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[i][0],\&tag0,\&ref0) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00634}00634               fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 0. unable to get edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00635}00635               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00636}00636             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00637}00637             \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{MMG3D\_get\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[i][1],\&tag1,\&ref1) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00638}00638               fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 1. unable to get edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00639}00639               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00640}00640             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00641}00641             \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{MMG3D\_get\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[i][2],\&tag2,\&ref2) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00642}00642               fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 2. unable to get edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00643}00643               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00644}00644             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00645}00645             \textcolor{keywordflow}{if} ( (tag0 \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& (tag1 \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& (tag2 \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00646}00646               \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00647}00647             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00648}00648           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00649}00649         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00650}00650       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00651}00651 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00652}00652       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00653}00653     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00654}00654 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00655}00655     \textcolor{keywordflow}{if} ( !isnmint ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00656}00656       \textcolor{keywordflow}{if} ( isnm || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a04471d8c7bf1a0d989b6146ca1f65eba}{iso}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00657}00657         \textcolor{comment}{/* Volume test for tetras outside the shell */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00658}00658         \textcolor{keywordflow}{if} ( (!ndepmin) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} == refmin) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00659}00659           ndepmin = iel;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00660}00660         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00661}00661         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (!ndepplus) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} == refplus) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00662}00662           ndepplus = iel;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00663}00663         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00664}00664       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00665}00665     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00666}00666 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00667}00667     \textcolor{comment}{/* Prevent from creating a tetra with 4 ridges metrics in aniso mode */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00668}00668     \textcolor{keywordflow}{if} ( met \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}} == 6 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00669}00669       \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[numq].\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}}) \&\& !\mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[numq].\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00670}00670         i  = ipp;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00671}00671         nr = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00672}00672         \textcolor{keywordflow}{for} (iq=0; iq<3; iq++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00673}00673           i = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00674}00674           \textcolor{keywordflow}{if} ( (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]].\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}}) \&\&}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00675}00675                !\mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]].\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00676}00676             ++nr;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00677}00677           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00678}00678         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00679}00679         \textcolor{keywordflow}{if} ( nr==3 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00680}00680       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00681}00681     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00682}00682 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00683}00683     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00684}00684     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ipp] = numq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00685}00685 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00686}00686     calold = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calold, pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00687}00687     \textcolor{keywordflow}{if} ( typchk==1 \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}} > 1 )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00688}00688       caltmp = \mbox{\hyperlink{libmmg3d__private_8h_a9ca1aba7ffb80ae15c740d63be629f7c}{MMG5\_caltet33\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt0);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00689}00689     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00690}00690       caltmp = \mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,0);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00691}00691 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00692}00692     \textcolor{keywordflow}{if} ( caltmp < \mbox{\hyperlink{mmgcommon__private_8h_a80cb4724e6dc20a024e2b27dd47508da}{MMG5\_NULKAL}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00693}00693     calnew = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(calnew,caltmp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00694}00694   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00695}00695   \textcolor{keywordflow}{if} ( calold < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} \&\& calnew <= calold )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00696}00696   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( calnew < \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}} || calnew < 0.3*calold )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00697}00697 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00698}00698   \textcolor{keywordflow}{if} ( isnmint ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00699}00699     \textcolor{keywordflow}{return} ilistv;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00700}00700   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00701}00701 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00702}00702   \textcolor{comment}{/* analyze surfacic ball of p */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00703}00703   \textcolor{keywordflow}{for} (l=1; l<ilists-\/1; l++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00704}00704     iel  = lists[l] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00705}00705     iopp = lists[l] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00706}00706     assert(iel \&\& iopp >=0 \&\& iopp < 4 \&\& \textcolor{stringliteral}{"{}unexpected tetra or local vertex idx"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00708}00708     pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00709}00709     pxt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00710}00710     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00711}00711 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00712}00712     \textcolor{comment}{/* retrieve vertex in tetra */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00713}00713     \textcolor{keywordflow}{for} (ip=0; ip<4; ip++)}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00714}00714       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip] == nump )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00715}00715 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00716}00716     assert(ip<4);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00717}00717     \textcolor{keywordflow}{if} ( ip==4 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00718}00718 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00719}00719     memcpy(pt0,pt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_Tetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00720}00720     pt0-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip] = numq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00721}00721 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00722}00722     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmg3d__private_8h_adb5db44fed44cff9439ce1dd2cf1cf1c}{MMG5\_norface}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iopp,ncurold) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00723}00723     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmg3d__private_8h_adb5db44fed44cff9439ce1dd2cf1cf1c}{MMG5\_norface}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},0,iopp,ncurnew) )    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00724}00724 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00725}00725     \textcolor{comment}{/* check normal flipping */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00726}00726     ps = ncurold[0]*ncurnew[0] + ncurold[1]*ncurnew[1] + ncurold[2]*ncurnew[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00727}00727     \textcolor{keywordflow}{if} ( ps < 0.0 )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00728}00728 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00729}00729     \textcolor{comment}{/* check normal deviation between l and its neighbour through the edge ia */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00730}00730     ia       = \mbox{\hyperlink{libmmg3d__private_8h_a1db58d3ac16d3219321940346eb24f30}{MMG5\_idirinv}}[iopp][ip]; \textcolor{comment}{/* index of p in tria iopp */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00731}00731 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00732}00732     iedgeOpp =  \mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iopp][ia];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00733}00733 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00734}00734     \textcolor{keywordflow}{if} ( ! ( \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iedgeOpp])) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00736}00736       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmg3d__private_8h_a53f1808693159aa9692a244e492c3461}{MMG3D\_normalAdjaTri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iopp,ia,nadja);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00737}00737       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} < 0 )  \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00738}00738       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00739}00739 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00740}00740       devnew = nadja[0]*ncurnew[0] + nadja[1]*ncurnew[1] + nadja[2]*ncurnew[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00741}00741 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00742}00742       \textcolor{keywordflow}{if} ( devnew < mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_ad9247431b83de722fdb8b7b7c0e1fca9}{dhd}} ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00743}00743     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00744}00744 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00745}00745     \textcolor{keywordflow}{if} ( l == 1 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00746}00746       \textcolor{comment}{/* check normal deviation between the new first tri of the surfacic ball}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00747}00747 \textcolor{comment}{       * and the surfacic triangle facing ip in the old first tri of the}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00748}00748 \textcolor{comment}{       * surfacic ball (that vanishes due to the collapse)}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00749}00749 \textcolor{comment}{       */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00750}00750       kk    = lists[0] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00751}00751       iopp2 = lists[0] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00752}00752       pt1   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[kk];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00753}00753       assert(pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00754}00754 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00755}00755       \textcolor{comment}{/* retrieve vertex ip in tria iopp2 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00756}00756       \textcolor{keywordflow}{for} (ipp=0; ipp<3; ipp++)}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00757}00757         \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iopp2][ipp]] == nump )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00758}00758       assert(ipp<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00759}00759 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00760}00760       iedgeOpp =  \mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iopp2][ipp];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00761}00761 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00762}00762       \textcolor{keywordflow}{if} ( ! ( \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iedgeOpp] ) ) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00763}00763         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmg3d__private_8h_a53f1808693159aa9692a244e492c3461}{MMG3D\_normalAdjaTri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},kk,iopp2,ipp,nadja);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00764}00764 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00765}00765         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} < 0 )  \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00766}00766         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00768}00768         devnew = nadja[0]*ncurnew[0] + nadja[1]*ncurnew[1] + nadja[2]*ncurnew[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00769}00769         \textcolor{keywordflow}{if} ( devnew < mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_ad9247431b83de722fdb8b7b7c0e1fca9}{dhd}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00770}00770           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00771}00771         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00772}00772       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00773}00773     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00774}00774     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00775}00775       \textcolor{comment}{/* check normal deviation between l and l-\/1 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00776}00776       ia = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[ia];         \textcolor{comment}{/* edge between l-\/1 and l, in local num of tria */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00777}00777       ia = \mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iopp][ia];    \textcolor{comment}{/* edge between l-\/1 and l in local num of tetra */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00778}00778 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00779}00779       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia]) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00780}00780         devold = nprvold[0]*ncurold[0] + nprvold[1]*ncurold[1] + nprvold[2]*ncurold[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00781}00781         devnew = nprvnew[0]*ncurnew[0] + nprvnew[1]*ncurnew[1] + nprvnew[2]*ncurnew[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00783}00783         \textcolor{keywordflow}{if} ( devold < \mbox{\hyperlink{mmgcommon__private_8h_ac69f555b33690b646ba79843c3212d63}{MMG5\_ANGEDG}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00784}00784           \textcolor{keywordflow}{if} ( devnew < devold )  \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00785}00785             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00786}00786           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00787}00787         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00788}00788         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( devnew < \mbox{\hyperlink{mmgcommon__private_8h_ac69f555b33690b646ba79843c3212d63}{MMG5\_ANGEDG}} )  \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00789}00789           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00790}00790         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00791}00791       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00792}00792     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00793}00793 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00794}00794     \textcolor{comment}{/* check Hausdorff distance to geometric support */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00795}00795     \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iopp,\&tt);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00796}00796     \textcolor{keywordflow}{if} ( l == 1 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00797}00797       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00798}00798         \textcolor{keywordflow}{if} ( tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] == nump )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00799}00799       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00800}00800 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00801}00801       assert(i<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00802}00802       \textcolor{keywordflow}{if} ( i==3 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00803}00803 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00804}00804       \textcolor{comment}{/* Index of the third point of the first collapsed triangle */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00805}00805       i  = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00806}00806       ia = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00807}00807       tag = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iopp][ia]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00808}00808       tt.\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[ia] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(tt.\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[ia],tag);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00809}00809     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00810}00810     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( l == ilists-\/2 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00811}00811       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00812}00812         \textcolor{keywordflow}{if} ( tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] == nump )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00813}00813       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00814}00814       assert(i<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00815}00815       \textcolor{comment}{/* Index of the third point of the second collapsed triangle */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00816}00816       i  = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00817}00817       ia = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00818}00818       tag = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iopp][ia]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00819}00819       tt.\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[ia] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(tt.\mbox{\hyperlink{structMMG5__Tria_a35a279506f5223627de41580a94c52d0}{tag}}[ia],tag);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00820}00820     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00821}00821 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00822}00822     \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00823}00823       \textcolor{keywordflow}{if} ( tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] == nump )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00824}00824     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00825}00825     assert(i<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00826}00826     \textcolor{keywordflow}{if} ( i==3 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00827}00827 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00828}00828     tt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[i] = numq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00829}00829 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00830}00830     \textcolor{comment}{/* Local parameters for tt and iel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00831}00831     hmax  = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00832}00832     hausd = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00833}00833     isloc = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00834}00834     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00835}00835       \textcolor{keywordflow}{for} ( kk=0; kk<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++kk ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00836}00836         par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[kk];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00837}00837 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00838}00838         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00839}00839         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} != pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00840}00840 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00841}00841         hmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00842}00842         hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00843}00843         isloc = 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00844}00844         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00845}00845       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00846}00846     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00847}00847     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a04ba7031a8b9120d7be9df517c9fd509}{MG\_Tria}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00848}00848       \textcolor{keywordflow}{if} ( isloc ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00849}00849         \textcolor{keywordflow}{for} ( kk=0; kk<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++kk ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00850}00850           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[kk];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00851}00851 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00852}00852           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00853}00853           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} != tt.\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00854}00854 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00855}00855           hmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00856}00856           hausd = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00857}00857           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00858}00858         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00859}00859       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00860}00860       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00861}00861         \textcolor{keywordflow}{for} ( kk=0; kk<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++kk ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00862}00862           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[kk];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00863}00863 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00864}00864           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00865}00865           \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} != tt.\mbox{\hyperlink{structMMG5__Tria_a5a462e6e60cbc9f8943d55ac236f6f10}{ref}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00866}00866 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00867}00867           hmax  = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00868}00868           hausd = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00869}00869           isloc = 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00870}00870           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00871}00871         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00872}00872       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00873}00873     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00874}00874 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00875}00875     \textcolor{comment}{/* If some edges must be splitted, refuse the collapse */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00876}00876     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{libmmg3d__private_8h_a9c5aca6efdc9aa85e8022f9cd7c02f8f}{MMG5\_chkedg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&tt,\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},iopp),hmax,hausd,isloc) > 0 )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00877}00877 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00878}00878     memcpy(nprvold,ncurold,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00879}00879     memcpy(nprvnew,ncurnew,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00880}00880   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00881}00881 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00882}00882   \textcolor{comment}{/* check normal deviation between the new last tri of the surfacic ball}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00883}00883 \textcolor{comment}{   * and the surfacic triangle facing ip in the old last tri of the}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00884}00884 \textcolor{comment}{   * surfacic ball (that vanishes due to the collapse)}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00885}00885 \textcolor{comment}{   */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00886}00886   kk    = lists[ilists-\/1] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00887}00887   iopp2 = lists[ilists-\/1] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00888}00888   pt1   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[kk];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00889}00889   assert(pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00890}00890 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00891}00891   \textcolor{comment}{/* retrieve vertex ip in tria iopp2 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00892}00892   \textcolor{keywordflow}{for} (ipp=0; ipp<3; ipp++)}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00893}00893     \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[iopp2][ipp]] == nump )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00894}00894   assert(ipp<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00895}00895 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00896}00896   iedgeOpp =  \mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[iopp2][ipp];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00897}00897 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00898}00898   \textcolor{keywordflow}{if} ( ! ( \mbox{\hyperlink{mmgcommon__private_8h_a85a852d82d1d582615a4b32d28075d76}{MG\_GEO\_OR\_NOM}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iedgeOpp]) ) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00899}00899 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00900}00900     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmg3d__private_8h_a53f1808693159aa9692a244e492c3461}{MMG3D\_normalAdjaTri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},kk,iopp2,ipp,nadja);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00901}00901     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} < 0 )  \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00902}00902     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00903}00903 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00904}00904     devnew = nadja[0]*ncurnew[0] + nadja[1]*ncurnew[1] + nadja[2]*ncurnew[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00905}00905 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00906}00906     \textcolor{keywordflow}{if} ( devnew < mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_ad9247431b83de722fdb8b7b7c0e1fca9}{dhd}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00907}00907       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00908}00908     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00909}00909   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00910}00910 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00911}00911   \textcolor{keywordflow}{if} ( isnm || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a04471d8c7bf1a0d989b6146ca1f65eba}{iso}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00912}00912     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{libmmg3d__private_8h_a7d043afeb8a44d46049d10ec4cfc9221}{MMG3D\_chkmanicoll}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,iface,iedg,ndepmin,ndepplus,refmin,refplus,isminp,isplp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00913}00913     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00914}00914   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00915}00915   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00916}00916     \textcolor{comment}{/* Topological check for surface ball */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00917}00917     \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{colver__3d_8c_a459f9bf58c5963a2ab3cab51eb7977fd}{MMG5\_topchkcol\_bdy}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,iface,iedg,lists,ilists);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00918}00918     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}}<0 ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00919}00919     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00920}00920   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00921}00921 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00922}00922   \textcolor{keywordflow}{return} ilistv;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00923}00923 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00924}00924 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00939}00939 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00940}\mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{00940}} \textcolor{keywordtype}{void} \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt,\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt,MMG5\_int np, MMG5\_int nq,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00941}00941                           uint8\_t ip, \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt1,\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt1,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00942}00942                           uint8\_t voyp) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00943}00943 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00944}00944   \textcolor{keywordtype}{int}      i,j;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00945}00945   MMG5\_int p0,p1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00946}00946   uint8\_t  ia,iav;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00947}00947   int16\_t  tag,tag1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00948}00948 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00949}00949   \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00950}00950   \textcolor{keywordflow}{for} ( j=0; j<3; j++ ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00951}00951     ia = \mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[ip][j];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00952}00952     p0 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ia][0]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00953}00953     p1 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ia][1]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00954}00954     \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia] ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00955}00955       \textcolor{keywordflow}{for} ( i=0; i<3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00956}00956         iav=\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[voyp][i];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00957}00957         \textcolor{keywordflow}{if} ( p0==nq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00958}00958           \textcolor{keywordflow}{if} ( ((pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][0]]==np) \&\& (pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][1]]==p1)) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00959}00959                ((pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][0]]==p1) \&\& (pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][1]]==np)) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00960}00960             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00961}00961         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00962}00962         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( p1==nq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00963}00963           \textcolor{keywordflow}{if} ( ((pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][0]]==np ) \&\& (pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][1]]==p0)) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00964}00964                ((pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][0]]==p0) \&\& (pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][1]]==np )) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00965}00965             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00966}00966         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00967}00967         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00968}00968           \textcolor{keywordflow}{if} ( ((pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][0]]==p0) \&\& (pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][1]]==p1)) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00969}00969                ((pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][0]]==p1) \&\& (pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[iav][1]]==p0)) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00970}00970             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00971}00971         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00972}00972       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00973}00973       assert(i!=3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00974}00974       tag1 = pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iav];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00975}00975       tag  =  pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00976}00976       pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iav] |= pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00977}00977       \textcolor{keywordflow}{if}( ((tag1 \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \&\& !(tag1 \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}})) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00978}00978           (( tag \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \&\& !( tag \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}})) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00979}00979         pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[iav] \&= \string~MG\_NOSURF;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00980}00980       pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[iav] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}} ( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[iav],pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[ia] );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00981}00981     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00982}00982   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00983}00983 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l00984}00984 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01001}01001 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01002}\mbox{\hyperlink{colver__3d_8c_ad44a2209f0d889157a54d48bbae3d54b}{01002}} MMG5\_int \mbox{\hyperlink{colver__3d_8c_ad44a2209f0d889157a54d48bbae3d54b}{MMG3D\_update\_shellEdgeTag\_oneDir}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}}  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int start, MMG5\_int na, MMG5\_int nb,}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01003}01003                                      int16\_t tag,MMG5\_int ref, MMG5\_int piv,MMG5\_int adj) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01004}01004   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}  pt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01005}01005   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01006}01006   MMG5\_int     *adja;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01007}01007   int16\_t      xtag;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01008}01008   int8\_t       i;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01009}01009 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01010}01010   assert ( tag \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} \&\& \textcolor{stringliteral}{"{}Unexpected non boundary tag"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01011}01011 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01012}01012   \textcolor{keywordflow}{while} ( adj \&\& (adj != start) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01013}01013     pt     = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[adj];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01014}01014 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01015}01015     \textcolor{comment}{/* identification of edge number in tetra adj */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01016}01016     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{boulep__3d_8c_a53d91bf065c84f3721527a80d4a8a628}{MMG3D\_findEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt,adj,na,nb,1,NULL,\&i) ) \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01017}01017 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01018}01018     \textcolor{comment}{/* update edge ref and tag */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01019}01019     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01020}01020       pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01021}01021 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01022}01022       \textcolor{comment}{/* if tag and edge are already consistent, no need to update the shell (do}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01023}01023 \textcolor{comment}{       * not consider edges with tag 0 as they com from the creation of a xtetra}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01024}01024 \textcolor{comment}{       * during a previous collapse and are not updated) */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01025}01025       xtag = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[i] | \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01026}01026 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01027}01027       \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01028}01028         \textcolor{keywordflow}{if} ( xtag == tag \&\&  pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[i] == ref ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01029}01029           \textcolor{keywordflow}{return} start;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01030}01030         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01031}01031       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01032}01032 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01033}01033       pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[i] = ref;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01034}01034       pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[i] |= tag;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01035}01035       \textcolor{keywordflow}{if}( ((xtag \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \&\& !(xtag \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}})) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01036}01036           (( tag \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \&\& !( tag \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}})))}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01037}01037         pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[i] \&= \string~MG\_NOSURF;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01038}01038     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01039}01039 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01040}01040     \textcolor{comment}{/* set new triangle for travel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01041}01041     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(adj-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01042}01042     \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ] == piv ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01043}01043       adj = adja[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01044}01044       piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1] ];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01045}01045     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01046}01046     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01047}01047       adj = adja[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][1] ] /4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01048}01048       piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ \mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[i][0] ];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01049}01049     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01050}01050   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01051}01051 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01052}01052   \textcolor{keywordflow}{return} adj;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01053}01053 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01054}01054 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01066}01066 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01067}\mbox{\hyperlink{colver__3d_8c_ae4ce8e86bd8898bf14d838a315b1a8de}{01067}} \textcolor{keywordtype}{int} \mbox{\hyperlink{colver__3d_8c_ae4ce8e86bd8898bf14d838a315b1a8de}{MMG3D\_update\_shellEdgeTag}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}}  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},MMG5\_int start, int8\_t ia,int16\_t tag,MMG5\_int ref) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01068}01068   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}  pt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01069}01069   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}} pxt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01070}01070   MMG5\_int     piv,na,nb,adj,*adja;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01071}01071   int16\_t      xtag;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01072}01072 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01073}01073   pt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[start];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01074}01074 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01075}01075   assert( start >= 1 \&\&  \mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) \&\& \textcolor{stringliteral}{"{}invalid tetra"{}} );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01076}01076   assert ( tag \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} \&\& \textcolor{stringliteral}{"{}Unexpected non boundary tag"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01077}01077 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01078}01078   pxt  = NULL;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01079}01079   na   = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ia][0]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01080}01080   nb   = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[ia][1]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01081}01081 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01082}01082   \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01083}01083     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01084}01084 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01085}01085     \textcolor{comment}{/* if tag and edge are already consistent, no need to update the shell (do}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01086}01086 \textcolor{comment}{     * not consider edges with tag 0 as they com from the creation of a xtetra}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01087}01087 \textcolor{comment}{     * during a previous collapse and are not updated) */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01088}01088     xtag = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia] | \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01089}01089 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01090}01090     \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01091}01091       \textcolor{keywordflow}{if} ( xtag == tag \&\&  pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[ia] == ref ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01092}01092         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01093}01093       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01094}01094     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01095}01095 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01096}01096     pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia] |= tag;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01097}01097     \textcolor{keywordflow}{if}( ((xtag \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \&\& !(xtag \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}})) ||}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01098}01098         (( tag \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) \&\& !( tag \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}})))}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01099}01099       pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[ia] \&= \string~MG\_NOSURF;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01100}01100     pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad8e958e46dfc70dab63ec626f495aa26}{edg}}[ia]  = ref;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01101}01101   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01102}01102 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01103}01103   \textcolor{comment}{/* Travel in one direction */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01104}01104   adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(start-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01105}01105   adj = adja[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][0]] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01106}01106   piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][1]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01107}01107 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01108}01108   adj =   \mbox{\hyperlink{colver__3d_8c_ad44a2209f0d889157a54d48bbae3d54b}{MMG3D\_update\_shellEdgeTag\_oneDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},start,na,nb,tag,ref,piv,adj);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01109}01109 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01110}01110   \textcolor{comment}{/* If all shell has been travelled, stop, else, travel it the other sense */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01111}01111   \textcolor{keywordflow}{if} ( adj == start )  \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01112}01112   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( adj < 0 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01113}01113 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01114}01114   assert(!adj);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01115}01115 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01116}01116   pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[start];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01117}01117   adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(start-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01118}01118   adj = adja[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][1]] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01119}01119   piv = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_ab4c733df56539be47d7f773ee7b8c561}{MMG5\_ifar}}[ia][0]];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01120}01120 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01121}01121   adj = \mbox{\hyperlink{colver__3d_8c_ad44a2209f0d889157a54d48bbae3d54b}{MMG3D\_update\_shellEdgeTag\_oneDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},start,na,nb,tag,ref,piv,adj);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01122}01122 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01123}01123   \textcolor{keywordflow}{if} ( adj < 0 ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01124}01124 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01125}01125   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01126}01126 \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01127}01127 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01144}\mbox{\hyperlink{colver__3d_8c_aae08b68688523fb0526e7f43ca096cd9}{01144}} MMG5\_int \mbox{\hyperlink{colver__3d_8c_aae08b68688523fb0526e7f43ca096cd9}{MMG5\_colver}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,int64\_t *list,\textcolor{keywordtype}{int} ilist,int8\_t indq,int8\_t typchk) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01145}01145   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}          pt,pt1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01146}01146   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}         pxt,pxt1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01147}01147   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}          xt,xts;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01148}01148   MMG5\_int             iel,jel,pel,qel,k,np,nq,*adja;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01149}01149   uint8\_t              ip,iq,j,voy,voyp,voyq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01150}01150 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01151}01151   \textcolor{comment}{/* coledge[i] contains the local indices of edges that will be merged by the}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01152}01152 \textcolor{comment}{   * collapse corresponding with the configuration i. The edge coledge[i][0] is}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01153}01153 \textcolor{comment}{   * merged with the edge coledge[i][1] a,d the edge coledge[i][2] is merged}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01154}01154 \textcolor{comment}{   * with edge coledge[i][3].}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01155}01155 \textcolor{comment}{   * Config 0: merge of vertices 0 and 1}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01156}01156 \textcolor{comment}{   * config 1: merge of vertices 0 and 2}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01157}01157 \textcolor{comment}{   * config 2: merge of vertices 0 and 3}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01158}01158 \textcolor{comment}{   * config 3: merge of vertices 1 and 2}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01159}01159 \textcolor{comment}{   * config 4: merge of vertices 1 and 3}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01160}01160 \textcolor{comment}{   * config 5: merge of vertices 2 and 3}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01161}01161 \textcolor{comment}{   */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01162}01162   \textcolor{keyword}{const} int8\_t MMG5\_coledge[6][4] = \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01163}01163   \{1,3,2,4\}, \{0,3,2,5\}, \{0,4,1,5\},\{0,1,4,5\}, \{0,2,3,5\}, \{4,3,2,1\} \};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01164}01164 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01165}01165   iel = list[0] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01166}01166   ip  = list[0] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01167}01167   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01168}01168   np  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01169}01169   nq  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[indq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01170}01170 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01171}01171   \textcolor{comment}{/* Mark elements of the shell of edge (pq) */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01172}01172   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01173}01173     iel = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01174}01174     ip  = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01175}01175     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01176}01176 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01177}01177     \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01178}01178       iq = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ip][j];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01179}01179       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iq] == nq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01180}01180 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01181}01181         list[k] *= -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01182}01182         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01183}01183       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01184}01184     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01185}01185   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01186}01186 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01187}01187   \textcolor{comment}{/* Avoid recreating existing elt */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01188}01188   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01189}01189 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01190}01190     \textcolor{keywordflow}{if} ( list[k] < 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01191}01191 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01192}01192     iel = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01193}01193     ip  = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01194}01194 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01195}01195     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(iel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01196}01196     jel  = adja[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01197}01197     \textcolor{keywordflow}{if} ( !jel )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01198}01198 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01199}01199     jel /= 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01200}01200     voy  = adja[ip] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01201}01201     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[jel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01202}01202     \textcolor{keywordflow}{if} (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[voy] == nq) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01203}01203       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01204}01204     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01205}01205   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01206}01206 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01212}01212   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01213}01213 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01214}01214     \textcolor{keywordflow}{if} ( list[k] > 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01215}01215 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01216}01216     iel = -\/list[k] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01217}01217     ip  = -\/list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01218}01218     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01219}01219 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01220}01220     \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01221}01221       iq = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ip][j];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01222}01222       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iq] == nq ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01223}01223         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01224}01224       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01225}01225     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01226}01226 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01227}01227     \textcolor{comment}{/* The configuration is computed by setting the ip and iq bits to 1 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01228}01228     int8\_t cfg = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01229}01229     \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(cfg,ip);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01230}01230     \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(cfg,iq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01231}01231 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01232}01232     \textcolor{keyword}{const} int8\_t *coled;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01233}01233     \textcolor{keywordflow}{switch}(cfg) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01234}01234     \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01235}01235       \textcolor{comment}{/* collapse of vertices 0 and 1 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01236}01236       coled = MMG5\_coledge[0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01237}01237       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01238}01238     \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01239}01239       \textcolor{comment}{/* collapse of vertices 0 and 2 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01240}01240       coled = MMG5\_coledge[1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01241}01241       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01242}01242     \textcolor{keywordflow}{case} 9:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01243}01243       \textcolor{comment}{/* collapse of vertices 0 and 3 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01244}01244       coled = MMG5\_coledge[2];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01245}01245       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01246}01246     \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01247}01247       \textcolor{comment}{/* collapse of vertices 1 and 2 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01248}01248       coled = MMG5\_coledge[3];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01249}01249       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01250}01250     \textcolor{keywordflow}{case} 10:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01251}01251       \textcolor{comment}{/* collapse of vertices 1 and 3 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01252}01252       coled = MMG5\_coledge[4];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01253}01253       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01254}01254     \textcolor{keywordflow}{case} 12:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01255}01255       \textcolor{comment}{/* collapse of vertices 2 and 3 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01256}01256       coled = MMG5\_coledge[5];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01257}01257       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01258}01258     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01259}01259       assert ( 0 \&\& \textcolor{stringliteral}{"{}Unexpected collapse configuration"{}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01260}01260     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01261}01261 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01262}01262     \textcolor{keywordtype}{int} l = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01263}01263     \textcolor{keywordflow}{for} ( l=0; l<3; l+=2 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01264}01264       \textcolor{comment}{/* when l=0 we update 2 edges that will be merged together, when l=2 we}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01265}01265 \textcolor{comment}{       * update the two others. In practice we don't care which edge comes}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01266}01266 \textcolor{comment}{       * from ip and which one from iq, it only matters that iped and iqed}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01267}01267 \textcolor{comment}{       * will be merged at the end of the collapse. */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01268}01268       \textcolor{keywordtype}{int} iped = coled[l+0];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01269}01269       \textcolor{keywordtype}{int} iqed = coled[l+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01270}01270 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01271}01271       int16\_t  tagip = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01272}01272       MMG5\_int refip = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01273}01273       int16\_t  tagiq = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01274}01274       MMG5\_int refiq = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01275}01275 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01276}01276       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{MMG3D\_get\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iped,\&tagip,\&refip) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01277}01277         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 1. unable to get edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01278}01278         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01279}01279       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01280}01280       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_a587fd4a8b893f87d4f78adc2f133b8c3}{MMG3D\_get\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iqed,\&tagiq,\&refiq) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01281}01281         fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 2. unable to get edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01282}01282         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01283}01283       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01284}01284 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01285}01285       \textcolor{keywordflow}{if} ( (tagip != tagiq) || (refip != refiq) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01286}01286         \textcolor{comment}{/* Update edge infos */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01287}01287         tagip |= tagiq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01288}01288         refip = (refip > refiq )? refip : refiq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01289}01289 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01290}01290         \textcolor{comment}{/* If the xtetra info are consistent when entering in colver taged and}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01291}01291 \textcolor{comment}{         * refed contains suitable values and we can travel the shell of}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01292}01292 \textcolor{comment}{         * iped and iqed to update all the needed info on edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01293}01293         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_ae4ce8e86bd8898bf14d838a315b1a8de}{MMG3D\_update\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iped,tagip,refip) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01294}01294           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 1. unable to update edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01295}01295           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01296}01296         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01297}01297         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{colver__3d_8c_ae4ce8e86bd8898bf14d838a315b1a8de}{MMG3D\_update\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iqed,tagip,refip) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01298}01298           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: 1. unable to update edge info.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01299}01299           \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01300}01300         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01301}01301       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01302}01302 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01303}01303       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01304}01304         assert ( tagip == tagiq \&\& refip == refiq );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01305}01305         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} \&\& (tagip \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01306}01306           \mbox{\hyperlink{chkmsh__3d_8c_a50ad5aed7cb5d78cddf2b2416fd776d1}{MMG3D\_chk\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iped,tagip,refip);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01307}01307           \mbox{\hyperlink{chkmsh__3d_8c_a50ad5aed7cb5d78cddf2b2416fd776d1}{MMG3D\_chk\_shellEdgeTag}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,iqed,tagip,refip);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01308}01308         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01309}01309       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01310}01310 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01311}01311     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01312}01312   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01313}01313 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01314}01314   \textcolor{comment}{/* deal with the shell of edge (pq) and the implied updates */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01315}01315   \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01316}01316     \textcolor{keywordflow}{if} ( list[k] > 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01317}01317     iel = (-\/list[k]) / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01318}01318     ip  = (-\/list[k]) \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01319}01319     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01320}01320 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01321}01321     iq  = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01322}01322     \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01323}01323       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iq] == nq )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01324}01324       iq = \mbox{\hyperlink{libmmg3d__private_8h_ad8886a20f95b88521afe6d114395829b}{MMG5\_inxt3}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01325}01325     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01326}01326     assert(j<3);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01327}01327 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01328}01328 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01329}01329     adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(iel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01330}01330 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01331}01331     \textcolor{comment}{/* pel = neighbour of iel that belongs to ball of p \(\backslash\)setminus shell, same for qel */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01332}01332     pel  = adja[iq] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01333}01333     voyp = adja[iq] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01334}01334     qel  = adja[ip] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01335}01335     voyq = adja[ip] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01336}01336 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01337}01337     \textcolor{comment}{/* Update adjacency relations */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01338}01338     \textcolor{keywordflow}{if} ( pel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01339}01339       adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(pel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01340}01340       adja[voyp] = 4*qel+voyq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01341}01341     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01342}01342     \textcolor{keywordflow}{if} ( qel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01343}01343       adja = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(qel-\/1)+1];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01344}01344       adja[voyq] = 4*pel+voyp;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01345}01345     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01346}01346 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01347}01347     \textcolor{comment}{/* Update references for faces (one in pel) ;}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01348}01348 \textcolor{comment}{       possibly, creation of a new field pxt for pel must be carried out */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01349}01349     \textcolor{keywordflow}{if} ( pel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01350}01350       pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[pel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01351}01351       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01352}01352         pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01353}01353         memcpy(\&xts,pxt,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01354}01354         \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01355}01355           pxt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01356}01356           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyp] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyp],pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ip]);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01357}01357           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyp] = pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyp] | pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01358}01358 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01359}01359           \textcolor{comment}{/* the face voyp of pxt1 is projected into the face ip of pxt so it}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01360}01360 \textcolor{comment}{           * takes its orientation */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01361}01361           \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ip] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01362}01362             \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},ip) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01363}01363               \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01364}01364             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01365}01365               \mbox{\hyperlink{mmgcommon__private_8h_a3c647ea3c9d79b9fdefa0e997ae1ad36}{MG\_CLR}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01366}01366           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01367}01367           \textcolor{comment}{/* correct the orientation if the new adjacent has a different}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01368}01368 \textcolor{comment}{           * reference */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01369}01369           \textcolor{keywordflow}{if}( qel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01370}01370             \textcolor{keywordflow}{if}( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[qel].\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01371}01371               \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01372}01372             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} < \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[qel].\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01373}01373               \mbox{\hyperlink{mmgcommon__private_8h_a3c647ea3c9d79b9fdefa0e997ae1ad36}{MG\_CLR}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01374}01374           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01375}01375 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01376}01376 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01377}01377           \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01378}01378             \textcolor{comment}{/* Check that a non parallel external boundary face has always a good}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01379}01379 \textcolor{comment}{             * orientation */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01380}01380             \textcolor{keywordflow}{if} ( (pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyp] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& !(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyp] \& \mbox{\hyperlink{mmgcommon__private_8h_a3ce2c9eede0b495fb73c8d1993ed965c}{MG\_PARBDY}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01381}01381               assert ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp ) );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01382}01382             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01383}01383           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01384}01384 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01385}01385 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01386}01386           \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01387}01387           \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(pt,pxt,np,nq,ip,pt1,pxt1,voyp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01388}01388         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01389}01389         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01390}01390           \textcolor{comment}{/* shell tet has a xtetra and pel exists but pel don't have a xtetra */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01391}01391           pxt1 = \&xt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01392}01392           memset(pxt1,0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01393}01393           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyp] = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01394}01394           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyp] = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ip];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01395}01395           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}} = 15;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01396}01396           \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},ip) )  \mbox{\hyperlink{mmgcommon__private_8h_a3c647ea3c9d79b9fdefa0e997ae1ad36}{MG\_CLR}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01397}01397 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01398}01398           \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01399}01399           \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(pt,pxt,np,nq,ip,pt1,pxt1,voyp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01400}01400 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01401}01401           \textcolor{comment}{/* Recover the already used place by pxt: now pel has a xtetra but the}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01402}01402 \textcolor{comment}{           * edges coming from voyp (not directly involved in the collapse) will}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01403}01403 \textcolor{comment}{           * have the tag 0 that may be non consistent with other tags in their}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01404}01404 \textcolor{comment}{           * respective shells. */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01405}01405           pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01406}01406           memcpy(pxt,pxt1,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01407}01407         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01408}01408       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01409}01409       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01410}01410         \textcolor{comment}{/* Shell tet don't have a xtetra: only the values of pel corresponding}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01411}01411 \textcolor{comment}{         * to pt become 0 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01412}01412         \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01413}01413           pxt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01414}01414           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyp]  = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01415}01415           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyp] = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01416}01416           \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyp);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01417}01417         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01418}01418       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01419}01419 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01420}01420       \textcolor{keywordflow}{if} ( qel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01421}01421         pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[qel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01422}01422         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01423}01423           pxt = \&xts;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01424}01424           \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01425}01425             pxt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01426}01426             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyq]  = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyq],pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[iq]);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01427}01427             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] = (pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] | pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[iq]);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01428}01428 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01429}01429             \textcolor{comment}{/* the face voyq of pxt1 is projected into the face iq of pxt so it}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01430}01430 \textcolor{comment}{             * takes its orientation */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01431}01431             \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[iq] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01432}01432               \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},iq) )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01433}01433                 \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01434}01434               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01435}01435                 \mbox{\hyperlink{mmgcommon__private_8h_a3c647ea3c9d79b9fdefa0e997ae1ad36}{MG\_CLR}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01436}01436             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01437}01437             \textcolor{comment}{/* correct the orientation if the new adjacent has a different}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01438}01438 \textcolor{comment}{             * reference */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01439}01439             \textcolor{keywordflow}{if}( pel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01440}01440               \textcolor{keywordflow}{if}( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[pel].\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01441}01441                 \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01442}01442               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} < \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[pel].\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01443}01443                 \mbox{\hyperlink{mmgcommon__private_8h_a3c647ea3c9d79b9fdefa0e997ae1ad36}{MG\_CLR}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01444}01444             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01445}01445 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01446}01446 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01447}01447             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01448}01448               \textcolor{comment}{/* Check that a non parallel external boundary face has always a good}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01449}01449 \textcolor{comment}{               * orientation */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01450}01450               \textcolor{keywordflow}{if} ( (pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \&\& !(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] \& \mbox{\hyperlink{mmgcommon__private_8h_a3ce2c9eede0b495fb73c8d1993ed965c}{MG\_PARBDY}}) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01451}01451                 assert ( \mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}( pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq ) );}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01452}01452               \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01453}01453             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01454}01454 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01455}01455 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01456}01456             \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01457}01457             \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(pt,pxt,nq,np,iq,pt1,pxt1,voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01458}01458           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01459}01459           \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01460}01460             \textcolor{comment}{/* pel exists, shell tet has a xtetra but qel doesn't have boundary}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01461}01461 \textcolor{comment}{             * tetra: create it */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01462}01462             pxt1 = \&xt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01463}01463             memset(pxt1,0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01464}01464             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyq] = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01465}01465             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01466}01466             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}} = 15;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01467}01467             \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},iq) )  \mbox{\hyperlink{mmgcommon__private_8h_a3c647ea3c9d79b9fdefa0e997ae1ad36}{MG\_CLR}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01468}01468 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01469}01469             \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01470}01470             \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(pt,pxt,nq,np,iq,pt1,pxt1,voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01471}01471 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01472}01472             \textcolor{comment}{/* Create new field xt */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01473}01473             \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a376c565402818831af5ce8d2325d9744}{xt}}++;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01474}01474             \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a376c565402818831af5ce8d2325d9744}{xt}} > \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a6fbb1534f48f63b2d42cbf4382dd0b6b}{xtmax}} ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01475}01475               \mbox{\hyperlink{mmgcommon__private_8h_a7c5021138095892cf2699f36a7c526ae}{MMG5\_TAB\_RECALLOC}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a6fbb1534f48f63b2d42cbf4382dd0b6b}{xtmax}},\mbox{\hyperlink{mmgcommon__private_8h_a50b381cd31a4a90064ce1d936a7c037d}{MMG5\_GAP}},\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}},}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01476}01476                                  \textcolor{stringliteral}{"{}larger xtetra table"{}},}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01477}01477                                  \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a376c565402818831af5ce8d2325d9744}{xt}}-\/-\/;\textcolor{keywordflow}{return} -\/1;);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01478}01478             \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01479}01479             \textcolor{comment}{/* Now qel has a xtetra but the edges coming from voyq (not directly}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01480}01480 \textcolor{comment}{             * involved in the collapse) will have the tag 0 that may be non}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01481}01481 \textcolor{comment}{             * consistent with other tags in their respective shells. */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01482}01482             pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a376c565402818831af5ce8d2325d9744}{xt}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01483}01483             pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01484}01484             memcpy(pxt,pxt1,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01485}01485           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01486}01486         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01487}01487         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01488}01488           \textcolor{comment}{/* pel exist but shell tet doesn't have a boundary tetra: only the}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01489}01489 \textcolor{comment}{           * values of qel corresponding to pt become 0 */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01490}01490           \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01491}01491             pxt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01492}01492             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyq]  = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01493}01493             pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] = 0;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01494}01494             \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01495}01495           \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01496}01496         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01497}01497       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01498}01498     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01499}01499     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01500}01500       \textcolor{comment}{/* pel==0: No adjacent through face iq */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01501}01501       assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01502}01502       pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01503}01503       \textcolor{keywordflow}{if} ( qel ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01504}01504         pt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[qel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01505}01505         \textcolor{keywordflow}{if} ( pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} > 0 ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01506}01506           pxt1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01507}01507           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyq]  = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01508}01508           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01509}01509 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01510}01510           \mbox{\hyperlink{mmgcommon__private_8h_afd5d6500dd622fcafa85f310a11b77d9}{MG\_SET}}(pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01511}01511 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01512}01512           \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01513}01513           \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(pt,pxt,nq,np,iq,pt1,pxt1,voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01514}01514         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01515}01515         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01516}01516           pxt1 = \&xt;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01517}01517           memset(pxt1,0,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01518}01518           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[voyq]  = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01519}01519           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[voyq] = pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[iq];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01520}01520           pxt1-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}} = 15;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01521}01521 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01522}01522           \textcolor{comment}{/* update tags for edges */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01523}01523           \mbox{\hyperlink{colver__3d_8c_a0e0bb8a224325610195fb655251b511a}{MMG3D\_update\_edgeTag}}(pt,pxt,nq,np,iq,pt1,pxt1,voyq);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01524}01524 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01525}01525           \textcolor{comment}{/* Recover the already used place by pxt */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01526}01526           pt1-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01527}01527           memcpy(pxt,pxt1,\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structMMG5__xTetra}{MMG5\_xTetra}}));}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01528}01528         \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01529}01529       \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01530}01530     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01531}01531     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{libmmg3d__private_8h_a86bdfe05f99b7b001c38652726ab9407}{MMG3D\_delElt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel) ) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01532}01532       \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01533}01533     \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01534}01534   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01535}01535 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01536}01536   \textcolor{comment}{/* Update vertices coordinates for elements that do not belong to the shell of (pq) */}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01537}01537   \textcolor{keywordflow}{for} (k=0; k<ilist;  k++) \{}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01538}01538     \textcolor{keywordflow}{if} ( list[k] < 0 )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01539}01539     iel = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01540}01540     ip  = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01541}01541     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01542}01542     pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip] = nq;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01543}01543     \textcolor{keywordflow}{if} ( typchk==1 \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} \&\& met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}} > 1 )}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01544}01544       pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}}=\mbox{\hyperlink{libmmg3d__private_8h_a9ca1aba7ffb80ae15c740d63be629f7c}{MMG5\_caltet33\_ani}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01545}01545     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01546}01546       pt-\/>\mbox{\hyperlink{structMMG5__Tetra_ae4f0f3fb5df26dded15c02d9b0bda14f}{qual}}=\mbox{\hyperlink{inlined__functions__3d__private_8h_aff07b8488fd7c7573d37086b34791087}{MMG5\_orcal}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,iel);}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01547}01547     pt-\/>\mbox{\hyperlink{structMMG5__Tetra_aa5c955794b22e3571f82c6882630613b}{mark}}=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a4f631531b8a3cdafdbed9a2e6918fe7e}{mark}};}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01548}01548   \}}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01549}01549 }
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01550}01550   \textcolor{keywordflow}{return} np;}
\DoxyCodeLine{\Hypertarget{colver__3d_8c_source_l01551}01551 \}}

\end{DoxyCode}
