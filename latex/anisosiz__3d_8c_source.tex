\hypertarget{anisosiz__3d_8c_source}{}\doxysection{anisosiz\+\_\+3d.\+c}
\label{anisosiz__3d_8c_source}\index{src/mmg3d/anisosiz\_3d.c@{src/mmg3d/anisosiz\_3d.c}}
\mbox{\hyperlink{anisosiz__3d_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00001}00001 \textcolor{comment}{/* =============================================================================}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00002}00002 \textcolor{comment}{**  This file is part of the mmg software package for the tetrahedral}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00003}00003 \textcolor{comment}{**  mesh modification.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00004}00004 \textcolor{comment}{**  Copyright (c) Bx INP/CNRS/Inria/UBordeaux/UPMC, 2004-\/}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00005}00005 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00006}00006 \textcolor{comment}{**  mmg is free software: you can redistribute it and/or modify it}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00007}00007 \textcolor{comment}{**  under the terms of the GNU Lesser General Public License as published}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00008}00008 \textcolor{comment}{**  by the Free Software Foundation, either version 3 of the License, or}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00009}00009 \textcolor{comment}{**  (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00010}00010 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00011}00011 \textcolor{comment}{**  mmg is distributed in the hope that it will be useful, but WITHOUT}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00012}00012 \textcolor{comment}{**  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00013}00013 \textcolor{comment}{**  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00014}00014 \textcolor{comment}{**  License for more details.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00015}00015 \textcolor{comment}{**}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00016}00016 \textcolor{comment}{**  You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00017}00017 \textcolor{comment}{**  License and of the GNU General Public License along with mmg (in}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00018}00018 \textcolor{comment}{**  files COPYING.LESSER and COPYING). If not, see}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00019}00019 \textcolor{comment}{**  <http://www.gnu.org/licenses/>. Please read their terms carefully and}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00020}00020 \textcolor{comment}{**  use this copy of the mmg distribution only if you accept them.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00021}00021 \textcolor{comment}{** =============================================================================}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00022}00022 \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{libmmg3d_8h}{libmmg3d.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{inlined__functions__3d__private_8h}{inlined\_functions\_3d\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmg3dexterns__private_8h}{mmg3dexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00039}00039 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mmgexterns__private_8h}{mmgexterns\_private.h}}"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00048}\mbox{\hyperlink{anisosiz__3d_8c_a3b9c20bd2c7f3ae8bf7fa1258b72eecd}{00048}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a3b9c20bd2c7f3ae8bf7fa1258b72eecd}{MMG3D\_printEigenv}}(\textcolor{keywordtype}{double} dm[3],\textcolor{keywordtype}{double} vp[3][3]) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00050}00050   printf(\textcolor{stringliteral}{"{}-\/-\/-\/ Eigenvalues:\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00051}00051   printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},dm[0],dm[1],dm[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00052}00052   printf(\textcolor{stringliteral}{"{}-\/-\/-\/Eigenvectors (visualization by columns):\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00053}00053   printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},vp[0][0],vp[1][0],vp[2][0]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00054}00054   printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},vp[0][1],vp[1][1],vp[2][1]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00055}00055   printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},vp[0][2],vp[1][2],vp[2][2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00057}00057   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00058}00058 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00067}\mbox{\hyperlink{anisosiz__3d_8c_a48a968b7d6b1024de8f3c1c344d5ceb6}{00067}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a48a968b7d6b1024de8f3c1c344d5ceb6}{MMG3D\_printMat}}(int8\_t symmat,\textcolor{keywordtype}{double} *m) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00069}00069   \textcolor{keywordflow}{if}( symmat ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00070}00070     printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},m[0],m[1],m[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00071}00071     printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},m[1],m[3],m[4]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00072}00072     printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},m[2],m[4],m[5]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00073}00073   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00074}00074     printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},m[0],m[1],m[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00075}00075     printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},m[3],m[4],m[5]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00076}00076     printf(\textcolor{stringliteral}{"{}\%e \%e \%e\(\backslash\)n"{}},m[6],m[7],m[8]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00077}00077   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00079}00079   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00080}00080 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00090}\mbox{\hyperlink{anisosiz__3d_8c_a2736b8a4aaf73795c17a44fc0e8dc20d}{00090}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a2736b8a4aaf73795c17a44fc0e8dc20d}{MMG3D\_printErrorMat}}(int8\_t symmat,\textcolor{keywordtype}{double} *m,\textcolor{keywordtype}{double} *mr) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00091}00091   \textcolor{keywordtype}{double} dm[9],dd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00092}00092   \textcolor{keywordtype}{int} i,dim;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00094}00094   \textcolor{keywordflow}{if}( symmat )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00095}00095     dim = 6;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00096}00096   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00097}00097     dim = 9;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00099}00099   dd = 0.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00100}00100   \textcolor{keywordflow}{for}( i = 0; i < dim; i++ )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00101}00101     \textcolor{keywordflow}{if}( fabs(m[i]) > dd )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00102}00102       dd = fabs(m[i]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00103}00103   dd = 1.0 / dd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00105}00105   \textcolor{keywordflow}{for}( i = 0; i < dim; i++ )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00106}00106       dm[i] = (m[i]-\/mr[i])*dd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00108}00108   \textcolor{keywordflow}{if}( !\mbox{\hyperlink{anisosiz__3d_8c_a48a968b7d6b1024de8f3c1c344d5ceb6}{MMG3D\_printMat}}(symmat,dm) ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00110}00110   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00111}00111 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00112}00112 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00113}\mbox{\hyperlink{anisosiz__3d_8c_a092474e53bc00193da51eddf74c14415}{00113}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a092474e53bc00193da51eddf74c14415}{MMG3D\_chk4ridVertices}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00114}00114   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}  ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00115}00115   \textcolor{keywordtype}{int}          i;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00116}00116   \textcolor{keywordtype}{int}          n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00118}00118   n = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00119}00119   \textcolor{keywordflow}{for}(i=0 ; i<4 ; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00120}00120     ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00121}00121     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a9be91699c50147e8114822e13d41ae09}{MG\_RID}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00122}00122     n++;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00123}00123   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00125}00125   \textcolor{keywordflow}{if}(!n) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00126}00126     \textcolor{comment}{//fprintf(stderr,"{}\(\backslash\)n  \#\# Warning: 4 ridges points... Unable to compute metric.\(\backslash\)n"{});}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00127}00127     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00128}00128   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00130}00130   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00131}00131 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00132}00132 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00144}\mbox{\hyperlink{anisosiz__3d_8c_a091640a03aa984f5db2efa2a2c1dda74}{00144}} \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a091640a03aa984f5db2efa2a2c1dda74}{MMG5\_moymet}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt,\textcolor{keywordtype}{double} *m1) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00145}00145   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00146}00146   \textcolor{keywordtype}{double}        mm[6],*mp;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00147}00147   \textcolor{keywordtype}{double}        dd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00148}00148   \textcolor{keywordtype}{int}           i,k,n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00149}00149   int8\_t        ddebug = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00150}00150   \textcolor{keyword}{static} int8\_t mmgWarn=0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00152}00152   n = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00153}00153   \textcolor{keywordflow}{for} (k=0; k<6; ++k) mm[k] = 0.;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00154}00154   \textcolor{keywordflow}{for}(i=0 ; i<4 ; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00155}00155     ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00156}00156     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a9be91699c50147e8114822e13d41ae09}{MG\_RID}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00157}00157     n++;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00158}00158     mp = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00159}00159     \textcolor{keywordflow}{for} (k=0; k<6; ++k) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00160}00160       mm[k] += mp[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00161}00161     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00162}00162   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00164}00164   \textcolor{keywordflow}{if}(!n) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00165}00165     \textcolor{keywordflow}{if} ( ddebug \&\& !mmgWarn ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00166}00166       mmgWarn=1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00167}00167       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 tetra with 4 ridges vertices"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00168}00168               \textcolor{stringliteral}{"{}... Unable to compute metric.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00169}00169     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00170}00170     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00171}00171   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00172}00172   dd = 1./n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00173}00173   \textcolor{keywordflow}{for} (k=0; k<6; ++k) m1[k] = mm[k]*dd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00174}00174   \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00175}00175 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00176}00176 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00191}\mbox{\hyperlink{anisosiz__3d_8c_a6bb3f73ec3910c7b3bcbf6c0670059c9}{00191}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a6bb3f73ec3910c7b3bcbf6c0670059c9}{MMG5\_defmetsin}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int kel, \textcolor{keywordtype}{int} iface, \textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00192}00192   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}        pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00193}00193   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}       pxt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00194}00194   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}        p0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00195}00195   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}          par;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00196}00196   \textcolor{keywordtype}{double}             *m,n[3],isqhmin,isqhmax,b0[3],b1[3],ps1,tau[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00197}00197   \textcolor{keywordtype}{double}             ntau2,gammasec[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00198}00198   \textcolor{keywordtype}{double}             c[3],kappa,maxkappa,alpha, hausd,hausd\_v;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00199}00199   MMG5\_int           lists[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00200}00200   int64\_t            listv[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00201}00201   \textcolor{keywordtype}{int}                k,ilist,ifac,isloc,init\_s,ilists,ilistv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00202}00202   MMG5\_int           idp,iel;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00203}00203   uint8\_t            i,i0,i1,i2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00204}00204   \textcolor{keyword}{static} int8\_t      mmgWarn = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00206}00206   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[kel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00207}00207   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00208}00208   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00210}00210   \textcolor{comment}{/* local parameters at vertex: useless for now because new points are created}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00211}00211 \textcolor{comment}{   * without reference (inside the domain) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00212}00212   hausd\_v = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00213}00213   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00214}00214   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00215}00215   isloc   = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00217}00217   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a62e926e2281a655962d433617e42aa97}{adja}}[4*(kel-\/1)+iface+1] ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00218}00218   ilist = \mbox{\hyperlink{boulep__3d_8c_a3f949cd9117164c874ddfd40817d06a4}{MMG5\_boulesurfvolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},kel,ip,iface,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00219}00219                               listv,\&ilistv,lists,\&ilists,(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00221}00221   \textcolor{keywordflow}{if} ( ilist!=1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00222}00222     \textcolor{keywordflow}{if} ( !mmgWarn ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00223}00223       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00224}00224               \textcolor{stringliteral}{"{} unable to compute the ball of point\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00225}00225       mmgWarn = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00226}00226     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00227}00227     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00228}00228   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00229}00229 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00231}00231   \textcolor{comment}{/* travel across the ball of ip to find the minimal local params imposed on}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00232}00232 \textcolor{comment}{   * tetras */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00233}00233   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00234}00234     i = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00235}00235     \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00236}00236     \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00237}00237       \textcolor{keywordflow}{if} ( isloc )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00238}00238 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00239}00239       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00240}00240       \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00241}00241 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00242}00242       \textcolor{keywordflow}{for} ( k=0; k<ilistv; ++k ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00243}00243         pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[k]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00244}00244         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00245}00245           hausd\_v = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00246}00246           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00247}00247           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00248}00248           isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00249}00249           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00250}00250         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00251}00251       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00252}00252     \} \textcolor{keywordflow}{while} ( ++i<mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00254}00254     \textcolor{keywordflow}{for} ( ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00255}00255       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00256}00256       \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00257}00257 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00258}00258       \textcolor{keywordflow}{for} ( k=0; k<ilistv; ++k ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00259}00259         pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[k]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00260}00260         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00261}00261           hausd\_v = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd\_v,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00262}00262           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00263}00263           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00264}00264           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00265}00265         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00266}00266       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00267}00267     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00268}00268   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00269}00269 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00271}00271   maxkappa = 0.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00272}00272   init\_s = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00274}00274   \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00275}00275     iel   = lists[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00276}00276     ifac  = lists[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00277}00277     pt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00278}00278     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ifac] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00279}00279     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00280}00280 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00281}00281     \textcolor{keywordflow}{for} ( i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00282}00282       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i]] == idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00283}00283     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00284}00284     assert(i<3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00286}00286     i0  = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00287}00287     i1  = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00288}00288     i   = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00289}00289     i2  = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00291}00291     \textcolor{comment}{/* Computation of the two control points associated to edge p0p1 with}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00292}00292 \textcolor{comment}{     * p1=mesh-\/>point[pt-\/>v[i1]]: p0 is singular */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00293}00293     \mbox{\hyperlink{mmgcommon__private_8h_ae1bb6a2d0e15eb4a15420b4ef77401a8}{MMG5\_norpts}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i0],pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1],pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i2],n);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00295}00295     \mbox{\hyperlink{bezier__3d_8c_a025bc31e4da7444ea604bee30fef7102}{MMG5\_BezierEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},idp,pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1],b0,b1,\mbox{\hyperlink{mmgcommon__private_8h_a74536082ddf62a1ee16bc4d576fdeda5}{MG\_EDG\_OR\_NOM}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[ifac][i]]),n);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00297}00297     \textcolor{comment}{/* tangent vector */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00298}00298     tau[0] = 3.0*(b0[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00299}00299     tau[1] = 3.0*(b0[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00300}00300     tau[2] = 3.0*(b0[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00301}00301     ntau2  = tau[0]*tau[0] + tau[1]*tau[1] + tau[2]*tau[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00303}00303     \textcolor{comment}{/* 2nd order derivative */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00304}00304     gammasec[0] = 6.0*p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ 12.0*b0[0] + 6.0*b1[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00305}00305     gammasec[1] = 6.0*p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ 12.0*b0[1] + 6.0*b1[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00306}00306     gammasec[2] = 6.0*p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ 12.0*b0[2] + 6.0*b1[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00307}00307     \textcolor{keywordflow}{if} ( ntau2 < \mbox{\hyperlink{eigenv__private_8h_a6cb898fb52de6878afc45c81fb376e62}{MMG5\_EPSD}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00308}00308     ntau2 = 1.0 / ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00309}00309 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00310}00310     \textcolor{comment}{/* derivative via the normal parametrization */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00311}00311     ps1  = gammasec[0]*tau[0] + gammasec[1]*tau[1] + gammasec[2]*tau[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00312}00312     c[0] = gammasec[0] -\/ ps1*tau[0]*ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00313}00313     c[1] = gammasec[1] -\/ ps1*tau[1]*ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00314}00314     c[2] = gammasec[2] -\/ ps1*tau[2]*ntau2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00316}00316     kappa = ntau2 * sqrt(c[0]*c[0] + c[1]*c[1] + c[2]*c[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00317}00317 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00318}00318     \textcolor{comment}{/* local parameters for triangle */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00319}00319     hausd  = hausd\_v;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00321}00321     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a04ba7031a8b9120d7be9df517c9fd509}{MG\_Tria}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00322}00322       \textcolor{keywordflow}{if} ( !isloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00323}00323         \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00324}00324           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00325}00325 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00326}00326           \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ifac] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00327}00327             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00329}00329           hausd   = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00330}00330           \textcolor{keywordflow}{if} ( !init\_s ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00331}00331             isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00332}00332             isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00333}00333             init\_s  = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00334}00334           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00335}00335           \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00336}00336             isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}},isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00337}00337             isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}},isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00338}00338           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00339}00339           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00340}00340         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00341}00341       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00342}00342       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00343}00343         \textcolor{keywordflow}{for} ( i=0 ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00344}00344           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00346}00346           \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ifac] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00347}00347             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00349}00349           hausd   = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}},hausd);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00350}00350           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}},isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00351}00351           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}},isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00352}00352           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00353}00353         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00354}00354       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00355}00355     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00356}00356     maxkappa = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(kappa/hausd,maxkappa);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00357}00357   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00359}00359   isqhmin  = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00360}00360   isqhmax  = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00362}00362   alpha = 1.0 / 8.0 * maxkappa;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00363}00363   alpha = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(alpha,isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00364}00364   alpha = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(alpha,isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00366}00366   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00367}00367   memset(m,0,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00368}00368   m[0] = m[3] = m[5] = alpha;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00369}00369 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00370}00370   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00371}00371 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00372}00372 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00390}\mbox{\hyperlink{anisosiz__3d_8c_afc91ba97a6cfdcd31d5dbbeb8bb5e781}{00390}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_afc91ba97a6cfdcd31d5dbbeb8bb5e781}{MMG5\_defmetrid}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int kel,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00391}00391                            \textcolor{keywordtype}{int} iface, MMG5\_int ip)}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00392}00392 \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00393}00393   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}    pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00394}00394   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}   pxt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00395}00395   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}      ptt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00396}00396   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p0,p1,p2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00397}00397   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}      par;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00398}00398   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}    b;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00399}00399   MMG5\_int       iel,idp,*list;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00400}00400   \textcolor{keywordtype}{int}            k,ilist1,ilist2,ilist;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00401}00401   MMG5\_int       list1[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2],list2[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2],iprid[2],\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00402}00402   \textcolor{keywordtype}{double}         *m,isqhmin,isqhmax,*n1,*n2,*n,*t;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00403}00403   \textcolor{keywordtype}{double}         trot[2],u[2],ux,uy,uz,det,bcu[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00404}00404   \textcolor{keywordtype}{double}         r[3][3],lispoi[3*\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00405}00405   \textcolor{keywordtype}{double}         detg,detd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00406}00406   \textcolor{keywordtype}{int}            i,i0,i1,i2,ifac,isloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00407}00407   \textcolor{keyword}{static} int8\_t  mmgWarn = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00408}00408 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00409}00409   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[kel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00410}00410   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00411}00411   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00412}00412   pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00414}00414   \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00415}00415   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00416}00416   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00418}00418   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00419}00419     isloc   = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00421}00421     i = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00422}00422     \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00423}00423     \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00424}00424       \textcolor{keywordflow}{if} ( isloc )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00426}00426       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00427}00427       \textcolor{keywordflow}{if} ( ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}})    || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[iface] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) ) \&\&}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00428}00428            ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}}) || (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} )         ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00429}00429         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00431}00431       isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00432}00432       isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00433}00433       isloc = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00434}00434     \} \textcolor{keywordflow}{while} ( ++i<mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00435}00435 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00436}00436     \textcolor{keywordflow}{for} ( ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00437}00437       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00438}00438 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00439}00439       \textcolor{keywordflow}{if} ( ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}})    || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[iface] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) ) \&\&}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00440}00440            ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}}) || (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} )         ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00441}00441         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00442}00442 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00443}00443       isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00444}00444       isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00445}00445     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00446}00446   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00447}00447 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00448}00448   isqhmin = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00449}00449   isqhmax = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00451}00451   n1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00452}00452   n2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}].\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00453}00453   t  = p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00454}00454 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00455}00455   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00456}00456   memset(m,0,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00457}00457   m[0] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00458}00458   m[1] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00459}00459   m[2] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00460}00460   m[3] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00461}00461   m[4] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00462}00462 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00463}00463   \textcolor{comment}{// Call bouletrid that construct the surfacic ball}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00464}00464   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{boulep__3d_8c_a9140da89dbd59f4ff25c889babdf54e2}{MMG5\_bouletrid}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},kel,iface,ip,\&ilist1,list1,\&ilist2,list2,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00465}00465                         \&iprid[0],\&iprid[1] );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00466}00466   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00467}00467     \textcolor{keywordflow}{if} ( !mmgWarn ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00468}00468       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00469}00469               \textcolor{stringliteral}{"{} unable to compute the ball of point\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00470}00470       mmgWarn = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00471}00471     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00472}00472   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00473}00473 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00474}00474   \textcolor{comment}{/* Specific size in direction of t */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00475}00475   m[0] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[0],\mbox{\hyperlink{anisosiz_8c_af0b1ee93ffcbf66e79752170f332260c}{MMG5\_ridSizeInTangentDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p0,idp,iprid,isqhmin,isqhmax));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00477}00477   \textcolor{comment}{/* Characteristic sizes in directions u1 and u2 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00478}00478   \textcolor{keywordflow}{for} (i=0; i<2; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00479}00479     \textcolor{keywordflow}{if} ( i==0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00480}00480       n = n1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00481}00481       ilist = ilist1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00482}00482       list  = \&list1[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00483}00483     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00484}00484     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00485}00485       n = n2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00486}00486       ilist = ilist2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00487}00487       list  = \&(list2[0]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00488}00488     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00489}00489     \mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00490}00490 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00491}00491     \textcolor{comment}{/* Apply rotation to the half-\/ball under consideration */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00492}00492     i1   = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00493}00493     ifac = -\/1; \textcolor{comment}{// Remove uninitialized warning}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00494}00494     \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00495}00495       iel  = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00496}00496       ifac = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00497}00497       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00498}00498       \textcolor{keywordflow}{for} ( i0=0; i0!=3; ++i0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00499}00499         \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i0]]==idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00500}00500       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00501}00501       assert(i0!=3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00502}00502       i1   = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00503}00503       p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i1]]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00505}00505       ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00506}00506       uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00507}00507       uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00508}00508 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00509}00509       lispoi[3*k+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00510}00510       lispoi[3*k+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00511}00511       lispoi[3*k+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00512}00512     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00514}00514     \textcolor{comment}{/* last point : the half-\/ball is open : ilist tria, and ilist +1 points ;}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00515}00515 \textcolor{comment}{       lists are enumerated in direct order */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00516}00516     i2 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00517}00517     p2 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i2]]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00518}00518 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00519}00519     ux = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00520}00520     uy = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00521}00521     uz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00522}00522 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00523}00523     lispoi[3*ilist+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00524}00524     lispoi[3*ilist+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00525}00525     lispoi[3*ilist+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00526}00526 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00527}00527     \textcolor{comment}{/* At this point, lispoi contains all the points of the half-\/ball of p0, rotated}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00528}00528 \textcolor{comment}{       so that t\_\{p\_0\}S = [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00529}00529 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00530}00530     \textcolor{comment}{/* Rotated tangent vector (trot[2] = 0), and third direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00531}00531     trot[0] = r[0][0]*t[0] + r[0][1]*t[1] + r[0][2]*t[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00532}00532     trot[1] = r[1][0]*t[0] + r[1][1]*t[1] + r[1][2]*t[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00533}00533 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00534}00534     u[0] = -\/trot[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00535}00535     u[1] =  trot[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00537}00537     \textcolor{comment}{/* Travel half-\/ball at p0 and stop at first triangle containing u */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00538}00538     \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00539}00539       detg = lispoi[3*k+1]*u[1] -\/ lispoi[3*k+2]*u[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00540}00540       detd = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00541}00541       \textcolor{keywordflow}{if} ( detg > 0.0 \&\& detd > 0.0 )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00542}00542     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00543}00543 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00544}00544     \textcolor{comment}{/* If triangle not found, try with -\/u */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00545}00545     \textcolor{keywordflow}{if} ( k == ilist ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00546}00546       u[0] *= -\/1.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00547}00547       u[1] *= -\/1.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00548}00548 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00549}00549       \textcolor{keywordflow}{for} (k=0; k<ilist; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00550}00550         detg = lispoi[3*k+1]*u[1] -\/ lispoi[3*k+2]*u[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00551}00551         detd = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00552}00552         \textcolor{keywordflow}{if} ( detg > 0.0 \&\& detd > 0.0 )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00553}00553       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00554}00554     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00555}00555     \textcolor{keywordflow}{if} ( k == ilist )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00556}00556 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00557}00557     iel  = list[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00558}00558     ifac = list[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00559}00559     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00560}00560     \textcolor{keywordflow}{for} ( i0=0; i0!=3; ++i0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00561}00561       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i0]]==idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00562}00562     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00563}00563     assert(i0!=3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00564}00564 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00565}00565     assert( 0<=ifac \&\& ifac<4 \&\& \textcolor{stringliteral}{"{}unexpected local face idx"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00566}00566     \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,ifac,\&ptt);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00567}00567     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00568}00568     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00569}00569     \textcolor{keywordflow}{if} ( !MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&ptt,\&b,\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},ifac)) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00570}00570 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00571}00571     \textcolor{comment}{/* Barycentric coordinates of vector u in tria iel */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00572}00572     detg = lispoi[3*k+1]*u[1] -\/ lispoi[3*k+2]*u[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00573}00573     detd = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00574}00574     det = detg + detd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00575}00575     \textcolor{keywordflow}{if} ( det < \mbox{\hyperlink{eigenv__private_8h_a6cb898fb52de6878afc45c81fb376e62}{MMG5\_EPSD}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00576}00576 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00577}00577     det = 1.0 / det;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00578}00578     bcu[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00579}00579     bcu[1] = u[0]*lispoi[3*(k+1)+2] -\/ u[1]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00580}00580     bcu[1] *= det;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00581}00581     assert(bcu[1] <= 1.0);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00582}00582     bcu[2] = 1.0 -\/ bcu[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00583}00583 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00584}00584     \textcolor{comment}{/* Computation of tangent vector and second derivative of curve t \(\backslash\)mapsto}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00585}00585 \textcolor{comment}{       b(tbcu) (not in rotated frame) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00586}00586     m[i+1] = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[i+1],}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00587}00587                     \mbox{\hyperlink{anisosiz_8c_aaa4f68689c18c8010dc68875921911f0}{MMG5\_ridSizeInNormalDir}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},i0,bcu,\&b,isqhmin,isqhmax));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00588}00588   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00589}00589 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00590}00590   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00591}00591 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00592}00592 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00606}\mbox{\hyperlink{anisosiz__3d_8c_ade6b8fdfdc565dd724df08218b31b7a4}{00606}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_ade6b8fdfdc565dd724df08218b31b7a4}{MMG5\_defmetref}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int kel, \textcolor{keywordtype}{int} iface, \textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00607}00607   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00608}00608   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}  pxt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00609}00609   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}     ptt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00610}00610   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p0,p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00611}00611   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}  px0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00612}00612   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}   b;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00613}00613   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}     par;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00614}00614   MMG5\_int      lists[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00615}00615   int64\_t       listv[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00616}00616   \textcolor{keywordtype}{int}           k,ilists,ilistv,ilist;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00617}00617   MMG5\_int      iel,ipref[2],idp;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00618}00618   \textcolor{keywordtype}{int}           ifac,isloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00619}00619   \textcolor{keywordtype}{double}        *m,isqhmin,isqhmax,*n,r[3][3],lispoi[3*\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00620}00620   \textcolor{keywordtype}{double}        ux,uy,uz,det2d,c[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00621}00621   \textcolor{keywordtype}{double}        tAA[6],tAb[3], hausd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00622}00622   uint8\_t       i1,i2,itri1,itri2,i;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00623}00623   \textcolor{keyword}{static} int8\_t mmgWarn0=0,mmgWarn1=0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00624}00624 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00625}00625   ipref[0] = ipref[1] = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00626}00626   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[kel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00627}00627   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00628}00628   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00629}00629 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00630}00630   \textcolor{comment}{/* local parameters at vertex: useless for now because new points are created}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00631}00631 \textcolor{comment}{   * without reference (inside the domain) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00632}00632   hausd   = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00633}00633   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00634}00634   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00635}00635   isloc = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00637}00637   ilist = \mbox{\hyperlink{boulep__3d_8c_a3f949cd9117164c874ddfd40817d06a4}{MMG5\_boulesurfvolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},kel,ip,iface,listv,\&ilistv,lists,\&ilists,0);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00638}00638 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00639}00639   \textcolor{keywordflow}{if} ( ilist!=1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00640}00640     \textcolor{keywordflow}{if} ( !mmgWarn0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00641}00641       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00642}00642               \textcolor{stringliteral}{"{} unable to compute the ball of point\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00643}00643       mmgWarn0 = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00644}00644     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00645}00645     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00646}00646   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00647}00647 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00648}00648   \textcolor{comment}{/* travel across the ball of ip to find the minimal local params imposed on}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00649}00649 \textcolor{comment}{   * tetras */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00650}00650   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00651}00651     i = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00652}00652     \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00653}00653     \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00654}00654       \textcolor{keywordflow}{if} ( isloc )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00655}00655 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00656}00656       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00657}00657       \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00658}00658 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00659}00659       \textcolor{keywordflow}{for} ( k=0; k<ilistv; ++k ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00660}00660         pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[k]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00661}00661         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00662}00662           hausd   = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00663}00663           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00664}00664           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00665}00665           isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00666}00666           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00667}00667         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00668}00668       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00669}00669     \} \textcolor{keywordflow}{while} ( ++i<mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00670}00670 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00671}00671     \textcolor{keywordflow}{for} ( ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00672}00672       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00673}00673       \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00674}00674 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00675}00675       \textcolor{keywordflow}{for} ( k=0; k<ilistv; ++k ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00676}00676         pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[k]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00677}00677         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00678}00678           hausd   = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd  ,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00679}00679           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00680}00680           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00681}00681           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00682}00682         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00683}00683       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00684}00684     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00685}00685   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00686}00686 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00687}00687   \textcolor{comment}{/* Computation of the rotation matrix T\_p0 S -\/> [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00688}00688   assert( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} \&\& !\mbox{\hyperlink{mmgcommon__private_8h_a7d17f22a784b2da53dad4d1fa7785ce0}{MG\_SIN}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) \&\& \mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) \&\& !(\mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} \& p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00690}00690   px0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00691}00691 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00692}00692   n  = \&px0-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00693}00693   assert ( n[0]*n[0] + n[1]*n[1] + n[2]*n[2] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00694}00694 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00695}00695   \mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00696}00696   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00697}00697 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00698}00698   \textcolor{comment}{/* Apply rotation \(\backslash\)circ translation to the whole ball */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00699}00699   \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00700}00700     iel   = lists[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00701}00701     ifac  = lists[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00702}00702     pt    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00703}00703     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ifac] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00704}00704     pxt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00705}00705 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00706}00706     \textcolor{keywordflow}{for} ( i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00707}00707       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i]] == idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00708}00708     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00709}00709     assert(i<3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00710}00710 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00711}00711     \textcolor{comment}{// i0    = MMG5\_idir[ifac][i];}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00712}00712     itri1 = \mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00713}00713     i1    = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][itri1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00714}00714     itri2 = \mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00715}00715     i2    = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][itri2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00716}00716     p1    = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00718}00718     \textcolor{comment}{/* Store the two ending points of ref curves */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00719}00719     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} \& pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[ifac][itri1]] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00720}00720       \textcolor{keywordflow}{if} ( !ipref[0] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00721}00721         ipref[0] = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00722}00722       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00723}00723       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !ipref[1] \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i2] != ipref[0]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00724}00724         ipref[1] = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00725}00725       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00726}00726       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i2] != ipref[0]) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i2] != ipref[1]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00727}00727         \textcolor{keywordflow}{if} ( !mmgWarn1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00728}00728           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00729}00729                   \textcolor{stringliteral}{"{} non singular point at intersection of 3 ref edges.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00730}00730           mmgWarn1 = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00731}00731         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00732}00732         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00733}00733       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00734}00734     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00736}00736     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} \& pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_abccd1654d1bed57357e4ec20b66c3223}{tag}}[\mbox{\hyperlink{libmmg3d__private_8h_a9c9a38bc6b6bd37e70e1bdb3e5eb189e}{MMG5\_iarf}}[ifac][itri2]] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00737}00737       \textcolor{keywordflow}{if} ( !ipref[0] ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00738}00738         ipref[0] = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00739}00739       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00740}00740       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !ipref[1] \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1] != ipref[0]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00741}00741         ipref[1] = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00742}00742       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00743}00743       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1] != ipref[0]) \&\& (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1] != ipref[1]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00744}00744         \textcolor{keywordflow}{if} ( !mmgWarn1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00745}00745           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00746}00746                   \textcolor{stringliteral}{"{} non singular point at intersection of 3 ref edges.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00747}00747           mmgWarn1 = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00748}00748         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00749}00749         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00750}00750       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00751}00751     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00752}00752 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00753}00753     ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00754}00754     uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00755}00755     uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00756}00756 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00757}00757     lispoi[3*k+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00758}00758     lispoi[3*k+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00759}00759     lispoi[3*k+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00760}00760   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00761}00761 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00762}00762   \textcolor{comment}{/* list goes modulo ilist */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00763}00763   assert ( ilists >= 1 );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00764}00764   lispoi[3*ilists+1] =  lispoi[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00765}00765   lispoi[3*ilists+2] =  lispoi[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00766}00766   lispoi[3*ilists+3] =  lispoi[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00768}00768   \textcolor{comment}{/* Check all projections over tangent plane. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00769}00769   \textcolor{keywordflow}{for} (k=0; k<ilists-\/1; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00770}00770     det2d = lispoi[3*k+1]*lispoi[3*(k+1)+2] -\/ lispoi[3*k+2]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00771}00771     assert(det2d);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00772}00772     \textcolor{keywordflow}{if} ( det2d <= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00773}00773       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00774}00774     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00775}00775   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00776}00776   det2d = lispoi[3*(ilists-\/1)+1]*lispoi[3*0+2] -\/ lispoi[3*(ilists-\/1)+2]*lispoi[3*0+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00777}00777   assert(det2d);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00778}00778   \textcolor{keywordflow}{if} ( det2d <= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00779}00779     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00780}00780   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00781}00781   assert(ipref[0] \&\& ipref[1]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00783}00783   \textcolor{comment}{/* At this point, lispoi contains all the points of the ball of p0, rotated so}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00784}00784 \textcolor{comment}{     that t\_\{p\_0\}S = [z = 0], ipref1 and ipref2 are the indices of other ref}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00785}00785 \textcolor{comment}{     points. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00786}00786 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00787}00787   \textcolor{comment}{/* Second step : reconstitution of the curvature tensor at p0 in the tangent}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00788}00788 \textcolor{comment}{     plane, with a quadric fitting approach */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00789}00789   memset(tAA,0x00,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00790}00790   memset(tAb,0x00,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00791}00791 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00792}00792   \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00793}00793     \textcolor{comment}{/* Approximation of the curvature in the normal section associated to tau :}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00794}00794 \textcolor{comment}{       by assumption, p1 is either regular, either on a ridge (or a}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00795}00795 \textcolor{comment}{       singularity), but p0p1 is not ridge*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00796}00796     iel  = lists[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00797}00797     ifac = lists[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00798}00798     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00799}00799     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00800}00800     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00801}00801 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00802}00802     \textcolor{keywordflow}{for} ( i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00803}00803       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i]] == idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00804}00804     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00805}00805     assert(i<3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00806}00806 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00807}00807     \textcolor{comment}{// i0  = MMG5\_idir[ifac][i];}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00808}00808     \textcolor{comment}{// i1  = MMG5\_idir[ifac][MMG5\_inxt2[i]];}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00809}00809     assert( 0<=ifac \&\& ifac<4 \&\& \textcolor{stringliteral}{"{}unexpected local face idx"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00810}00810     \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,ifac,\&ptt);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00811}00811 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00812}00812     MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&ptt,\&b,\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},ifac));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00813}00813 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00814}00814     \textcolor{comment}{/* 1. Fill matrice tAA and second member tAb with \(\backslash\)f\$A=(\(\backslash\)sum X\_\{P\_i\}\string^2 \(\backslash\)sum}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00815}00815 \textcolor{comment}{     * Y\_\{P\_i\}\string^2 \(\backslash\)sum X\_\{P\_i\}Y\_\{P\_i\})\(\backslash\)f\$ and \(\backslash\)f\$b=\(\backslash\)sum Z\_\{P\_i\}\(\backslash\)f\$ with \(\backslash\)f\$P\_i\(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00816}00816 \textcolor{comment}{     * the physical points at edge [i0;i1] extremities and middle.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00817}00817 \textcolor{comment}{     *}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00818}00818 \textcolor{comment}{     * 2. Compute the physical coor \(\backslash\)a c of the curve edge's mid-\/point.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00819}00819 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00820}00820     \mbox{\hyperlink{anisosiz_8c_a358ab88c88f12024f1d2cf0d468b8efc}{MMG5\_fillDefmetregSys}}(k,p0,i,b,r,c,lispoi,tAA,tAb);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00821}00821 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00822}00822     \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00823}00823     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a04ba7031a8b9120d7be9df517c9fd509}{MG\_Tria}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00824}00824       \textcolor{keywordflow}{if} ( isloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00825}00825         \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00826}00826           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00827}00827 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00828}00828           \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ifac] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00829}00829             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00830}00830 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00831}00831           hausd   = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}},hausd);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00832}00832           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}},isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00833}00833           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}},isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00834}00834           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00835}00835         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00836}00836       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00837}00837       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00838}00838         \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00839}00839           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00840}00840 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00841}00841           \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ifac] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00842}00842             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00843}00843 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00844}00844           hausd   = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00845}00845           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00846}00846           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00847}00847           isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00848}00848           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00849}00849         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00850}00850       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00851}00851     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00852}00852   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00853}00853 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00854}00854   isqhmin = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00855}00855   isqhmax = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00856}00856 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00857}00857   \textcolor{comment}{/* Solve tAA * tmp\_m = tAb and fill m with tmp\_m (after rotation) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00858}00858   \textcolor{keywordflow}{return} \mbox{\hyperlink{anisosiz_8c_ad2b102344602e5af03a746c227bc2e9c}{MMG5\_solveDefmetrefSys}}( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}, p0, ipref, r, c, tAA, tAb, m,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00859}00859                                   isqhmin, isqhmax, hausd);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00860}00860 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00861}00861 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00875}\mbox{\hyperlink{anisosiz__3d_8c_a417548a6900869642ee1cb9a090f0233}{00875}} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a417548a6900869642ee1cb9a090f0233}{MMG5\_defmetreg}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int kel,\textcolor{keywordtype}{int} iface, \textcolor{keywordtype}{int} ip) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00876}00876   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}    pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00877}00877   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}   pxt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00878}00878   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}      ptt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00879}00879   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p0,p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00880}00880   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}   px0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00881}00881   \mbox{\hyperlink{structMMG5__Bezier}{MMG5\_Bezier}}    b;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00882}00882   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}      par;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00883}00883   MMG5\_int       lists[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00884}00884   int64\_t        listv[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00885}00885   \textcolor{keywordtype}{int}            k,ilist,ilists,ilistv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00886}00886   \textcolor{keywordtype}{int}            ifac,isloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00887}00887   MMG5\_int       iel,idp;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00888}00888   \textcolor{keywordtype}{double}         *n,*m,r[3][3],ux,uy,uz,lispoi[3*\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00889}00889   \textcolor{keywordtype}{double}         det2d,c[3],isqhmin,isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00890}00890   \textcolor{keywordtype}{double}         tAA[6],tAb[3],hausd;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00891}00891   uint8\_t        i1,i;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00892}00892   \textcolor{keyword}{static} int8\_t  mmgWarn = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00893}00893 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00894}00894   pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[kel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00895}00895   idp = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00896}00896   p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00897}00897 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00898}00898   \textcolor{comment}{/* local parameters at vertex */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00899}00899   hausd   = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_aea77197ca22e3eb72f97c56efbfc64a0}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00900}00900   isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00901}00901   isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00902}00902   isloc     = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00903}00903 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00904}00904   ilist = \mbox{\hyperlink{boulep__3d_8c_a3f949cd9117164c874ddfd40817d06a4}{MMG5\_boulesurfvolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},kel,ip,iface,listv,\&ilistv,lists,\&ilists,0);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00905}00905 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00906}00906   \textcolor{keywordflow}{if} ( ilist!=1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00907}00907     \textcolor{keywordflow}{if} ( !mmgWarn ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00908}00908       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: at least 1 metric not computed:"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00909}00909               \textcolor{stringliteral}{"{} unable to compute the ball of point.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00910}00910               \_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00911}00911       mmgWarn = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00912}00912     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00913}00913     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00914}00914   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00915}00915 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00916}00916   \textcolor{comment}{/* travel across the ball of ip to find the minimal local params imposed on}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00917}00917 \textcolor{comment}{   * tetras */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00918}00918   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00919}00919     i = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00920}00920     \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00921}00921     \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00922}00922       \textcolor{keywordflow}{if} ( isloc )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00923}00923 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00924}00924       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00925}00925       \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00926}00926 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00927}00927       \textcolor{keywordflow}{for} ( k=0; k<ilistv; ++k ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00928}00928         pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[k]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00929}00929         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00930}00930           hausd   = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00931}00931           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00932}00932           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00933}00933           isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00934}00934           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00935}00935         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00936}00936       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00937}00937     \} \textcolor{keywordflow}{while} ( ++i<mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00938}00938 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00939}00939     \textcolor{keywordflow}{for} ( ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00940}00940       par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00941}00941       \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00942}00942 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00943}00943       \textcolor{keywordflow}{for} ( k=0; k<ilistv; ++k ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00944}00944         pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[listv[k]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00945}00945         \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00946}00946           hausd   = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(hausd  ,par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00947}00947           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00948}00948           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00949}00949           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00950}00950         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00951}00951       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00952}00952     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00953}00953   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00954}00954 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00955}00955   \textcolor{comment}{/* Computation of the rotation matrix T\_p0 S -\/> [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00956}00956   assert( !(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad394a0b19c70b38093cc29e75b734cd1}{MG\_NOSURF}}) );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00957}00957   assert( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}} \&\& !\mbox{\hyperlink{mmgcommon__private_8h_a7d17f22a784b2da53dad4d1fa7785ce0}{MG\_SIN}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) \&\& !\mbox{\hyperlink{mmgcommon__private_8h_a52a1b183522115c52d6ca38f438221cb}{MG\_EDG}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) \&\& !(\mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}} \& p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00958}00958   px0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00959}00959 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00960}00960   n  = \&px0-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00961}00961   assert ( n[0]*n[0] + n[1]*n[1] + n[2]*n[2] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00962}00962 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00963}00963   \mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(n,r);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00964}00964   m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*idp];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00965}00965 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00966}00966   \textcolor{comment}{/* Apply rotation \(\backslash\)circ translation to the whole ball */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00967}00967   \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00968}00968     iel   = lists[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00969}00969     ifac  = lists[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00970}00970     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00971}00971     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} \&\& (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}].\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[ifac] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00972}00972 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00973}00973     \textcolor{keywordflow}{for} ( i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00974}00974       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i]] == idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00975}00975     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00976}00976     assert(i<3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00977}00977 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00978}00978     \textcolor{comment}{// i0 = MMG5\_idir[ifac][i];}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00979}00979     i1 = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[i]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00980}00980     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[i1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00981}00981 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00982}00982     ux = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00983}00983     uy = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00984}00984     uz = p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p0-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00985}00985 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00986}00986     lispoi[3*k+1] =  r[0][0]*ux + r[0][1]*uy + r[0][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00987}00987     lispoi[3*k+2] =  r[1][0]*ux + r[1][1]*uy + r[1][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00988}00988     lispoi[3*k+3] =  r[2][0]*ux + r[2][1]*uy + r[2][2]*uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00989}00989   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00990}00990 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00991}00991   \textcolor{comment}{/* list goes modulo ilist */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00992}00992   assert ( ilists >= 1 );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00993}00993   lispoi[3*ilists+1] =  lispoi[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00994}00994   lispoi[3*ilists+2] =  lispoi[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00995}00995   lispoi[3*ilists+3] =  lispoi[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00996}00996 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00997}00997   \textcolor{comment}{/* Check all projections over tangent plane. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00998}00998   \textcolor{keywordflow}{for} (k=0; k<ilists-\/1; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l00999}00999     det2d = lispoi[3*k+1]*lispoi[3*(k+1)+2] -\/ lispoi[3*k+2]*lispoi[3*(k+1)+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01000}01000     assert(det2d);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01001}01001     \textcolor{keywordflow}{if} ( det2d <= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01002}01002       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01003}01003     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01004}01004   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01005}01005   det2d = lispoi[3*(ilists-\/1)+1]*lispoi[3*0+2] -\/ lispoi[3*(ilists-\/1)+2]*lispoi[3*0+1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01006}01006   assert(det2d);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01007}01007   \textcolor{keywordflow}{if} ( det2d <= 0.0 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01008}01008     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01009}01009   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01010}01010 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01011}01011   \textcolor{comment}{/* At this point, lispoi contains all the points of the ball of p0, rotated}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01012}01012 \textcolor{comment}{     so that t\_\{p\_0\}S = [z = 0] */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01013}01013 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01014}01014   \textcolor{comment}{/* Second step : reconstitution of the curvature tensor at p0 in the tangent}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01015}01015 \textcolor{comment}{     plane, with a quadric fitting approach */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01016}01016   memset(tAA,0x00,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01017}01017   memset(tAb,0x00,3*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01018}01018 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01019}01019   \textcolor{keywordflow}{for} (k=0; k<ilists; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01020}01020     \textcolor{comment}{/* Approximation of the curvature in the normal section associated to tau :}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01021}01021 \textcolor{comment}{       by assumption, p1 is either regular, either on a ridge (or a}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01022}01022 \textcolor{comment}{       singularity), but p0p1 is not ridge*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01023}01023     iel  = lists[k] / 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01024}01024     ifac = lists[k] \% 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01025}01025     pt  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[iel];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01026}01026     assert(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01027}01027     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01028}01028 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01029}01029     \textcolor{keywordflow}{for} ( i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01030}01030       \textcolor{keywordflow}{if} ( pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[ifac][i]] == idp ) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01031}01031     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01032}01032     assert(i<3);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01033}01033 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01034}01034     \textcolor{comment}{// i0  = MMG5\_idir[ifac][i];}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01035}01035     \textcolor{comment}{// i1  = MMG5\_idir[ifac][MMG5\_inxt2[i]];}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01036}01036     assert( 0<=ifac \&\& iface<4 \&\& \textcolor{stringliteral}{"{}unexpected local face idx"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01037}01037     \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},iel,ifac,\&ptt);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01038}01038 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01039}01039     MMG5\_bezierCP(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&ptt,\&b,\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},ifac));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01040}01040 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01041}01041     \textcolor{comment}{/* 1. Fill matrice tAA and second member tAb with \(\backslash\)f\$A=(\(\backslash\)sum X\_\{P\_i\}\string^2 \(\backslash\)sum}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01042}01042 \textcolor{comment}{     * Y\_\{P\_i\}\string^2 \(\backslash\)sum X\_\{P\_i\}Y\_\{P\_i\})\(\backslash\)f\$ and \(\backslash\)f\$b=\(\backslash\)sum Z\_\{P\_i\}\(\backslash\)f\$ with P\_i the}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01043}01043 \textcolor{comment}{     * physical points at edge [i0;i1] extremities and middle.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01044}01044 \textcolor{comment}{     *}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01045}01045 \textcolor{comment}{     * 2. Compute the physical coor \(\backslash\)a c of the curve edge's mid-\/point.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01046}01046 \textcolor{comment}{     */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01047}01047     \mbox{\hyperlink{anisosiz_8c_a358ab88c88f12024f1d2cf0d468b8efc}{MMG5\_fillDefmetregSys}}(k,p0,i,b,r,c,lispoi,tAA,tAb);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01048}01048 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01049}01049     \textcolor{comment}{/* local parameters */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01050}01050     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a04ba7031a8b9120d7be9df517c9fd509}{MG\_Tria}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01051}01051       \textcolor{keywordflow}{if} ( isloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01052}01052         \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01053}01053           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01054}01054 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01055}01055           \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ifac] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01056}01056             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01057}01057 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01058}01058           hausd   = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}},hausd);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01059}01059           isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}},isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01060}01060           isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}},isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01061}01061           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01062}01062         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01063}01063       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01064}01064       \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01065}01065         \textcolor{keywordflow}{for} ( i=0; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01066}01066           par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01067}01067 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01068}01068           \textcolor{keywordflow}{if} ( (par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a94652021b3e56b7ae7859bbcbe22f155}{MMG5\_Triangle}}) || (pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ae92e68266c6b24d68166db4b2d029636}{ref}}[ifac] != par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} ) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01069}01069             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01070}01070 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01071}01071           hausd   = par-\/>\mbox{\hyperlink{structMMG5__Par_a71e2acd5f8c9ca6010537a79ed7adbfd}{hausd}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01072}01072           isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01073}01073           isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01074}01074           isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01075}01075           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01076}01076         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01077}01077       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01078}01078     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01079}01079   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01080}01080 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01081}01081   isqhmin = 1.0 / (isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01082}01082   isqhmax = 1.0 / (isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01083}01083 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01084}01084   \textcolor{comment}{/* Solve tAA * tmp\_m = tAb and fill m with tmp\_m (after rotation) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01085}01085   \textcolor{keywordflow}{return} \mbox{\hyperlink{anisosiz_8c_a640fc325aa0613ceed42a7b3cfc5ca10}{MMG5\_solveDefmetregSys}}( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},r, c, tAA, tAb, m, isqhmin, isqhmax,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01086}01086                                   hausd);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01087}01087 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01088}01088 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01100}01100 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01101}\mbox{\hyperlink{anisosiz__3d_8c_af084519701e3d6eadaed77f866ea3205}{01101}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_af084519701e3d6eadaed77f866ea3205}{MMG5\_defmetvol}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,int8\_t ismet) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01102}01102   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt,ptloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01103}01103   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01104}01104   \mbox{\hyperlink{structMMG5__Par}{MMG5\_pPar}}     par;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01105}01105   \textcolor{keywordtype}{double}        isqhmax,isqhmin,*m;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01106}01106   MMG5\_int      k,ip;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01107}01107   int64\_t       list[\mbox{\hyperlink{libmmg3d_8h_a20d684d2ff6e4b30a4627db269e88e89}{MMG3D\_LMAX}}+2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01108}01108   \textcolor{keywordtype}{int}           l,i,j,isloc,ilist;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01109}01109 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01110}01110   isqhmin = 1./(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}}*\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01111}01111   isqhmax = 1./(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}}*\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01112}01112 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01113}01113   \textcolor{keywordflow}{if} ( !ismet ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01114}01114 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01115}01115     \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01116}01116       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01117}01117       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01118}01118 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01119}01119       \textcolor{keywordflow}{for} ( l=0; l<4; ++l ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01120}01120 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01121}01121         ip = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[l];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01122}01122         ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01123}01123         \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} || ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} || !\mbox{\hyperlink{mmgcommon__private_8h_aacf41a0e0a3fdf65d77fa5a97fa83bce}{MG\_VOK}}(ppt) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01124}01124 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01128}01128         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01129}01129           isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01130}01130           isloc   = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01131}01131 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01132}01132           \textcolor{comment}{/* Local parameters at tetra */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01133}01133           \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01134}01134             ilist = \mbox{\hyperlink{boulep__3d_8c_a3413ba7be6f4ae2955ce4072471daf00}{MMG5\_boulevolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,l,list);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01135}01135 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01136}01136             i = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01137}01137             \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01138}01138             \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01139}01139               \textcolor{keywordflow}{if} ( isloc )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01141}01141               par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01142}01142               \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01143}01143 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01144}01144               \textcolor{keywordflow}{for} ( j=0; j<ilist; ++j ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01145}01145                 ptloc = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[j]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01146}01146                 \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == ptloc-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01147}01147                   isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01148}01148                   isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01149}01149                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01150}01150                 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01151}01151               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01152}01152             \} \textcolor{keywordflow}{while} ( ++i<mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01153}01153 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01154}01154             \textcolor{keywordflow}{for} ( ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01155}01155               par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01156}01156               \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01157}01157 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01158}01158               \textcolor{keywordflow}{for} ( j=0; j<ilist; ++j ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01159}01159                 ptloc = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[j]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01160}01160                 \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == ptloc-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01161}01161                   isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01162}01162                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01163}01163                 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01164}01164               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01165}01165             \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01166}01166           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01167}01167           isqhmax = 1./(isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01168}01168         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01169}01169 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01171}01171         m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[met-\/>\mbox{\hyperlink{structMMG5__Sol_a1aacf473a7ba4fb5fbc004f2e0b447a8}{size}}*ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01172}01172         m[0] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01173}01173         m[1] = 0.;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01174}01174         m[2] = 0.;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01175}01175         m[3] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01176}01176         m[4] = 0.;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01177}01177         m[5] = isqhmax;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01178}01178         ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01179}01179       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01180}01180     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01181}01181     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01182}01182   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01183}01183 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01185}01185   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01186}01186     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01187}01187     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01188}01188 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01189}01189     \textcolor{keywordflow}{for} ( l=0; l<4; ++l ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01190}01190 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01191}01191       ip = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[l];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01192}01192       ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01193}01193       \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} || ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} || !\mbox{\hyperlink{mmgcommon__private_8h_aacf41a0e0a3fdf65d77fa5a97fa83bce}{MG\_VOK}}(ppt) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01194}01194 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01196}01196       \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01197}01197         isqhmin = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a4874acf5ce0475bd5da312b657a1537a}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01198}01198         isqhmax = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a86382948e4bb3afa6b1acd6e9f1c9e33}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01199}01199         isloc   = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01200}01200 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01201}01201         \textcolor{comment}{/* Local parameters at tetra */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01202}01202         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a0968088ab75b646fba8ec11e18feab17}{parTyp}} \& \mbox{\hyperlink{mmgcommon__private_8h_a87279271d5a0ab7e910dcc2564772e40}{MG\_Tetra}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01203}01203           ilist = \mbox{\hyperlink{boulep__3d_8c_a3413ba7be6f4ae2955ce4072471daf00}{MMG5\_boulevolp}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,l,list);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01204}01204 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01205}01205           i = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01206}01206           \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01207}01207           \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01208}01208             \textcolor{keywordflow}{if} ( isloc )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01209}01209 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01210}01210             par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01211}01211             \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01212}01212 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01213}01213             \textcolor{keywordflow}{for} ( j=0; j<ilist; ++j ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01214}01214               ptloc = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[j]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01215}01215               \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == ptloc-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01216}01216                 isqhmin = par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01217}01217                 isqhmax = par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01218}01218                 isloc   = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01219}01219                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01220}01220               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01221}01221             \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01222}01222           \} \textcolor{keywordflow}{while} ( ++i<mesh-\/>\mbox{\hyperlink{boulep_8c_a6f965dc34f7deedba7598e47c401773a}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01223}01223 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01224}01224           \textcolor{keywordflow}{for} ( ; i<\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a654edb4d3aefbe2520fcd1521d4aa24a}{npar}}; ++i ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01225}01225             par = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acf939feb46b6808cfbb6a3eedf564b28}{par}}[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01226}01226             \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a88620e06e3aed9bd53fba9de848f1058}{elt}} != \mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a518156516da9d5ed4ecd6beae620fbf3}{MMG5\_Tetrahedron}} ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01227}01227 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01228}01228             \textcolor{keywordflow}{for} ( j=0; j<ilist; ++j ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01229}01229               ptloc = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[list[j]/4];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01230}01230               \textcolor{keywordflow}{if} ( par-\/>\mbox{\hyperlink{structMMG5__Par_a7fdb13a1db56feda017b3b33594eb0f5}{ref}} == ptloc-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01231}01231                 isqhmin = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(isqhmin,par-\/>\mbox{\hyperlink{structMMG5__Par_a1abd0ece1f28aa197ded412079662f3c}{hmin}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01232}01232                 isqhmax = \mbox{\hyperlink{mmgcommon__private_8h_a47564b6d8ab05c15ec56c2717be4c539}{MG\_MIN}}(isqhmax,par-\/>\mbox{\hyperlink{structMMG5__Par_a1aeb2bb6c6f431ba02db3b03a980ae96}{hmax}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01233}01233                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01234}01234               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01235}01235             \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01236}01236           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01237}01237         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01238}01238         isqhmin = 1./(isqhmin*isqhmin);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01239}01239         isqhmax = 1./(isqhmax*isqhmax);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01240}01240       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01242}01242 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01244}01244       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a69b74609f172b1998a6f17cc724040da}{MMG5\_truncate\_met3d}}(met,ip,isqhmin,isqhmax) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01245}01245         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01246}01246       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01247}01247     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01248}01248   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01249}01249 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01250}01250   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01251}01251 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01252}01252 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01266}01266 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01267}\mbox{\hyperlink{anisosiz__3d_8c_a02abc3cb11382d722917057847bf7dd9}{01267}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a02abc3cb11382d722917057847bf7dd9}{MMG3D\_intextmet}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,\textcolor{keywordtype}{int} np,\textcolor{keywordtype}{double} me[6]) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01268}01268   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}         p0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01269}01269   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}}        go;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01270}01270   \textcolor{keywordtype}{double}              *n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01271}01271   \textcolor{keywordtype}{double}              dummy\_n[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01272}01272 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01273}01273    p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01274}01274 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01275}01275    dummy\_n[0] = dummy\_n[1] = dummy\_n[2] = 0.;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01276}01276 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01277}01277    \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a7d17f22a784b2da53dad4d1fa7785ce0}{MG\_SIN}}(p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) || (p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ad4f5aeeaf0e3b7260e75d2d90df0de57}{MG\_NOM}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01278}01278      n = \&dummy\_n[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01279}01279    \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01280}01280    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01281}01281      \textcolor{comment}{/* Take the tangent at point */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01282}01282      n = \&p0-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01283}01283    \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01284}01284    \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01285}01285      \textcolor{comment}{/* Take the normal at point */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01286}01286      assert(p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01287}01287      go = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[p0-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01288}01288      n = \&go-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01289}01289    \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01290}01290 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01291}01291   \textcolor{keywordflow}{return} \mbox{\hyperlink{mettools_8c_af1fd6bc7220f4272d9b7ddc986ddecae}{MMG5\_mmgIntextmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np,me,n);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01292}01292 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01293}01293 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01294}01294 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01310}\mbox{\hyperlink{anisosiz__3d_8c_ae3ce47622fd4da79a80c613dba30ee69}{01310}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_ae3ce47622fd4da79a80c613dba30ee69}{MMG3D\_defsiz\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01311}01311   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01312}01312   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}  pxt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01313}01313   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01314}01314   \textcolor{keywordtype}{double}        mm[6];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01315}01315   MMG5\_int      k,l;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01316}01316   \textcolor{keywordtype}{int}           iploc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01317}01317   int8\_t        ismet;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01318}01318   int8\_t        i;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01319}01319   \textcolor{keyword}{static} int8\_t mmgErr = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01320}01320 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01321}01321   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{isosiz_8c_ad25b7ab5d3a3918c7682ae506c608a9d}{MMG5\_defsiz\_startingMessage}} (\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\_\_func\_\_) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01322}01322     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01323}01323   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01324}01324 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01325}01325   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01326}01326     ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01327}01327     ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01328}01328     ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}}    = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01329}01329   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01330}01330 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01331}01331   \textcolor{keywordflow}{if} ( !met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01332}01332     ismet = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01333}01333 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01334}01334     \textcolor{comment}{/* Allocate and store the header informations for each solution */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01335}01335     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functions__3d_8c_af7978b4a1e67dd1f7984b1635a48278e}{MMG3D\_Set\_solSize}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\mbox{\hyperlink{libmmgtypes_8h_ad7dceff255dbd127a2b7ff2ceb8d9ba6a3e0b7e1298beaabada671bf465c477c2}{MMG5\_Vertex}},\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}},3) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01336}01336       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01337}01337     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01338}01338 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01339}01339     MMG5\_caltet         = \mbox{\hyperlink{inlined__functions__3d__private_8h_a1a1913928c768980aeda203bfd4c46d5}{MMG5\_caltet\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01340}01340     MMG5\_caltri         = \mbox{\hyperlink{mmgcommon__private_8h_a257694db1d155b5804f67269f3c3b720}{MMG5\_caltri\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01341}01341     MMG5\_lenedg         = \mbox{\hyperlink{inlined__functions__3d__private_8h_abf16f8d816cf2760ef7fc45c3a2eff3e}{MMG5\_lenedg\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01342}01342     \mbox{\hyperlink{libmmg3d_8h_a119283ba53b55fb73dd8a1883ecf90b5}{MMG3D\_lenedgCoor}}    = \mbox{\hyperlink{inlined__functions__3d__private_8h_ac91e5536b465bab23f8cf3ee7c63fc4f}{MMG5\_lenedgCoor\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01343}01343     MMG5\_lenSurfEdg     = \mbox{\hyperlink{inlined__functions__private_8h_ae37ac28bb21ba156ef9d26e102646992}{MMG5\_lenSurfEdg\_ani}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01344}01344   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01345}01345   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01346}01346     ismet = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01347}01347   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01348}01348 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01352}01352   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_acebd56495a75526756faed8644f42c49}{nosizreq}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01353}01353     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{isosiz__3d_8c_a70d7636a6f38435a4fb06a8f3a57232e}{MMG3D\_set\_metricAtPointsOnReqEdges}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ismet ) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01354}01354       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01355}01355     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01356}01356   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01357}01357 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01358}01358   \textcolor{comment}{/* Step 2: metric definition at internal points */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01359}01359   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_af084519701e3d6eadaed77f866ea3205}{MMG5\_defmetvol}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ismet) )  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01360}01360 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01361}01361   \textcolor{comment}{/* Step 3: metric definition at boundary points */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01362}01362   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01363}01363     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01364}01364     \textcolor{comment}{// Warning: why are we skipped the tetra with negative refs ?}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01365}01365     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) || pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a8a8d5a31755031e61b2b6a9c9bd50030}{ref}} < 0 || (pt-\/>\mbox{\hyperlink{structMMG5__Tetra_af7412e84b91071f463b86eaf3ffd91d0}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a05cee83c76c35ad01e5bef497a19f46f}{MG\_REQ}}) )   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01366}01366     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01367}01367 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01368}01368     pxt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01369}01369     \textcolor{keywordflow}{for} (l=0; l<4; l++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01370}01370       \textcolor{keywordflow}{if} ( !(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[l] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01371}01371       \textcolor{comment}{// In multidomain case, acces the face through a tetra for which it is}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01372}01372       \textcolor{comment}{// well oriented.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01373}01373       \textcolor{keywordflow}{if} ( !(\mbox{\hyperlink{mmgcommon__private_8h_a98d96c33ef53e4ebebaeff3da5148d48}{MG\_GET}}(pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_ad34ec257f0d9e690c9bf9c63be5cecc6}{ori}},l)) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01374}01374 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01375}01375       \textcolor{keywordflow}{for} (i=0; i<3; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01376}01376         iploc = \mbox{\hyperlink{libmmg3d__private_8h_af212a0ccfb4cac141ea2e3d0e2227c28}{MMG5\_idir}}[l][i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01377}01377         ppt   = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iploc]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01378}01378 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01379}01379         \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_aacf41a0e0a3fdf65d77fa5a97fa83bce}{MG\_VOK}}(ppt) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01380}01380 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01381}01381         \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} > 1 ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01382}01382 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01383}01383         \textcolor{keywordflow}{if} ( ismet )  memcpy(mm,\&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*(pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iploc])],6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01384}01384 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01385}01385         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01386}01386           \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_a6bb3f73ec3910c7b3bcbf6c0670059c9}{MMG5\_defmetsin}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,l,iploc) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01387}01387         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01388}01388         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01389}01389           \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_afc91ba97a6cfdcd31d5dbbeb8bb5e781}{MMG5\_defmetrid}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,l,iploc))  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01390}01390         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01391}01391         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_aed4613c0f3a1afbcea3325f68c87989d}{MG\_REF}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01392}01392           \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_ade6b8fdfdc565dd724df08218b31b7a4}{MMG5\_defmetref}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,l,iploc) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01393}01393         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01394}01394           \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_a417548a6900869642ee1cb9a090f0233}{MMG5\_defmetreg}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,k,l,iploc) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01395}01395         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01396}01396         \textcolor{keywordflow}{if} ( ismet ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01397}01397           \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_a02abc3cb11382d722917057847bf7dd9}{MMG3D\_intextmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iploc],mm) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01398}01398             \textcolor{keywordflow}{if} ( !mmgErr ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01399}01399               fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to intersect metrics"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01400}01400                       \textcolor{stringliteral}{"{} at point \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{}.\(\backslash\)n"{}},\_\_func\_\_,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01401}01401                       \mbox{\hyperlink{libmmg3d__private_8h_a65904affc75ac27472661e9d04e7c5fa}{MMG3D\_indPt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[iploc]));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01402}01402               mmgErr = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01403}01403             \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01404}01404             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01405}01405           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01406}01406         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01407}01407         ppt-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = 2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01408}01408       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01409}01409     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01410}01410   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01411}01411   \textcolor{comment}{/* Now the metric storage at ridges is the "{}mmg"{} one. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01412}01412   \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a83364b3f6629f77eeb3761c0bd508edc}{metRidTyp}} = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01413}01413 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01414}01414   \textcolor{comment}{/* search for unintialized metric */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01415}01415   \mbox{\hyperlink{anisosiz_8c_a8cbf7130be23d609bcc515b0c4c5351a}{MMG5\_defUninitSize}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ismet);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01416}01416 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01417}01417   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01418}01418 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01419}01419 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01438}01438 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01439}\mbox{\hyperlink{anisosiz__3d_8c_aa9c073b6ce584703d4fabd1520be7fb1}{01439}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_aa9c073b6ce584703d4fabd1520be7fb1}{MMG5\_grad2metVol\_getmet}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,MMG5\_int ip,\textcolor{keywordtype}{double} ux,\textcolor{keywordtype}{double} uy,\textcolor{keywordtype}{double} uz,\textcolor{keywordtype}{double} *m,int8\_t *ridgedir) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01440}01440   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}  ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01441}01441   \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}} pxp;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01442}01442   \textcolor{keywordtype}{double} *mm,*nn1,*nn2,rbasis[3][3],ps1,ps2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01443}01443 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01444}01444   ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01445}01445   mm  = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01446}01446 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01447}01447 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01448}01448   \textcolor{keywordflow}{if}( \mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) )\{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01449}01449 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01450}01450     \textcolor{comment}{/* no normal, no tangent plane */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01451}01451     memcpy(m,mm,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01452}01452 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01453}01453   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01454}01454   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01455}01455 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01456}01456     \textcolor{comment}{/* Recover normal and metric */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01457}01457     pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01458}01458     nn1 = pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01459}01459     nn2 = pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01460}01460     ps1 = ux*nn1[0] + uy*nn1[1] + uz*nn1[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01461}01461     ps2 = ux*nn2[0] + uy*nn2[1] + uz*nn2[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01462}01462     \textcolor{keywordflow}{if} ( fabs(ps2)<fabs(ps1) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01463}01463       *ridgedir = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01464}01464     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01465}01465     \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01466}01466       *ridgedir = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01467}01467     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01468}01468     \textcolor{comment}{/* Note that rbasis is not used in this function */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01469}01469     \textcolor{keywordflow}{if}( !\mbox{\hyperlink{mettools_8c_ab9abc1963a552fd343bc5c27a753a58a}{MMG5\_buildridmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,ip,ux,uy,uz,m,rbasis) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01470}01470       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01471}01471 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01472}01472   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01473}01473   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01474}01474     memcpy(m,mm,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01475}01475   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01476}01476   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01477}01477 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01478}01478     \textcolor{comment}{/* internal point */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01479}01479     memcpy(m,mm,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01480}01480 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01481}01481   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01482}01482 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01483}01483   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01484}01484 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01485}01485 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01497}01497 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01498}\mbox{\hyperlink{anisosiz__3d_8c_ae741a40efcf3b89ac63d356515ae5899}{01498}} \textcolor{keywordtype}{void} \mbox{\hyperlink{anisosiz__3d_8c_ae741a40efcf3b89ac63d356515ae5899}{MMG5\_grad2metVol\_extmet}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} ppt,\textcolor{keywordtype}{double} l,\textcolor{keywordtype}{double} *m,\textcolor{keywordtype}{double} *mext) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01499}01499   \textcolor{keywordtype}{double} lambda[3],vp[3][3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01500}01500 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01501}01501   \mbox{\hyperlink{eigenv_8c_a33a2a006517b178fa2dfeb28f38a0d53}{MMG5\_eigenv3d}}(1,m,lambda,vp);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01502}01502   \textcolor{keywordflow}{for}( int8\_t i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01503}01503     \textcolor{keywordtype}{double} hext = 1./sqrt(lambda[i]) + \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a61dba6868b2752cab22a2dc59d2e8104}{hgrad}}*l + \mbox{\hyperlink{mmgcommon__private_8h_a1e26cddefcd1ee56395167b28bb92330}{MMG5\_EPSOK}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01504}01504     lambda[i] = 1./(hext*hext);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01505}01505   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01506}01506   \mbox{\hyperlink{mettools_8c_a310805b24127071c63eda31c81991f56}{MMG5\_eigenvmatsym3d}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},mext,lambda,vp);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01507}01507 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01508}01508 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01509}01509 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01533}01533 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01534}\mbox{\hyperlink{anisosiz__3d_8c_aad21961f90b9120587647f669ba6e326}{01534}} \textcolor{keywordtype}{void} \mbox{\hyperlink{anisosiz__3d_8c_aad21961f90b9120587647f669ba6e326}{MMG3D\_gradSimred}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} ppt,\textcolor{keywordtype}{double} m[6],\textcolor{keywordtype}{double} mext[6],int8\_t ridgedir,int8\_t iloc,\textcolor{keywordtype}{int} *\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}}) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01535}01535   \textcolor{keywordtype}{double} tol = \mbox{\hyperlink{eigenv__private_8h_ac8c37cc50aa41bddbfbba868a1a6aa3c}{MMG5\_EPS}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01536}01536 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01537}01537   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01538}01538     \textcolor{keywordtype}{double} dm[3],dmext[3],vp[3][3],beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01539}01539 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01540}01540     \textcolor{comment}{/* Simultaneous reduction basis */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01541}01541     \textcolor{keywordflow}{if}( !\mbox{\hyperlink{anisosiz_8c_a731bd60efc63d28f8485a333f235987d}{MMG5\_simred3d}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},m,mext,dm,dmext,vp) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01542}01542       *\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01543}01543       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01544}01544     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01545}01545     beta = 1.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01546}01546     \textcolor{comment}{/* Compute maximum size variation */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01547}01547     \textcolor{keywordflow}{for}( int8\_t i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01548}01548       beta = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(beta,dmext[i]/dm[i]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01549}01549     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01550}01550     \textcolor{keywordflow}{if}( beta > 1.0 + tol ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01551}01551       (*ier) = (*ier) | iloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01552}01552     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01553}01553     \textcolor{keywordflow}{if}( (*\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}}) \& iloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01554}01554       \textcolor{comment}{/* You have to homothetically scale the metric in order to make it}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01555}01555 \textcolor{comment}{       * consistent with the above check and for the gradation loop to converge.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01556}01556 \textcolor{comment}{       * Change the gradation law in the metric extension in}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01557}01557 \textcolor{comment}{       * MMG5\_grad2metVol\_extmet if you want to restrict the influence of}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01558}01558 \textcolor{comment}{       * singular points. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01559}01559       m[0] *= beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01560}01560       m[3] *= beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01561}01561       m[5] *= beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01562}01562     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01563}01563 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01564}01564   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01565}01565   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01566}01566     \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}} pxp;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01567}01567     \textcolor{keywordtype}{double} mr[6],mrext[6],dm[3],dmext[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01568}01568     \textcolor{keywordtype}{double} u[3],r[3][3],*t,*n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01569}01569 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01570}01570     \textcolor{comment}{/* Compute ridge orthonormal basis (t, n x t, n) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01571}01571     t = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01572}01572     pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01573}01573     \textcolor{keywordflow}{if}( ridgedir )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01574}01574       n = pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01575}01575     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01576}01576       n = pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01577}01577     \mbox{\hyperlink{mmgcommon__private_8h_adc70cb182809cbf96349afc2b0f64136}{MMG5\_crossprod3d}}(n,t,u);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01578}01578     \textcolor{comment}{/* Store basis in rotation matrix */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01579}01579     \textcolor{keywordflow}{for}( int8\_t i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01580}01580       r[0][i] = t[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01581}01581       r[1][i] = u[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01582}01582       r[2][i] = n[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01583}01583     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01584}01584     \textcolor{comment}{/* Rotate matrices to the ridge reference system */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01585}01585     \mbox{\hyperlink{mmgcommon__private_8h_a83635a3fa94abc3f03bf6c303e055500}{MMG5\_rmtr}}(r,m,mr);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01586}01586     dm[0] = mr[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01587}01587     dm[1] = mr[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01588}01588     dm[2] = mr[5];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01589}01589     \mbox{\hyperlink{mmgcommon__private_8h_a83635a3fa94abc3f03bf6c303e055500}{MMG5\_rmtr}}(r,mext,mrext);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01590}01590     dmext[0] = mrext[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01591}01591     dmext[1] = mrext[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01592}01592     dmext[2] = mrext[5];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01593}01593     \textcolor{comment}{/* The ridge metrics is diagonal and must remain diagonal, while the}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01594}01594 \textcolor{comment}{     * extended metric from the other point  is not necessarily diagonal in the}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01595}01595 \textcolor{comment}{     * ridge basis. Do not perform intersection, but simply evaluate lengths on}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01596}01596 \textcolor{comment}{     * the ridge basis and truncate sizes. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01597}01597     \textcolor{keywordflow}{for}( int8\_t i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01598}01598       \textcolor{keywordflow}{if}( dmext[i] > dm[i]*(1.0 + tol) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01599}01599         dm[i] = dmext[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01600}01600         (*ier) = (*ier) | iloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01601}01601       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01602}01602     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01603}01603     \textcolor{comment}{/* Update metric */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01604}01604     \textcolor{keywordflow}{if}( (*\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}}) \& iloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01605}01605       \textcolor{comment}{/* Re-\/build matrix */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01606}01606       \mbox{\hyperlink{mettools_8c_a310805b24127071c63eda31c81991f56}{MMG5\_eigenvmatsym3d}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},m,dm,r);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01607}01607     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01608}01608 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01609}01609   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01610}01610   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01611}01611     \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}} pxp;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01612}01612     \textcolor{keywordtype}{double} mr[6],mrext[6],mtan[3],mtanext[3],r[3][3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01613}01613     \textcolor{keywordtype}{double} dm[3],dmext[3],vp[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01614}01614 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01615}01615     \textcolor{comment}{/* Rotation matrices mapping n to e\_3 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01616}01616     pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01617}01617     \mbox{\hyperlink{mmgcommon__private_8h_ac3e49574efef1e50f5899e2b985fdf6b}{MMG5\_rotmatrix}}(pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}},r);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01618}01618 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01619}01619     \textcolor{comment}{/* Rotate metrics to the tangent plane */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01620}01620     \mbox{\hyperlink{mmgcommon__private_8h_a83635a3fa94abc3f03bf6c303e055500}{MMG5\_rmtr}}(r,m,mr);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01621}01621     mtan[0] = mr[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01622}01622     mtan[1] = mr[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01623}01623     mtan[2] = mr[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01624}01624     \mbox{\hyperlink{mmgcommon__private_8h_a83635a3fa94abc3f03bf6c303e055500}{MMG5\_rmtr}}(r,mext,mrext);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01625}01625     mtanext[0] = mrext[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01626}01626     mtanext[1] = mrext[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01627}01627     mtanext[2] = mrext[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01628}01628     \textcolor{comment}{/* The current point metric is aligned with the surface normal direction,}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01629}01629 \textcolor{comment}{     * while the extended metric from the other point need not.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01630}01630 \textcolor{comment}{     * Perform intersection only in the tangent plane, while simply truncate}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01631}01631 \textcolor{comment}{     * sizes in the normal direction.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01632}01632 \textcolor{comment}{     *}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01633}01633 \textcolor{comment}{     * Simultaneous reduction basis */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01634}01634     \textcolor{keywordflow}{if}( !\mbox{\hyperlink{anisosiz_8c_ad18fde566010b42cd9f6df682bbe78fb}{MMG5\_simred2d}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},mtan,mtanext,dm,dmext,vp) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01635}01635       *\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01636}01636       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01637}01637     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01638}01638     \textcolor{comment}{/* Intersection in the tangent plane */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01639}01639     \textcolor{keywordflow}{for}( int8\_t i = 0; i < 2; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01640}01640       \textcolor{keywordflow}{if}( dmext[i] > dm[i]*(1.0 + tol) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01641}01641         dm[i] = dmext[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01642}01642         (*ier) = (*ier) | iloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01643}01643       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01644}01644     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01645}01645     \textcolor{comment}{/* The current point metric is aligned with the surface normal direction,}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01646}01646 \textcolor{comment}{     * while the extended metric from the other point need not.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01647}01647 \textcolor{comment}{     * Simply evaluate lengths in the normal direction and truncate sizes. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01648}01648     dm[2]    = mr[5];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01649}01649     dmext[2] = mrext[5];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01650}01650     \textcolor{keywordflow}{if}( dmext[2] > dm[2]*(1.0 + tol) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01651}01651       dm[2] = dmext[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01652}01652       (*ier) = (*ier) | iloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01653}01653     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01654}01654     \textcolor{comment}{/* Update metric */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01655}01655     \textcolor{keywordflow}{if}( (*\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}}) \& iloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01656}01656       \textcolor{comment}{/* Simultaneous reduction basis is non-\/orthogonal, so invert it for the}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01657}01657 \textcolor{comment}{       * inverse transformation for the tangent-\/plane metric. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01658}01658       \textcolor{keywordtype}{double} ivp[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01659}01659       \textcolor{keywordflow}{if}( !\mbox{\hyperlink{mmgcommon__private_8h_af164320c484fd137c9749bec1e912546}{MMG5\_invmat22}}(vp,ivp) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01660}01660         *\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01661}01661         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01662}01662       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01663}01663       \mbox{\hyperlink{inlined__functions__private_8h_ad791c6f688b31a04f3910b8691d95e6b}{MMG5\_simredmat}}(2,mtan,dm,(\textcolor{keywordtype}{double} *)ivp);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01664}01664       \textcolor{comment}{/* Re-\/assemble 3D metric: use the intersected metrics in the tangent}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01665}01665 \textcolor{comment}{       * plane, and the truncated size in the normal direction. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01666}01666       mr[0] = mtan[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01667}01667       mr[1] = mtan[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01668}01668       mr[3] = mtan[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01669}01669       mr[2] = mr[4] = 0.0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01670}01670       mr[5] = dm[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01671}01671       \textcolor{comment}{/* Transpose rotation matrix and rotate back into the point metric*/}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01672}01672       \mbox{\hyperlink{mmgcommon__private_8h_ac89275a1c7124b0c4344c78dfd0cc341}{MMG5\_transpose3d}}(r);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01673}01673       \mbox{\hyperlink{mmgcommon__private_8h_a83635a3fa94abc3f03bf6c303e055500}{MMG5\_rmtr}}(r,mr,m);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01674}01674     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01675}01675 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01676}01676   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01677}01677   \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* internal point */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01678}01678     \textcolor{keywordtype}{double} dm[3],dmext[3],vp[3][3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01679}01679 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01680}01680     \textcolor{comment}{/* Simultaneous reduction basis */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01681}01681     \textcolor{keywordflow}{if}( !\mbox{\hyperlink{anisosiz_8c_a731bd60efc63d28f8485a333f235987d}{MMG5\_simred3d}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},m,mext,dm,dmext,vp) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01682}01682       *\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01683}01683       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01684}01684     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01685}01685 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01686}01686     \textcolor{comment}{/* Gradation of sizes in the simultaneous reduction basis */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01687}01687     \textcolor{keywordflow}{for}( int8\_t i = 0; i< 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01688}01688       \textcolor{keywordflow}{if}( dmext[i] > dm[i]*(1.0 + tol) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01689}01689         dm[i] = dmext[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01690}01690         (*ier) = (*ier) | iloc;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01691}01691       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01692}01692     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01693}01693     \textcolor{comment}{/* Update metric */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01694}01694     \textcolor{keywordflow}{if}( (*\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}}) \& iloc ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01695}01695       \textcolor{comment}{/* Simultaneous reduction basis is non-\/orthogonal, so invert it for the}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01696}01696 \textcolor{comment}{       * inverse transformation */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01697}01697       \textcolor{keywordtype}{double} ivp[3][3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01698}01698       \textcolor{keywordflow}{if}( !\mbox{\hyperlink{mmgcommon__private_8h_a85d314d873f70dbe42c0147c95cb69e0}{MMG5\_invmat33}}(vp,ivp) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01699}01699         *\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01700}01700         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01701}01701       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01702}01702       \mbox{\hyperlink{inlined__functions__private_8h_ad791c6f688b31a04f3910b8691d95e6b}{MMG5\_simredmat}}(3,m,dm,(\textcolor{keywordtype}{double} *)ivp);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01703}01703     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01704}01704 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01705}01705   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01706}01706 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01707}01707 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01708}01708 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01721}01721 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01722}\mbox{\hyperlink{anisosiz__3d_8c_a426e61159acf04012ab173bd544af50e}{01722}} \textcolor{keywordtype}{void} \mbox{\hyperlink{anisosiz__3d_8c_a426e61159acf04012ab173bd544af50e}{MMG5\_grad2metVol\_setmet}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,\textcolor{keywordtype}{int} ip,\textcolor{keywordtype}{double} *m,int8\_t ridgedir) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01723}01723   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}} ppt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01724}01724   \textcolor{keywordtype}{double} *mm;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01725}01725 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01726}01726   ppt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01727}01727   mm = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*ip];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01728}01728 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01729}01729   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a9be91699c50147e8114822e13d41ae09}{MG\_RID}}(ppt-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01730}01730     \textcolor{keywordtype}{double} mr[6];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01731}01731     \textcolor{keywordtype}{double} u[3],r[3][3],*t,*n;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01732}01732 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01733}01733     \textcolor{comment}{/* Compute ridge orthonormal basis (t, n x t, n) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01734}01734     t = ppt-\/>\mbox{\hyperlink{structMMG5__Point_a02f5943fcbe2b8388205907c01a47f68}{n}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01735}01735     \mbox{\hyperlink{structMMG5__xPoint}{MMG5\_pxPoint}} pxp = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a94c60b23c5a20278669ac1b4e04e9192}{xpoint}}[ppt-\/>\mbox{\hyperlink{structMMG5__Point_a8167ac2be5624d2afd1f0ad716b9cdac}{xp}}];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01736}01736     \textcolor{keywordflow}{if}( ridgedir )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01737}01737       n = pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_a4f012ef35696ca160d3f7fffcaf0ec64}{n2}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01738}01738     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01739}01739       n = pxp-\/>\mbox{\hyperlink{structMMG5__xPoint_ac17b4709dce885f22b9762bc51d01a35}{n1}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01740}01740     \mbox{\hyperlink{mmgcommon__private_8h_adc70cb182809cbf96349afc2b0f64136}{MMG5\_crossprod3d}}(n,t,u);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01741}01741     \textcolor{comment}{/* Store basis in rotation matrix */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01742}01742     \textcolor{keywordflow}{for}( int8\_t i = 0; i < 3; i++ ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01743}01743       r[0][i] = t[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01744}01744       r[1][i] = u[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01745}01745       r[2][i] = n[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01746}01746     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01747}01747     \textcolor{comment}{/* Rotate matrices to the ridge reference system */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01748}01748     \mbox{\hyperlink{mmgcommon__private_8h_a83635a3fa94abc3f03bf6c303e055500}{MMG5\_rmtr}}(r,m,mr);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01749}01749     \textcolor{comment}{/* Store matrix in ridge format */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01750}01750     mm[0]          = mr[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01751}01751     mm[1+ridgedir] = mr[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01752}01752     mm[3+ridgedir] = mr[5];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01753}01753 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01754}01754   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01755}01755 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01756}01756     memcpy(mm,m,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01757}01757 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01758}01758   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01759}01759 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01760}01760   \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01761}01761 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01762}01762 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01778}01778 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01779}\mbox{\hyperlink{anisosiz__3d_8c_a4176a79a93cc037887cbc008f8e8753d}{01779}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a4176a79a93cc037887cbc008f8e8753d}{MMG5\_grad2metVol}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,\textcolor{keywordtype}{int} np1,\textcolor{keywordtype}{int} np2) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01780}01780   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p1,p2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01781}01781   \textcolor{keywordtype}{double}         m1[6],m2[6],mext1[6],mext2[6];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01782}01782   \textcolor{keywordtype}{double}         ux,uy,uz,l;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01783}01783   int8\_t         ridgedir1,ridgedir2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01784}01784   \textcolor{keywordtype}{int}            \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01785}01785 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01786}01786   p1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01787}01787   p2  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01788}01788 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01789}01789   ux = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01790}01790   uy = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01791}01791   uz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01792}01792   l = sqrt(ux*ux+uy*uy+uz*uz);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01793}01793 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01794}01794 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01797}01797   \textcolor{keywordflow}{if}( !\mbox{\hyperlink{anisosiz__3d_8c_aa9c073b6ce584703d4fabd1520be7fb1}{MMG5\_grad2metVol\_getmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np1,ux,uy,uz,m1,\&ridgedir1) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01798}01798     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01799}01799   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01800}01800   \textcolor{keywordflow}{if}( !\mbox{\hyperlink{anisosiz__3d_8c_aa9c073b6ce584703d4fabd1520be7fb1}{MMG5\_grad2metVol\_getmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np2,ux,uy,uz,m2,\&ridgedir2) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01801}01801     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01802}01802   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01803}01803   \textcolor{comment}{/* (metric now follows standard 3D storage) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01804}01804 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01805}01805 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01807}01807   \textcolor{keywordflow}{if}( p2-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} >= \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}}-\/1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01808}01808     \textcolor{comment}{/* Extend p2 metrics */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01809}01809     \mbox{\hyperlink{anisosiz__3d_8c_ae741a40efcf3b89ac63d356515ae5899}{MMG5\_grad2metVol\_extmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p2,l,m2,mext2);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01810}01810 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01811}01811     \textcolor{comment}{/* Gradate p1 metrics */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01812}01812     \mbox{\hyperlink{anisosiz__3d_8c_aad21961f90b9120587647f669ba6e326}{MMG3D\_gradSimred}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p1,m1,mext2,ridgedir1,1,\&\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01813}01813     \textcolor{keywordflow}{if}( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} == -\/1 )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01814}01814       \textcolor{keywordflow}{return} \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01815}01815 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01816}01816     \textcolor{keywordtype}{double} mtmp[6];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01817}01817     \textcolor{keywordtype}{int} iertmp = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01818}01818     memcpy(mtmp,m1,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01819}01819     \mbox{\hyperlink{anisosiz__3d_8c_aad21961f90b9120587647f669ba6e326}{MMG3D\_gradSimred}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p1,mtmp,mext2,ridgedir1,1,\&iertmp);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01820}01820     \textcolor{keywordflow}{if}( iertmp \& 1 )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01821}01821       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} |= 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01822}01822 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01823}01823   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01824}01824 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01825}01825 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01827}01827   \textcolor{keywordflow}{if}( p1-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} >= \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}}-\/1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01828}01828     \textcolor{comment}{/* Expand p1 metrics */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01829}01829     \mbox{\hyperlink{anisosiz__3d_8c_ae741a40efcf3b89ac63d356515ae5899}{MMG5\_grad2metVol\_extmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p1,l,m1,mext1);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01830}01830 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01831}01831     \textcolor{comment}{/* Gradate p2 metrics */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01832}01832     \mbox{\hyperlink{anisosiz__3d_8c_aad21961f90b9120587647f669ba6e326}{MMG3D\_gradSimred}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p2,m2,mext1,ridgedir2,2,\&\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01833}01833     \textcolor{keywordflow}{if}( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} == -\/1 )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01834}01834       \textcolor{keywordflow}{return} \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01835}01835 \textcolor{preprocessor}{\#ifndef NDEBUG}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01836}01836     \textcolor{keywordtype}{double} mtmp[6];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01837}01837     \textcolor{keywordtype}{int} iertmp = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01838}01838     memcpy(mtmp,m2,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01839}01839     \mbox{\hyperlink{anisosiz__3d_8c_aad21961f90b9120587647f669ba6e326}{MMG3D\_gradSimred}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},p2,mtmp,mext1,ridgedir2,2,\&iertmp);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01840}01840     \textcolor{keywordflow}{if}( iertmp \& 2 )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01841}01841       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} |= 4;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01842}01842 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01843}01843   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01844}01844 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01845}01845 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01846}01846   \textcolor{comment}{/* Set metrics to the met structure, back to ridge storage */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01847}01847   \textcolor{keywordflow}{if}( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} \& 1 )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01848}01848     \mbox{\hyperlink{anisosiz__3d_8c_a426e61159acf04012ab173bd544af50e}{MMG5\_grad2metVol\_setmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np1,m1,ridgedir1);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01849}01849   \textcolor{keywordflow}{if}( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} \& 2 )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01850}01850     \mbox{\hyperlink{anisosiz__3d_8c_a426e61159acf04012ab173bd544af50e}{MMG5\_grad2metVol\_setmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np2,m2,ridgedir2);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01851}01851 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01852}01852   \textcolor{keywordflow}{return} \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01853}01853 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01854}01854 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01855}01855 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01867}\mbox{\hyperlink{anisosiz__3d_8c_aa2ffa40ec824957c2c46e85d610e6e48}{01867}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_aa2ffa40ec824957c2c46e85d610e6e48}{MMG3D\_updatemetreq\_ani}}(\textcolor{keywordtype}{double} *n,\textcolor{keywordtype}{double} dn[3],\textcolor{keywordtype}{double} vp[3][3]) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01868}01868   \textcolor{keywordtype}{double} ip[3][3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01869}01869 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01870}01870   \textcolor{comment}{/* P\string^-\/1 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01871}01871   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a85d314d873f70dbe42c0147c95cb69e0}{MMG5\_invmat33}}(vp,ip) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01872}01872     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01873}01873   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01874}01874 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01875}01875   \textcolor{comment}{/* tp\string^-\/1 * dn * P\string^-\/1 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01876}01876   n[0] = dn[0]*ip[0][0]*ip[0][0] + dn[1]*ip[1][0]*ip[1][0] + dn[2]*ip[2][0]*ip[2][0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01877}01877   n[1] = dn[0]*ip[0][0]*ip[0][1] + dn[1]*ip[1][0]*ip[1][1] + dn[2]*ip[2][0]*ip[2][1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01878}01878   n[2] = dn[0]*ip[0][0]*ip[0][2] + dn[1]*ip[1][0]*ip[1][2] + dn[2]*ip[2][0]*ip[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01879}01879 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01880}01880   n[3] = dn[0]*ip[0][1]*ip[0][1] + dn[1]*ip[1][1]*ip[1][1] + dn[2]*ip[2][1]*ip[2][1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01881}01881   n[4] = dn[0]*ip[0][1]*ip[0][2] + dn[1]*ip[1][1]*ip[1][2] + dn[2]*ip[2][1]*ip[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01882}01882 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01883}01883   n[5] = dn[0]*ip[0][2]*ip[0][2] + dn[1]*ip[1][2]*ip[1][2] + dn[2]*ip[2][2]*ip[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01884}01884 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01885}01885   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01886}01886 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01887}01887 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01902}01902 \textcolor{keyword}{static} \textcolor{keyword}{inline}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01903}\mbox{\hyperlink{anisosiz__3d_8c_af5af1bacef24b20f74052b94e1378e4c}{01903}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_af5af1bacef24b20f74052b94e1378e4c}{MMG5\_grad2metVolreq}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met,\mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}} pt,MMG5\_int npmaster,}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01904}01904                         MMG5\_int npslave) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01905}01905   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}    p1,p2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01906}01906   \textcolor{keywordtype}{double}         *mm1,*mm2,m1[6],m2[6],ux,uy,uz;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01907}01907   \textcolor{keywordtype}{double}         l,difsiz,rbasis1[3][3],rbasis2[3][3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01908}01908   \textcolor{keywordtype}{double}         lambda[3],vp[3][3],beta,mu[3];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01909}01909   \textcolor{keywordtype}{int}            cfg\_m2;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01910}01910   int8\_t         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01911}01911 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01912}01912   p1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[npmaster];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01913}01913   p2  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[npslave];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01914}01914 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01915}01915   ux = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01916}01916   uy = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01917}01917   uz = p2-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2] -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a76168a52c07a87e2f49ee6877c63c4eb}{c}}[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01918}01918 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01919}01919   mm1  = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*npmaster];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01920}01920   mm2  = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*npslave];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01921}01921 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01922}01922   cfg\_m2 = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01923}01923   \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01924}01924 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01925}01925   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a9be91699c50147e8114822e13d41ae09}{MG\_RID}}(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01926}01926     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a9be91699c50147e8114822e13d41ae09}{MG\_RID}}(p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01927}01927       \textcolor{comment}{// The volume gradation from ridge point toward another ridge point is}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01928}01928       \textcolor{comment}{// bugged...}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01929}01929       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01930}01930     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01931}01931 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01932}01932     \textcolor{comment}{/* Recover normal and metric associated to p1 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01933}01933     \textcolor{keywordflow}{if}( !\mbox{\hyperlink{mettools_8c_ab9abc1963a552fd343bc5c27a753a58a}{MMG5\_buildridmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,npmaster,ux,uy,uz,m1,rbasis1) ) \{ \textcolor{keywordflow}{return} 0; \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01934}01934   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01935}01935   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01936}01936     memcpy(m1,mm1,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01937}01937   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01938}01938 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01939}01939   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_a9be91699c50147e8114822e13d41ae09}{MG\_RID}}(p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01940}01940     \textcolor{comment}{/* Recover normal and metric associated to p2 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01941}01941     cfg\_m2 = \mbox{\hyperlink{mettools_8c_ab9abc1963a552fd343bc5c27a753a58a}{MMG5\_buildridmet}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,npslave,ux,uy,uz,m2,rbasis2);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01942}01942     \textcolor{keywordflow}{if}( !cfg\_m2 ) \{ \textcolor{keywordflow}{return} 0; \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01943}01943   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01944}01944   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01945}01945     memcpy(m2,mm2,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01946}01946   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01947}01947 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01948}01948   l = sqrt(ux*ux+uy*uy+uz*uz);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01949}01949 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01950}01950   difsiz = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_ae2e1a6d9ad39421bc8c6113b42f1fe88}{hgradreq}}*l;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01951}01951 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01952}01952   \textcolor{comment}{/* Simultaneous reduction of mtan1 and mtan2 */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01953}01953   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz_8c_a731bd60efc63d28f8485a333f235987d}{MMG5\_simred3d}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},m1,m2,lambda,mu,vp) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01954}01954     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01955}01955   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01956}01956 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01957}01957   \textcolor{comment}{/* Gradation of sizes = 1/sqrt(eigenv of the tensors) in the first direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01958}01958   \mbox{\hyperlink{anisosiz_8c_a859aa83b2c801263c24123bd701255dc}{MMG5\_gradEigenvreq}}(lambda,mu,difsiz,0,\&\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01959}01959 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01960}01960   \textcolor{comment}{/* Gradation of sizes = 1/sqrt(eigenv of the tensors) in the second direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01961}01961   \mbox{\hyperlink{anisosiz_8c_a859aa83b2c801263c24123bd701255dc}{MMG5\_gradEigenvreq}}(lambda,mu,difsiz,1,\&\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01962}01962 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01963}01963   \textcolor{comment}{/* Gradation of sizes = 1/sqrt(eigenv of the tensors) in the third direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01964}01964   \mbox{\hyperlink{anisosiz_8c_a859aa83b2c801263c24123bd701255dc}{MMG5\_gradEigenvreq}}(lambda,mu,difsiz,2,\&\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01965}01965 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01966}01966   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01967}01967     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01968}01968   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01969}01969 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01970}01970   \textcolor{comment}{/* Metric update using the simultaneous reduction technique */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01971}01971   \textcolor{keywordflow}{if}( \mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01972}01972     \textcolor{comment}{/* We choose to not respect the gradation in order to restrict the influence}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01973}01973 \textcolor{comment}{     * of the singular points. Thus:}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01974}01974 \textcolor{comment}{     * lambda\_new = = 0.5 lambda\_1 + 0.5 lambda\_new = lambda\_1 + 0.5 beta.}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01975}01975 \textcolor{comment}{     * with beta the smallest variation of the eigenvalues (lambda\_new-\/lambda\_1). */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01976}01976 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01977}01977     \textcolor{comment}{/* This point can have an anisotropic metric if a user-\/provided metric is}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01978}01978 \textcolor{comment}{     * found. So, compute the eigenvalues. */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01979}01979     \textcolor{keywordtype}{double} ll[3],rr[3][3],llmin;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01980}01980     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01981}01981     \textcolor{keywordflow}{if}( !\mbox{\hyperlink{eigenv_8c_a33a2a006517b178fa2dfeb28f38a0d53}{MMG5\_eigenv3d}}(1,mm2,ll, rr) )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01982}01982       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01983}01983     llmin = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01984}01984     \textcolor{keywordflow}{for}( i = 0; i < 3; i++ )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01985}01985       \textcolor{keywordflow}{if}( ll[i] < llmin )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01986}01986         llmin = ll[i];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01987}01987 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01988}01988 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01989}01989     beta = mu[0] -\/ llmin;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01990}01990 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01991}01991     \textcolor{keywordflow}{if} ( fabs(beta) < fabs(llmin-\/mu[1]) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01992}01992       beta = mu[1] -\/ llmin;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01993}01993     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01994}01994     ll[0] += 0.5*beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01995}01995     ll[1] += 0.5*beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01996}01996     ll[2] += 0.5*beta;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01997}01997     assert ( ll[0]>0. \&\& ll[1]>0. \&\& ll[2]>0. );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01998}01998     mm2[0] = ll[0]*rr[0][0]*rr[0][0] + ll[1]*rr[1][0]*rr[1][0] + ll[2]*rr[2][0]*rr[2][0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l01999}01999     mm2[1] = ll[0]*rr[0][0]*rr[0][1] + ll[1]*rr[1][0]*rr[1][1] + ll[2]*rr[2][0]*rr[2][1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02000}02000     mm2[2] = ll[0]*rr[0][0]*rr[0][2] + ll[1]*rr[1][0]*rr[1][2] + ll[2]*rr[2][0]*rr[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02001}02001     mm2[3] = ll[0]*rr[0][1]*rr[0][1] + ll[1]*rr[1][1]*rr[1][1] + ll[2]*rr[2][1]*rr[2][1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02002}02002     mm2[4] = ll[0]*rr[0][1]*rr[0][2] + ll[1]*rr[1][1]*rr[1][2] + ll[2]*rr[2][1]*rr[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02003}02003     mm2[5] = ll[0]*rr[0][2]*rr[0][2] + ll[1]*rr[1][2]*rr[1][2] + ll[2]*rr[2][2]*rr[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02004}02004   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02005}02005   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( p2-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}} )\{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02006}02006 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02007}02007     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_aa2ffa40ec824957c2c46e85d610e6e48}{MMG3D\_updatemetreq\_ani}}(m2,mu,vp) ) \{ \textcolor{keywordflow}{return} 0; \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02008}02008 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02009}02009     \textcolor{comment}{/* Here mtan2 contains the gradated metric in the coreduction basis: compute}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02010}02010 \textcolor{comment}{     * the sizes in the directions (t,u=t\string^n,n) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02011}02011     mu[0] = m2[0]*rbasis2[0][0]*rbasis2[0][0] + 2. * m2[1]*rbasis2[1][0]*rbasis2[0][0]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02012}02012       + 2. * m2[2]*rbasis2[2][0]*rbasis2[0][0]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02013}02013       + m2[3]*rbasis2[1][0]*rbasis2[1][0] + 2. * m2[4]*rbasis2[2][0]*rbasis2[1][0]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02014}02014       + m2[5]*rbasis2[2][0]*rbasis2[2][0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02015}02015 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02016}02016     \textcolor{comment}{/* h = 1/sqrt(t\_e M e) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02017}02017     assert ( mu[0] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02018}02018 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02019}02019     mu[1] = m2[0]*rbasis2[0][1]*rbasis2[0][1] + 2. * m2[1]*rbasis2[1][1]*rbasis2[0][1]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02020}02020       + 2. * m2[2]*rbasis2[2][1]*rbasis2[0][1]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02021}02021       + m2[3]*rbasis2[1][1]*rbasis2[1][1] + 2. * m2[4]*rbasis2[2][1]*rbasis2[1][1]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02022}02022       + m2[5]*rbasis2[2][1]*rbasis2[2][1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02023}02023 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02024}02024     \textcolor{comment}{/* h = 1/sqrt(t\_e M e) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02025}02025     assert ( mu[1] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02026}02026 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02027}02027     mu[2] = m2[0]*rbasis2[0][2]*rbasis2[0][2] + 2. * m2[1]*rbasis2[1][2]*rbasis2[0][2]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02028}02028       + 2. * m2[2]*rbasis2[2][2]*rbasis2[0][2]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02029}02029       + m2[3]*rbasis2[1][2]*rbasis2[1][2] + 2. * m2[4]*rbasis2[2][2]*rbasis2[1][2]}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02030}02030       + m2[5]*rbasis2[2][2]*rbasis2[2][2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02031}02031 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02032}02032     \textcolor{comment}{/* h = 1/sqrt(t\_e M e) */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02033}02033     assert ( mu[2] > \mbox{\hyperlink{mmgcommon__private_8h_aeac8d21b860ed84f6cafab536c23bdb8}{MMG5\_EPSD2}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02034}02034 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02035}02035     \textcolor{comment}{/* Update the ridge metric */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02036}02036     mm2[0] =  mu[0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02037}02037 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02038}02038     assert ( cfg\_m2 );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02039}02039 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02040}02040     mm2[cfg\_m2] = mu[1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02041}02041     mm2[cfg\_m2+2] = mu[2];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02042}02042   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02043}02043   \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02044}02044 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02045}02045     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{anisosiz__3d_8c_aa2ffa40ec824957c2c46e85d610e6e48}{MMG3D\_updatemetreq\_ani}}(m2,mu,vp) ) \{ \textcolor{keywordflow}{return} 0; \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02046}02046     memcpy(mm2,m2,6*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02047}02047   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02048}02048 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02049}02049   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02050}02050 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02051}02051 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02052}02052 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02073}\mbox{\hyperlink{anisosiz__3d_8c_a0ae7dbe43795ae8addfd9ac34154b286}{02073}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_a0ae7dbe43795ae8addfd9ac34154b286}{MMG3D\_gradsiz\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02074}02074   \mbox{\hyperlink{structMMG5__Hash}{MMG5\_Hash}}     edgeTable;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02075}02075   \mbox{\hyperlink{structMMG5__hedge}{MMG5\_hedge}}    *pht;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02076}02076   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02077}02077   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p0,p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02078}02078   \textcolor{keywordtype}{double}        *m,mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02079}02079   \textcolor{keywordtype}{int}           i,itv,maxit,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02080}02080   MMG5\_int      k,np0,np1,nu,nupv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02081}02081   \textcolor{keyword}{static} \textcolor{keywordtype}{int}    mmgWarn = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02082}02082 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02083}02083   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} )}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02084}02084     fprintf(stdout,\textcolor{stringliteral}{"{}  ** Anisotropic mesh gradation\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02085}02085 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02086}02086   \textcolor{comment}{/* First step : make ridges iso in each apairing direction */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02087}02087   \textcolor{keywordflow}{for} (k=1; k<= \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02088}02088     p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02089}02089     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_aacf41a0e0a3fdf65d77fa5a97fa83bce}{MG\_VOK}}(p1) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02090}02090     \textcolor{keywordflow}{if} ( \mbox{\hyperlink{mmgcommon__private_8h_ad76e441469f91f54a79ceaf4a04f2938}{MG\_SIN\_OR\_NOM}}(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02091}02091     \textcolor{keywordflow}{if} ( !(p1-\/>\mbox{\hyperlink{structMMG5__Point_a041bd4b5aed20f9f78fe53f74dae0d9b}{tag}} \& \mbox{\hyperlink{mmgcommon__private_8h_a0776e940d2dc5be4b516dbd5ff3d30dd}{MG\_GEO}}) ) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02092}02092 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02093}02093     m = \&met-\/>\mbox{\hyperlink{structMMG5__Sol_ad560357d85168138d78249eb4879b5d8}{m}}[6*k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02094}02094     mv = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[1],m[2]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02095}02095     m[1] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02096}02096     m[2] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02097}02097     mv = \mbox{\hyperlink{mmgcommon__private_8h_a48e51dff4e4dda331a2bfff4c0c70c54}{MG\_MAX}}(m[3],m[4]);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02098}02098     m[3] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02099}02099     m[4] = mv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02100}02100   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02101}02101 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02103}02103   \mbox{\hyperlink{isosiz__3d_8c_a7c5c08193230ab3fd1cc3d81197f2f6d}{MMG3D\_mark\_pointsOnReqEdge\_fromTetra}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02104}02104 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02105}02105 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02106}02106   \textcolor{comment}{/* alloc hashtable */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02107}02107   \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{hash_8c_a8dafcb56c527c1ed983952055b52668c}{MMG5\_hashNew}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&edgeTable,\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a87f35588ecc56b0523413f5529d67f08}{nemax}},3*\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a87f35588ecc56b0523413f5529d67f08}{nemax}}) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02108}02108     fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Error: \%s: unable to allocate hash table.\(\backslash\)n"{}},\_\_func\_\_);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02109}02109     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02110}02110   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02111}02111 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02112}02112   \textcolor{comment}{/* build edge table */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02113}02113   \textcolor{keywordflow}{for}(k=1 ; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}} ; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02114}02114     pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02115}02115     \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02116}02116       \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02117}02117     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02118}02118     \textcolor{keywordflow}{for}(i=0 ; i<6 ; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02119}02119       np0 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[i][0]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02120}02120       np1 = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[i][1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02121}02121 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02122}02122       \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{hash_8c_abf9ecdc9c796612c38768d7d15d28642}{MMG5\_hashEdge}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\&edgeTable,np0,np1,k);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02123}02123       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02124}02124         \textcolor{keywordflow}{if} ( !mmgWarn ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02125}02125           mmgWarn = 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02126}02126           fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n  \#\# Warning: \%s: unable to hash at least one edge"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02127}02127                   \textcolor{stringliteral}{"{} (tria \%"{}} MMG5\_PRId \textcolor{stringliteral}{"{}, edge \%d).\(\backslash\)n"{}},\_\_func\_\_,\mbox{\hyperlink{libmmg3d__private_8h_af649b03d6147bfcf2ed74041417d80b4}{MMG3D\_indElt}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k),i);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02128}02128         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02129}02129       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02130}02130     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02131}02131   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02132}02132 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02133}02133   \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ac32e68b2523d554f3851cc7229a377e2}{np}}; k++)}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02134}02134     \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[k].\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02135}02135 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02136}02136   nupv = itv = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02137}02137   maxit = 500;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02138}02138   mmgWarn = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02139}02139 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02140}02140   \textcolor{comment}{/* analyze mesh edges via hash table */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02141}02141   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02142}02142     ++\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02143}02143     nu = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02144}02144     for (k=0; k<edgeTable.\mbox{\hyperlink{structMMG5__Hash_ab9964a6eb3dae0f66bee43b7032eafe2}{siz}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02145}02145       pht = \&edgeTable.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02146}02146       \textcolor{comment}{/* analyze linked list */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02147}02147       \textcolor{keywordflow}{while} ( pht ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02148}02148         \textcolor{keywordflow}{if} ( !pht-\/>\mbox{\hyperlink{structMMG5__hedge_a6d1e0d33c7d05c896daffcb4b066c8b2}{a}} )  \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02149}02149         np0  = pht-\/>\mbox{\hyperlink{structMMG5__hedge_a6d1e0d33c7d05c896daffcb4b066c8b2}{a}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02150}02150         np1  = pht-\/>\mbox{\hyperlink{structMMG5__hedge_a51cff7c0bb88263e04d056d08061ae6b}{b}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02151}02151         p0 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02152}02152         p1 = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02153}02153 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02154}02154         \textcolor{comment}{/* Skip edge if both nodes have been updated more than 1 iteration ago */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02155}02155         \textcolor{keywordflow}{if} ( (p0-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} < \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}}-\/1) \&\& (p1-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} < \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}}-\/1) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02156}02156           pht = pht-\/>\mbox{\hyperlink{structMMG5__hedge_a9f23e9d33ee5b0f27adae9288ed90ca6}{nxt}} ? \&edgeTable.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}}[pht-\/>\mbox{\hyperlink{structMMG5__hedge_a9f23e9d33ee5b0f27adae9288ed90ca6}{nxt}}] : 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02157}02157           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02158}02158         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02159}02159 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02160}02160         \textcolor{comment}{/* Skip points belonging to a required edge */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02161}02161         \textcolor{keywordflow}{if} ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} || p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02162}02162           pht = pht-\/>\mbox{\hyperlink{structMMG5__hedge_a9f23e9d33ee5b0f27adae9288ed90ca6}{nxt}} ? \&edgeTable.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}}[pht-\/>\mbox{\hyperlink{structMMG5__hedge_a9f23e9d33ee5b0f27adae9288ed90ca6}{nxt}}] : 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02163}02163           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02164}02164         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02165}02165 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02166}02166         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{anisosiz__3d_8c_a4176a79a93cc037887cbc008f8e8753d}{MMG5\_grad2metVol}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,np0,np1);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02167}02167         \textcolor{keywordflow}{if}( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} == -\/1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02168}02168           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02169}02169         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02170}02170           \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} \& 1 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02171}02171             p0-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02172}02172             nu++;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02173}02173           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02174}02174           \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} \& 2 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02175}02175             p1-\/>\mbox{\hyperlink{structMMG5__Point_ace563cf1feca2ac9c6baad7b54292bf5}{flag}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_aab7d0acabeb8edd8645b8a9c07169888}{base}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02176}02176             nu++;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02177}02177           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02178}02178           \textcolor{keywordflow}{if} ( !mmgWarn \&\& (\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} \& 4) ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02179}02179             mmgWarn = itv;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02180}02180           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02181}02181         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02182}02182 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02183}02183         \textcolor{comment}{/* next edge */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02184}02184         pht = pht-\/>\mbox{\hyperlink{structMMG5__hedge_a9f23e9d33ee5b0f27adae9288ed90ca6}{nxt}} ? \&edgeTable.\mbox{\hyperlink{structMMG5__Hash_a6417f85daece68afaa4b146d5eb28b3b}{item}}[pht-\/>\mbox{\hyperlink{structMMG5__hedge_a9f23e9d33ee5b0f27adae9288ed90ca6}{nxt}}] : 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02185}02185       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02186}02186     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02187}02187     nupv += nu;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02188}02188   \} \textcolor{keywordflow}{while} ( ++itv < maxit \&\& nu > 0 );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02189}02189   \mbox{\hyperlink{mmgcommon__private_8h_af4d5e437466b48a931cc2ad480bc3a8d}{MMG5\_SAFE\_FREE}}(edgeTable.item);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02190}02190 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02191}02191   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 3 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02192}02192     \textcolor{keywordflow}{if}( mmgWarn ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02193}02193       fprintf(stderr,\textcolor{stringliteral}{"{}\(\backslash\)n      \#\# Warning: \%s: Non-\/idempotent metric"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02194}02194                      \textcolor{stringliteral}{"{} intersections since iteration \%d.\(\backslash\)n"{}},\_\_func\_\_,mmgWarn);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02195}02195     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02196}02196 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02197}02197     fprintf(stdout,\textcolor{stringliteral}{"{}    gradation: \%7"{}} MMG5\_PRId \textcolor{stringliteral}{"{} updated, \%d iter\(\backslash\)n"{}},nupv,itv);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02198}02198   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02199}02199   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02200}02200 \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02201}02201 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02210}\mbox{\hyperlink{anisosiz__3d_8c_af1acf84668dd2ea1ce3938fe9e489c48}{02210}} \textcolor{keywordtype}{int} \mbox{\hyperlink{anisosiz__3d_8c_af1acf84668dd2ea1ce3938fe9e489c48}{MMG3D\_gradsizreq\_ani}}(\mbox{\hyperlink{structMMG5__Mesh}{MMG5\_pMesh}} \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},\mbox{\hyperlink{structMMG5__Sol}{MMG5\_pSol}} met) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02211}02211   \mbox{\hyperlink{structMMG5__Tetra}{MMG5\_pTetra}}   pt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02212}02212   \mbox{\hyperlink{structMMG5__xTetra}{MMG5\_pxTetra}}  pxt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02213}02213   \mbox{\hyperlink{structMMG5__Tria}{MMG5\_Tria}}     ptt;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02214}02214   \mbox{\hyperlink{structMMG5__Point}{MMG5\_pPoint}}   p0,p1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02215}02215   \textcolor{keywordtype}{int}           it,itv,maxit;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02216}02216   \textcolor{keywordtype}{int}           i,j,\mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02217}02217   MMG5\_int      nup,nu,nupv,k,np0,np1,npmaster,npslave;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02218}02218 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02219}02219   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 5 || \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02220}02220     fprintf(stdout,\textcolor{stringliteral}{"{}  ** Grading required points.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02221}02221   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02222}02222 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02223}02223   \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a61dba6868b2752cab22a2dc59d2e8104}{hgrad}} < 0. ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02226}02226     \mbox{\hyperlink{isosiz__3d_8c_a7c5c08193230ab3fd1cc3d81197f2f6d}{MMG3D\_mark\_pointsOnReqEdge\_fromTetra}} ( \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02227}02227   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02228}02228 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02229}02229   it = nup = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02230}02230   maxit = 100;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02231}02231   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02232}02232     nu = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02233}02233     \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02234}02234       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02235}02235       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02236}02236       pxt = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}} ? \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_adc51b5c6be448eec6bd585b055897d36}{xtetra}}[pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a5f627109ce0dacaa35c2f85b6a5dda8e}{xt}}] : 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02237}02237 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02238}02238       \textcolor{keywordflow}{if} ( pxt ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02239}02239         \textcolor{keywordflow}{for} (i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02240}02240           \textcolor{keywordflow}{if} ( pxt-\/>\mbox{\hyperlink{structMMG5__xTetra_a45d8e209a17faafbf7c8a0c4c52a9094}{ftag}}[i] \& \mbox{\hyperlink{mmgcommon__private_8h_ac6618718097b74907db2442d75e062f3}{MG\_BDY}}) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02241}02241             \textcolor{comment}{/* Gradation along a surface edge */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02242}02242             \textcolor{comment}{/* virtual triangle */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02243}02243             \mbox{\hyperlink{libmmg3d__private_8h_ac7864bff63d5967a2f0c3049bddac2bf}{MMG5\_tet2tri}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},k,i,\&ptt);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02244}02244             \textcolor{keywordflow}{for} (j=0; j<3; j++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02245}02245               np0 = ptt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a9e3354edd5a0c18b014fc8b430653425}{MMG5\_inxt2}}[j]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02246}02246               np1 = ptt.\mbox{\hyperlink{structMMG5__Tria_ae57444f2935d1896aa9f080c24d7686f}{v}}[\mbox{\hyperlink{mmgcommon__private_8h_a62d1fa220f2d1c9a4d9961eacc29c528}{MMG5\_iprv2}}[j]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02247}02247               p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02248}02248               p1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02249}02249 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02250}02250               \textcolor{keywordflow}{if} ( MMG5\_abs ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} ) < 2 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02251}02251                 \textcolor{comment}{/* No size to propagate */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02252}02252                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02253}02253               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02254}02254               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} > p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02255}02255                 npmaster = np0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02256}02256                 npslave  = np1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02257}02257               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02258}02258               \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02259}02259                 assert ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} > p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02260}02260                 npmaster = np1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02261}02261                 npslave  = np0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02262}02262               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02263}02263 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02264}02264               \textcolor{comment}{/* Impose the gradation to npslave from npmaster */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02265}02265               \textcolor{comment}{/* gradation along the tangent plane */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02266}02266               \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} = \mbox{\hyperlink{anisosiz_8c_ab30237615f2aa5ffa117e45eae0e3909}{MMG5\_grad2metSurfreq}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,\&ptt,npmaster,npslave);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02267}02267               \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02268}02268                 \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[npslave].\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[npmaster].\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02269}02269                 nu++;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02270}02270               \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02271}02271             \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02272}02272           \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02273}02273 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02274}02274           \textcolor{keywordflow}{else} \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02275}02275         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02276}02276       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02277}02277     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02278}02278     nup += nu;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02279}02279   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02280}02280   \textcolor{keywordflow}{while}( ++it < maxit \&\& nu > 0 );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02281}02281 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02282}02282   nupv = itv = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02283}02283   maxit = 500;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02284}02284 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02285}02285   \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02286}02286     nu = 0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02287}02287     \textcolor{keywordflow}{for} (k=1; k<=\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a3c9274a9ff525c4c80b264c79e5701df}{ne}}; k++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02288}02288       pt = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_ab3e4edc6445d6a9c21f22a1a54d0d2aa}{tetra}}[k];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02289}02289       \textcolor{keywordflow}{if} ( !\mbox{\hyperlink{mmgcommon__private_8h_a277e70018dbfbb4e2f2fc8b7ca1531de}{MG\_EOK}}(pt) )  \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02290}02290       \textcolor{keywordflow}{for} (i=0; i<4; i++) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02291}02291         \textcolor{comment}{/* Gradation along a volume edge */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02292}02292         np0  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[i][0]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02293}02293         np1  = pt-\/>\mbox{\hyperlink{structMMG5__Tetra_a4e95449583d4883b6013963879fc2efb}{v}}[\mbox{\hyperlink{libmmg3d__private_8h_a9eda8eac247c98edf6ac474e04b0bd7c}{MMG5\_iare}}[i][1]];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02294}02294         p0  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np0];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02295}02295         p1  = \&\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[np1];}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02296}02296 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02297}02297         \textcolor{keywordflow}{if} ( MMG5\_abs ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} -\/ p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} ) < 2 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02298}02298           \textcolor{comment}{/* No size to propagate */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02299}02299           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02300}02300         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02301}02301         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} > p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02302}02302           npmaster = np0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02303}02303           npslave  = np1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02304}02304         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02305}02305         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02306}02306           assert ( p1-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} > p0-\/>\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02307}02307           npmaster = np1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02308}02308           npslave  = np0;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02309}02309         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02310}02310 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02311}02311         \textcolor{comment}{/* Impose the gradation to npslave from npmaster */}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02312}02312         \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} =  \mbox{\hyperlink{anisosiz__3d_8c_af5af1bacef24b20f74052b94e1378e4c}{MMG5\_grad2metVolreq}}(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}},met,pt,npmaster,npslave);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02313}02313         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{API__functionsf__2d_8c_a2d9a01f2692fe17d62f00d0fd343d981}{ier}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02314}02314           \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[npslave].\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} = \mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a42b1992e7843683d2e8ee206b582dedb}{point}}[npmaster].\mbox{\hyperlink{structMMG5__Point_a8ab85afb15d88eab0fa1779df79caed9}{s}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02315}02315 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02316}02316           nu++;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02317}02317         \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02318}02318       \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02319}02319     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02320}02320     nupv += nu;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02321}02321   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02322}02322   \textcolor{keywordflow}{while}( ++itv < maxit \&\& nu > 0 );}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02323}02323 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02324}02324   \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) > 3 ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02325}02325     \textcolor{keywordflow}{if} ( abs(\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_af1794c6c54daf4eb98cac8e0248398fb}{imprim}}) < 5 \&\& !\mbox{\hyperlink{API__functionsf__2d_8c_ada14f706b6d7a565d1eeb593fa0ae492}{mesh}}-\/>\mbox{\hyperlink{structMMG5__Mesh_a25b93ad96d37e2f4f31e140ebab15a12}{info}}.\mbox{\hyperlink{structMMG5__Info_a09d107800b5717ee5dd96a26a03eed02}{ddebug}} ) \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02326}02326       fprintf(stdout,\textcolor{stringliteral}{"{}    gradation: \%7"{}} MMG5\_PRId \textcolor{stringliteral}{"{} updated, \%d iter\(\backslash\)n"{}},nup+nupv,it+itv);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02327}02327     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02328}02328     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02329}02329       fprintf(stdout,\textcolor{stringliteral}{"{}    surface gradation: \%7"{}} MMG5\_PRId \textcolor{stringliteral}{"{} updated, \%d iter\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02330}02330               \textcolor{stringliteral}{"{}    volume gradation:  \%7"{}} MMG5\_PRId \textcolor{stringliteral}{"{} updated, \%d iter\(\backslash\)n"{}},nup,it,nupv,itv);}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02331}02331     \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02332}02332   \}}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02333}02333 }
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02334}02334   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{anisosiz__3d_8c_source_l02335}02335 \}}

\end{DoxyCode}
